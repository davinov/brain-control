{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/field-play/bus.js","webpack:///./src/components/FieldVisualization.vue?ff26","webpack:///./src/App.vue?926f","webpack:///./src/components/Session.vue?e244","webpack:///./src/components/Visualization.vue?bdee","webpack:///./src/components/ParticlesVisualization.vue?63e3","webpack:///./src/App.vue?5a41","webpack:///./src/components/MuseRecorder.vue?ebe6","webpack:///./src/components/Session.vue?28f5","webpack:///./src/components/Session.vue?2c06","webpack:///./src/components/Session.vue?a91d","webpack:///./src/components/Session.vue","webpack:///./src/components/Visualization.vue?4632","webpack:///./src/components/Visualization.vue?0c6f","webpack:///./src/components/Visualization.vue?aa98","webpack:///./src/components/Visualization.vue","webpack:///./src/components/ParticlesVisualization.vue?c57d","webpack:///./src/components/ParticlesVisualization.vue","webpack:///./src/components/ParticlesVisualization.vue?1be4","webpack:///./src/lib/field-play/gl-utils.js","webpack:///./src/lib/field-play/programs/colorModes.js","webpack:///./src/lib/field-play/wrapVectorField.js","webpack:///./src/lib/field-play/isSmallScreen.js","webpack:///./src/lib/field-play/appState.js","webpack:///./src/lib/field-play/programs/screenProgram.js","webpack:///./src/lib/field-play/shaderGraph/parts/decodeFloatRGBA.js","webpack:///./src/lib/field-play/shaderGraph/BaseShaderNode.js","webpack:///./src/lib/field-play/shaderGraph/parts/simplex-noise.js","webpack:///./src/lib/field-play/shaderGraph/customInput.js","webpack:///./src/lib/field-play/shaderGraph/UserDefinedVelocityFunction.js","webpack:///./src/lib/field-play/shaderGraph/RungeKuttaIntegrator.js","webpack:///./src/lib/field-play/shaderGraph/shaderBasedColor.js","webpack:///./src/lib/field-play/shaderGraph/DrawParticleGraph.js","webpack:///./src/lib/field-play/shaderGraph/parts/encodeFloatRGBA.js","webpack:///./src/lib/field-play/shaderGraph/TexturePositionNode.js","webpack:///./src/lib/field-play/shaderGraph/renderNodes.js","webpack:///./src/lib/field-play/shaderGraph/PanzoomTransform.js","webpack:///./src/lib/field-play/shaderGraph/updatePositionGraph.js","webpack:///./src/lib/field-play/utils/floatPacking.js","webpack:///./src/lib/field-play/utils/makeStatCounter.js","webpack:///./src/lib/field-play/programs/colorProgram.js","webpack:///./src/lib/field-play/utils/textureCollection.js","webpack:///./src/lib/field-play/programs/updatePositionProgram.js","webpack:///./src/lib/field-play/config.js","webpack:///./src/lib/field-play/programs/audioProgram.js","webpack:///./src/lib/field-play/programs/drawParticlesProgram.js","webpack:///./src/lib/field-play/utils/request.js","webpack:///./src/lib/field-play/editor/fetchGLSL.js","webpack:///./src/lib/field-play/editor/pragmaParser.js","webpack:///./src/lib/field-play/editor/getParsedVectorFieldFunction.js","webpack:///./src/lib/field-play/editor/vectorFieldState.js","webpack:///./src/lib/field-play/programs/inputs/inputCollection.js","webpack:///./src/lib/field-play/programs/inputs/loadTexture.js","webpack:///./src/lib/field-play/programs/inputs/imageInput.js","webpack:///./src/lib/field-play/createInputsModel.js","webpack:///./src/lib/field-play/scene.js","webpack:///./src/components/FieldVisualization.vue?be20","webpack:///./src/components/FieldVisualization.vue","webpack:///./src/components/FieldVisualization.vue?c0e0","webpack:///./src/components/MuseRecorder.vue?e8d8","webpack:///./src/components/MuseRecorder.vue?c6a4","webpack:///./src/components/MuseRecorder.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/store.ts","webpack:///./src/main.ts","webpack:///./src/components/MuseRecorder.vue?2e20"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","index","jsonpScriptSrc","p","chunk-2d0e8bde","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","head","document","getElementsByTagName","script","createElement","charset","timeout","nc","setAttribute","src","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","undefined","setTimeout","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","eventify","require","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_FieldVisualization_vue_vue_type_style_index_0_id_9c0368c6_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_FieldVisualization_vue_vue_type_style_index_0_id_9c0368c6_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Session_vue_vue_type_style_index_0_id_684ff5ac_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Session_vue_vue_type_style_index_0_id_684ff5ac_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Visualization_vue_vue_type_style_index_0_id_888b4562_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Visualization_vue_vue_type_style_index_0_id_888b4562_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ParticlesVisualization_vue_vue_type_style_index_0_id_2f884374_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ParticlesVisualization_vue_vue_type_style_index_0_id_2f884374_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_0a24d9f9_render","_vm","this","_h","$createElement","_c","_self","attrs","id","staticRenderFns","MuseRecordervue_type_template_id_02c5b012_scoped_true_render","staticClass","alpha","beta1","beta2","beta3","gamma","paused","class","muse-recorder__greeting--connected","connectionStatus","_m","_v","on","click","$event","connectToMuse","staticStyle","font-size","icon","connectToRemoteController","goToRemoteController","_e","MuseRecordervue_type_template_id_02c5b012_scoped_true_staticRenderFns","Sessionvue_type_template_id_684ff5ac_scoped_true_render","width","height","_l","serie","toLowerCase","lineForSerie","_s","lastSessionPointForSerie","Sessionvue_type_template_id_684ff5ac_scoped_true_staticRenderFns","Sessionvue_type_script_lang_ts_Session","_Vue","Session","classCallCheck","possibleConstructorReturn","getPrototypeOf","arguments","inherits","createClass","_this","d3_shape","sessionData","map","v","xScale","yScale","blob","Blob","JSON","stringify","exportDate","Date","filename","concat","toISOString","FileSaver","keys","d3_scale","domain","range","lastSessionPoint","lodash_default","a","last","vue_property_decorator_umd","__decorate","default","Sessionvue_type_script_lang_ts_","components_Sessionvue_type_script_lang_ts_","component","componentNormalizer","options","__file","components_Session","Visualizationvue_type_template_id_888b4562_scoped_true_render","in","stdDeviation","values","in2","operator","brainWires","tk1","tk2","wire","filter","transform","originTranslation","fill","colors","Visualizationvue_type_template_id_888b4562_scoped_true_staticRenderFns","Visualizationvue_type_script_lang_ts_Vizualisation","Vizualisation","k1","k2","targetVal","_this2","duration","start","now","interpolator","d3_interpolate","animate","requestAnimationFrame","_this3","_this4","y","brainWire","curve","tension","wirePoints","k","d3_ease","masterPoints","leftPoint","leftMiddlePoint","middlePoint","rightMiddlePoint","rightPoint","wireWidth","points","reverse","verticalTranslation","Math","max","radius","circleOrSquareRatio","SQRT2","verticalSymetry","point","dy","sqrt","pow","Visualizationvue_type_script_lang_ts_decorate","Visualizationvue_type_script_lang_ts_","components_Visualizationvue_type_script_lang_ts_","Visualization_component","Visualization","CAMERA_DISTANCE","BOUNDS","X","Y","CIRCLE_RADIUS","POINTS_COUNT","POINTS_RENEWAL_CHANCE","ParticlesVisualizationvue_type_script_lang_ts_ParticlesVizualisation","ParticlesVizualisation","scene","three_module","renderer","preserveDrawingBuffer","autoClearColor","camera","innerWidth","innerHeight","fadeMaterial","color","transparent","opacity","depthWrite","fadePlane","fadeMesh","cameraGroup","add","translateZ","position","z","renderOrder","material","size","vertexColors","createCanvasMaterial","geometry","times","addRandomPoint","random","vertices","randomPositionOnPlane","setSize","$el","domElement","vertice","set","x","verticesNeedUpdate","isNaN","particle","h","horizontalMovement","circularMovement","squareMovement","weightedMovementAlongAxis","circleWeigth","squareWeigth","horizontalWeigth","movement","moveParticle","particleColor","dX","dY","dZ","colorsNeedUpdate","render","continue","matCanvas","matContext","getContext","texture","center","beginPath","arc","PI","closePath","fillStyle","needsUpdate","sin","θ","atan2","dr","dθ","cos","dx","lastAnimationId","cancelAnimationFrame","pause","dispose","ParticlesVisualizationvue_type_script_lang_ts_decorate","required","ParticlesVisualization_render","ParticlesVisualization_staticRenderFns","ParticlesVisualizationvue_type_script_lang_ts_","components_ParticlesVisualizationvue_type_script_lang_ts_","ParticlesVisualization_component","ParticlesVisualization","gl_utils","createTexture","bindFramebuffer","createProgram","createBuffer","bindAttribute","bindTexture","gl","unit","activeTexture","TEXTURE0","TEXTURE_2D","buffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","Uint8Array","texImage2D","RGBA","UNSIGNED_BYTE","framebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","attribute","numComponents","enableVertexAttribArray","vertexAttribPointer","FLOAT","vertexSource","fragmentSource","program","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","wrapper","unload","numAttributes","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","numUniforms","ACTIVE_UNIFORMS","uniform","getActiveUniform","getUniformLocation","deleteProgram","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","colorModes","UNIFORM","VELOCITY","ANGLE","CUSTOM","wrapVectorField","field","isSmallScreen","pendingSave","qs","queryState","useSearch","rewriteHashToSearch","currentState","defaultVectorField","defaults","timeStep","dropProbability","particleCount","fadeout","colorMode","ColorModes","settingsPanel","collapsed","appState","saveBBox","getBBox","makeBBox","getQS","saveCode","getCode","getDefaultCode","getDropProbability","setDropProbability","getIntegrationTimeStep","setIntegrationTimeStep","getParticleCount","setParticleCount","getFadeout","setFadeout","getColorMode","setColorMode","getColorFunction","setColorFunction","defined","cm","colorFunction","cf","fo","pc","dt","clamp","cx","cy","w","bboxDefined","w2","h2","minX","round","maxX","minY","maxY","bbox","vfCode","oldCode","code","number","Number","isFinite","min","onChange","bus","fire","NO_TRANSFORM","scale","makeScreenProgram","ctx","screenTexture","backgroundTexture","canvasRect","boundBoxTextureTransform","lastRenderedBoundingBox","updateScreenTextures","screenProgram","glUtils","getScreenVertexShader","getScreenFragmentShader","api","fadeOutLastFrame","renderCurrentScreen","boundingBoxUpdated","viewport","drawTexture","fadeOpacity","saveLastBbox","enable","BLEND","blendFunc","SRC_ALPHA","DST_ALPHA","clearColor","backgroundColor","g","b","clear","COLOR_BUFFER_BIT","disable","temp","audioTexture","emptyPixels","deleteTexture","NEAREST","textureTransform","useProgram","quadBuffer","a_pos","screenTextureUnit","uniform1i","u_screen","uniform1f","u_opacity_border","u_opacity","uniform3f","u_transform","drawArrays","TRIANGLES","BaseShaderNode","getInputUniforms","UserDefinedVelocityFunction","updateCode","newUpdateCode","snoise","RungeKuttaIntegrator","shaderBasedColor","colorCode","udf","integrate","getVariables","getMain","getMethods","getDefines","getFunctions","getColorFunctionBody","DrawParticleGraph","decodePositions","textureBasedPosition","colorParts","methods","addMethods","main","addMain","decodeFloatRGBA","join","producer","array","TexturePosition","isDecode","encodeFloatRGBA","renderNodes","nodes","forEach","node","addToCode","getMainBody","line","PanzoomTransform","config","decode","srcPosName","posName","UpdatePositionGraph","readStoredPosition","TexturePositionNode","udfVelocity","integratePositions","dropParticles","RandomParticleDropper","writeComputedPosition","panZoomDecode","panZoomEncode","velocityCode","setNewUpdateCode","val","out","writeOffset","mantissa","mag","abs","exponent","floor","log2","exp2","A","B","C","D","sign","exp","LN2","makeStatCounter","getMin","getMax","reset","POSITIVE_INFINITY","NEGATIVE_INFINITY","OUT_V_X","OUT_V_Y","colorProgram","velocity_y_texture","velocity_x_texture","particleStateResolution","pendingSpeedUpdate","numParticles","velocity_x","velocity_y","speedNeedsUpdate","velocityCounter","listenToEvents","updateParticlesPositions","updateParticlesCount","setColorMinMax","requestSpeedUpdate","off","disposeTextures","uniform2f","u_velocity_range","util","u_out_coordinate","readPixels","updateMinMax","vx","readFloat","vy","offset","textureCollection","dimensions","textures","textureInfo","glUtil","particleState","bindTextures","assignProgramUniforms","tInfo","particlePositionShaderCodeBuilder","updatePositionProgram","readTextures","writeTextures","updateProgram","pendingVectorLines","readVelocity","makeReadProgram","putVectorLinesRequestIntoQueue","prepareToDraw","updateVariable","vectorField","setCustomVectorField","fragment","getFragmentShader","vertex","getVertexShader","newProgram","ColorMode","varName","uniformLocation","inputs","updateBindings","u_rand_seed","frameSeed","u_h","integrationTimeStep","frame","cursor","uniform4f","clickX","clickY","hoverX","hoverY","u_min","u_max","u_drop_rate","writeInfo","processVectorLinesRequest","resolutionOfParticlesInRequest","resolution","texturesForRead","texturesForWrite","xStats","yStats","decoded_velocity_x","Float32Array","decoded_velocity_y","idx","vectorLineInfo","defaultConfig","isAudioEnabled","vectorLinesEnabled","FREE_TEXTURE_UNIT","showBindings","audioProgram","audioWidth","audioHeight","audioBuffer","audioDirty","updateAudioBuffer","updateTextures","newBuffer","drawParticlesProgram","particleIndexBuffer","drawProgram","currentVectorField","makeUpdatePositionProgram","initPrograms","drawParticles","updateColorMode","updateColorVariable","initDrawProgram","createAudioProgram","drawGraph","vertexShaderCode","updateVariableForDrawProgram","particleIndices","particleStateX","particleStateY","deleteBuffer","a_index","u_particles_res","POINTS","url","download","req","XMLHttpRequest","updateProgress","lengthComputable","progress","loaded","total","percent","transferComplete","status","response","responseType","parse","transferFailed","transferCanceled","addEventListener","open","send","loadedLinks","Map","fetchGLSL","link","trimmed","trim","cachedResponse","then","pragmaInclude","nullCode","makePragmaParser","parsedLines","processLineByLine","pending","catch","lines","split","outputLines","currentIndex","processPragma","indexOf","include","substr","insertIndex","glslParser","check","log","errorCount","vectorFieldGlobals","getParsedVectorFieldFunction","vectorFieldCode","pragmaParse","pragmaParseResult","parserResult","globals","parserError","diag","diagnostics","firstError","lineColumn","_lineOffsets","contents","column","substring","end","prefix","diagText","text","whitespace","errorDetail","isFloatError","Array","createVectorFieldEditorState","parseCode","currentVectorFieldVersion","currentVectorFieldCode","loadCodeFromAppState","setCode","trySetNewCode","cancelled","updateErrorInfo","persistedCode","customCode","currentResult","capturedVersion","message","createInputCollection","currentProgram","boundInputs","bindInput","inputIndex","inputBinding","prevBinding","updateInputBinding","input","updateBinding","loadTexture","resolveTexture","rejectTexture","image","Image","crossOrigin","reportError","level","internalFormat","srcFormat","srcType","isPowerOf2","generateMipmap","LINEAR","createImageInputBinding","callbacks","setTexture","handleError","loadedTexture","done","realIndex","createInputsModel","readInputsFromAppState","getInputs","addInput","inputNumber","vm","createInputElementViewModel","i0","pendingUpdate","immediate","setBinding","binding","INITIAL_SPEED","integrationTimeStepFromSpeed","speed","fadeOutFromSpeed","initScene","top","left","setWidthHeight","onResize","currentPanZoomTransform","DEPTH_TEST","STENCIL_TEST","lastAnimationFrame","lastAnimationFrameTime","createFramebuffer","isPaused","inputsModel","createScreenProgram","createDrawParticlesProgram","vectorFieldEditorState","nextFrame","stop","setPaused","getParticlesCount","setParticlesCount","setFadeOutSpeed","getFadeOutSpeed","getSpeed","setSpeed","setBackgroundColor","getCanvasRect","getBoundingBox","restoreBBox","parseInt","f","parseFloat","shouldPause","newParticleCount","updateBoundingBox","devicePixelRatio","canvas","style","removeEventListener","draw","timeSinceLastFrame","performanceRatio","correctedSpeed","drawScreen","ceil","E","clientX","clientY","FieldVisualizationvue_type_script_lang_ts_FieldVizualisation","FieldVizualisation","ctxOptions","antialias","updateVectorField","updateColorFunction","actuallyPaused","remove","toFixed","GLSLcode","k3","k4","k5","kColor","codeLines","circle","squares","whirl","cloverfield","ka","kb","FieldVisualizationvue_type_script_lang_ts_decorate","FieldVisualization_render","FieldVisualization_staticRenderFns","FieldVisualizationvue_type_script_lang_ts_","components_FieldVisualizationvue_type_script_lang_ts_","FieldVisualization_component","FieldVisualization","index_es","library","faBluetooth_default","faBluetoothB_default","faPlayCircle_default","faPauseCircle_default","faCaretSquareDown_default","faCaretSquareUp_default","faPlay_default","faStop_default","faChartLine_default","faInfoCircle_default","faSyncAlt_default","faSlidersH_default","faTimes_default","faCamera_default","MuseRecordervue_type_script_lang_ts_MuseRecorder","MuseRecorder","sessionInProgress","vizControlsDisplayed","infoPanelOpened","screenshotPanelOpened","screenshotEmail","screenshotSent","currentSession","sessionsDetailsOpened","partyMode","partyScales","ALPHA","BETA_1","BETA_2","BETA_3","GAMMA","museClient","muse","location","href","socket","lib_default","reconnectionAttempts","controlValues","connect","subscribe","cS","startSession","currentSessionSubscription","unsubscribe","relativeBandPowers","pipe","operators","sessions","band","power","session","bandSession","find","NaN","reduce","sumOfSessions","bandSessionValue","rbps","arbps","rbp","some","freeze","takeRight","toConsumableArray","reload","_this5","querySelector","toBlob","toString","stopSession","MuseRecordervue_type_script_lang_ts_decorate","components","FontAwesomeIcon","vue_fontawesome_default","MuseRecordervue_type_script_lang_ts_","components_MuseRecordervue_type_script_lang_ts_","MuseRecorder_component","components_MuseRecorder","Appvue_type_script_lang_ts_App","App","Appvue_type_script_lang_ts_decorate","Appvue_type_script_lang_ts_","src_Appvue_type_script_lang_ts_","App_component","src_App","vue_runtime_esm","use","vuex_esm","store","Store","state","mutations","actions","productionTip","$mount","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MuseRecorder_vue_vue_type_style_index_0_id_02c5b012_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MuseRecorder_vue_vue_type_style_index_0_id_02c5b012_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"aACA,SAAAA,EAAAC,GAQA,IAPA,IAMAC,EAAAC,EANAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GACAK,EAAAL,EAAA,GAIAM,EAAA,EAAAC,EAAA,GACQD,EAAAH,EAAAK,OAAoBF,IAC5BJ,EAAAC,EAAAG,GACAG,EAAAP,IACAK,EAAAG,KAAAD,EAAAP,GAAA,IAEAO,EAAAP,GAAA,EAEA,IAAAD,KAAAG,EACAO,OAAAC,UAAAC,eAAAC,KAAAV,EAAAH,KACAc,EAAAd,GAAAG,EAAAH,IAGAe,KAAAhB,GAEA,MAAAO,EAAAC,OACAD,EAAAU,OAAAV,GAOA,OAHAW,EAAAR,KAAAS,MAAAD,EAAAb,GAAA,IAGAe,IAEA,SAAAA,IAEA,IADA,IAAAC,EACAf,EAAA,EAAiBA,EAAAY,EAAAV,OAA4BF,IAAA,CAG7C,IAFA,IAAAgB,EAAAJ,EAAAZ,GACAiB,GAAA,EACAC,EAAA,EAAkBA,EAAAF,EAAAd,OAA2BgB,IAAA,CAC7C,IAAAC,EAAAH,EAAAE,GACA,IAAAf,EAAAgB,KAAAF,GAAA,GAEAA,IACAL,EAAAQ,OAAApB,IAAA,GACAe,EAAAM,IAAAC,EAAAN,EAAA,KAGA,OAAAD,EAIA,IAAAQ,EAAA,GAKApB,EAAA,CACAqB,MAAA,GAGAZ,EAAA,GAGA,SAAAa,EAAA7B,GACA,OAAAyB,EAAAK,EAAA,UAA6C9B,OAAA,KAA6B+B,iBAAA,YAA4B/B,GAAA,MAItG,SAAAyB,EAAA1B,GAGA,GAAA4B,EAAA5B,GACA,OAAA4B,EAAA5B,GAAAiC,QAGA,IAAAC,EAAAN,EAAA5B,GAAA,CACAK,EAAAL,EACAmC,GAAA,EACAF,QAAA,IAUA,OANAnB,EAAAd,GAAAa,KAAAqB,EAAAD,QAAAC,IAAAD,QAAAP,GAGAQ,EAAAC,GAAA,EAGAD,EAAAD,QAKAP,EAAAU,EAAA,SAAAnC,GACA,IAAAoC,EAAA,GAKAC,EAAA9B,EAAAP,GACA,OAAAqC,EAGA,GAAAA,EACAD,EAAA5B,KAAA6B,EAAA,QACK,CAEL,IAAAC,EAAA,IAAAC,QAAA,SAAAC,EAAAC,GACAJ,EAAA9B,EAAAP,GAAA,CAAAwC,EAAAC,KAEAL,EAAA5B,KAAA6B,EAAA,GAAAC,GAGA,IAEAI,EAFAC,EAAAC,SAAAC,qBAAA,WACAC,EAAAF,SAAAG,cAAA,UAGAD,EAAAE,QAAA,QACAF,EAAAG,QAAA,IACAxB,EAAAyB,IACAJ,EAAAK,aAAA,QAAA1B,EAAAyB,IAEAJ,EAAAM,IAAAvB,EAAA7B,GAEA0C,EAAA,SAAAW,GAEAP,EAAAQ,QAAAR,EAAAS,OAAA,KACAC,aAAAP,GACA,IAAAQ,EAAAlD,EAAAP,GACA,OAAAyD,EAAA,CACA,GAAAA,EAAA,CACA,IAAAC,EAAAL,IAAA,SAAAA,EAAAM,KAAA,UAAAN,EAAAM,MACAC,EAAAP,KAAAQ,QAAAR,EAAAQ,OAAAT,IACAU,EAAA,IAAAC,MAAA,iBAAA/D,EAAA,cAAA0D,EAAA,KAAAE,EAAA,KACAE,EAAAH,KAAAD,EACAI,EAAAE,QAAAJ,EACAH,EAAA,GAAAK,GAEAvD,EAAAP,QAAAiE,IAGA,IAAAhB,EAAAiB,WAAA,WACAxB,EAAA,CAAwBiB,KAAA,UAAAE,OAAAf,KAClB,MACNA,EAAAQ,QAAAR,EAAAS,OAAAb,EACAC,EAAAwB,YAAArB,GAGA,OAAAP,QAAA6B,IAAAhC,IAIAX,EAAA4C,EAAAxD,EAGAY,EAAA6C,EAAA3C,EAGAF,EAAA8C,EAAA,SAAAvC,EAAAwC,EAAAC,GACAhD,EAAAiD,EAAA1C,EAAAwC,IACA/D,OAAAkE,eAAA3C,EAAAwC,EAAA,CAA0CI,YAAA,EAAAC,IAAAJ,KAK1ChD,EAAAqD,EAAA,SAAA9C,GACA,qBAAA+C,eAAAC,aACAvE,OAAAkE,eAAA3C,EAAA+C,OAAAC,YAAA,CAAwDC,MAAA,WAExDxE,OAAAkE,eAAA3C,EAAA,cAAiDiD,OAAA,KAQjDxD,EAAAyD,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAxD,EAAAwD,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,kBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAA5E,OAAA6E,OAAA,MAGA,GAFA7D,EAAAqD,EAAAO,GACA5E,OAAAkE,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAxD,EAAA8C,EAAAc,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIA5D,EAAAgE,EAAA,SAAAxD,GACA,IAAAwC,EAAAxC,KAAAmD,WACA,WAA2B,OAAAnD,EAAA,YAC3B,WAAiC,OAAAA,GAEjC,OADAR,EAAA8C,EAAAE,EAAA,IAAAA,GACAA,GAIAhD,EAAAiD,EAAA,SAAAgB,EAAAC,GAAsD,OAAAlF,OAAAC,UAAAC,eAAAC,KAAA8E,EAAAC,IAGtDlE,EAAAK,EAAA,IAGAL,EAAAmE,GAAA,SAAAC,GAA8D,MAApBC,QAAAhC,MAAA+B,GAAoBA,GAE9D,IAAAE,EAAAC,OAAA,gBAAAA,OAAA,oBACAC,EAAAF,EAAAvF,KAAAgF,KAAAO,GACAA,EAAAvF,KAAAX,EACAkG,IAAAG,QACA,QAAA9F,EAAA,EAAgBA,EAAA2F,EAAAzF,OAAuBF,IAAAP,EAAAkG,EAAA3F,IACvC,IAAAU,EAAAmF,EAIAjF,EAAAR,KAAA,qBAEAU,yECrNA,IAAIiF,EAAWC,EAAQ,QAEvBnE,EAAOD,QAAUmE,EAAS,gFCN1B,IAAAE,EAAA5E,EAAA,QAAA6E,EAAA7E,EAAAgE,EAAAY,GAA8iBC,EAAG,uCCAjjB,IAAAC,EAAA9E,EAAA,QAAA+E,EAAA/E,EAAAgE,EAAAc,GAAkfC,EAAG,gECArf,IAAAC,EAAAhF,EAAA,QAAAiF,EAAAjF,EAAAgE,EAAAgB,GAAmiBC,EAAG,yFCAtiB,IAAAC,EAAAlF,EAAA,QAAAmF,EAAAnF,EAAAgE,EAAAkB,GAAyiBC,EAAG,uCCA5iB,IAAAC,EAAApF,EAAA,QAAAqF,EAAArF,EAAAgE,EAAAoB,GAAkjBC,EAAG,wICAjjBC,EAAM,WAAgB,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,MAAA,CAAOC,GAAA,sBAA0B,CAAAH,EAAA,qBAC3II,EAAA,2ECDIC,EAAM,WAAgB,IAAAT,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBM,YAAA,iBAA4B,CAAAN,EAAA,OAAYM,YAAA,gCAA2C,CAAAN,EAAA,uBAA4BE,MAAA,CAAOK,MAAAX,EAAAW,MAAAC,MAAAZ,EAAAY,MAAAC,MAAAb,EAAAa,MAAAC,MAAAd,EAAAc,MAAAC,MAAAf,EAAAe,MAAAtC,EAAAuB,EAAAvB,EAAAuC,OAAAhB,EAAAgB,WAAyH,MAAAhB,EAAAvB,EAAA2B,EAAA,OAA6BM,YAAA,0BAAAO,MAAA,CAA6CC,qCAAAlB,EAAAmB,mBAAAnB,EAAAgB,SAA2E,CAAAhB,EAAAoB,GAAA,GAAAhB,EAAA,OAAsBM,YAAA,gCAA2C,CAAAN,EAAA,OAAYM,YAAA,sCAAiD,CAAAV,EAAAqB,GAAA,iGAAAjB,EAAA,OAAoHM,YAAA,sCAAAY,GAAA,CAAsDC,MAAA,SAAAC,GAAyBxB,EAAAyB,mBAAsB,CAAAzB,EAAAqB,GAAA,oBAAAjB,EAAA,qBAAqDsB,YAAA,CAAaC,YAAA,WAAsBrB,MAAA,CAAQsB,KAAA,WAAe,GAAAxB,EAAA,OAAgBM,YAAA,sCAAiD,CAAAV,EAAAqB,GAAA,0FAAAjB,EAAA,qBAA2HsB,YAAA,CAAaC,YAAA,WAAsBrB,MAAA,CAAQsB,KAAA,WAAe,GAAAxB,EAAA,MAAAA,EAAA,OAAyBM,YAAA,sCAAAY,GAAA,CAAsDC,MAAA,SAAAC,GAAyBxB,EAAA6B,+BAAkC,CAAA7B,EAAAqB,GAAA,0BAAAjB,EAAA,qBAA2DsB,YAAA,CAAaC,YAAA,WAAsBrB,MAAA,CAAQsB,KAAA,WAAe,GAAAxB,EAAA,OAAgBM,YAAA,sCAAAY,GAAA,CAAsDC,MAAA,SAAAC,GAAyBxB,EAAA8B,0BAA6B,CAAA9B,EAAAqB,GAAA,0BAAAjB,EAAA,qBAA2DsB,YAAA,CAAaC,YAAA,WAAsBrB,MAAA,CAAQsB,KAAA,WAAe,OAAA5B,EAAA+B,QACtpDC,EAAe,YAAiB,IAAAhC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBM,YAAA,iCAA4C,CAAAN,EAAA,OAAYsB,YAAA,CAAaC,YAAA,QAAmB,CAAA3B,EAAAqB,GAAA,4BAAAjB,EAAA,OAA+CsB,YAAA,CAAaC,YAAA,QAAmB,CAAA3B,EAAAqB,GAAA,0BAAAjB,EAAA,OAA6CsB,YAAA,CAAaC,YAAA,QAAmB,CAAA3B,EAAAqB,GAAA,6JCDpWY,EAAM,WAAgB,IAAAjC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBM,YAAA,0BAAqC,CAAAN,EAAA,OAAYM,YAAA,iBAAAJ,MAAA,CAAoC4B,MAAAlC,EAAAkC,MAAAC,OAAAnC,EAAAmC,SAAuCnC,EAAAoC,GAAApC,EAAA,gBAAAqC,GAAqC,OAAAjC,EAAA,QAAkB7B,IAAA8D,EAAApB,MAAA,qCAAAoB,EAAAC,eAAAhC,MAAA,CAAoF/C,EAAAyC,EAAAuC,aAAAF,SAA+BjC,EAAA,OAAaM,YAAA,mBAA8BV,EAAAoC,GAAApC,EAAA,gBAAAqC,GAAqC,OAAAjC,EAAA,OAAiB7B,IAAA8D,EAAApB,MAAA,mDAAAoB,EAAAC,gBAA2F,CAAAlC,EAAA,OAAYM,YAAA,iCAA2CN,EAAA,QAAAJ,EAAAqB,GAAArB,EAAAwC,GAAAH,MAAArC,EAAAqB,GAAA,OAAAjB,EAAA,QAAAJ,EAAAqB,GAAA,IAAArB,EAAAwC,GAAAxC,EAAAyC,yBAAAJ,IAAA,eAC/nBK,EAAe,olBCwCEC,EAArB,SAAAC,GAAA,SAAAC,IAAA,OAAApJ,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAA4C,GAAApJ,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAAoJ,GAAA5I,MAAAgG,KAAAgD,YAAA,OAAAxJ,OAAAyJ,EAAA,KAAAzJ,CAAAoJ,EAAAD,GAAAnJ,OAAA0J,EAAA,KAAA1J,CAAAoJ,EAAA,EAAAtE,IAAA,eAAAN,MAAA,SAoCuBoE,GAAa,IAAAe,EAAAnD,KAChC,OAAOxG,OAAA4J,EAAA,KAAA5J,GAAOwG,KAAKqD,YAAYC,IAC7B,SAACC,EAAGpK,GAAJ,MAAU,CACRgK,EAAKK,OAAOrK,GACZgK,EAAKM,OAAOF,EAAEnB,UAxCtB,CAAA9D,IAAA,aAAAN,MAAA,WA8CI,IAAI0F,EAAO,IAAIC,KACb,CAACC,KAAKC,UAAU7D,KAAKqD,YAAa,KAAM,IACxC,CAAC3G,KAAM,mCAELoH,EAAa,IAAIC,KACjBC,EAAQ,gBAAAC,OAAmBH,EAAWI,cAA9B,SACZ1K,OAAA2K,EAAA,UAAA3K,CAAOkK,EAAMM,KApDjB,CAAA1F,IAAA,SAAAV,IAAA,WAWI,OAAOpE,OAAO4K,KAAKpE,KAAKqD,YAAY,IAAM,MAX9C,CAAA/E,IAAA,SAAAV,IAAA,WAeI,OAAOpE,OAAA6K,EAAA,KAAA7K,GACJ8K,OAAO,CAAC,EAAGtE,KAAKqD,YAAYhK,OAAS,IACrCkL,MAAM,CAAC,EAAGvE,KAAKiC,UAjBtB,CAAA3D,IAAA,SAAAV,IAAA,WAqBI,OAAOpE,OAAA6K,EAAA,KAAA7K,GACJ8K,OAAO,CAAC,EAAG,KACXC,MAAM,CAACvE,KAAKkC,OAAQ,MAvB3B,CAAA5D,IAAA,2BAAAV,IAAA,WA2BI,IAAI4G,EAAmBC,EAAAC,EAAEC,KAAK3E,KAAKqD,aACnC,OAAO,SAACjB,GACN,OAAKoC,GAAoBA,EAAiBpC,GACjCoC,EAAiBpC,GAEjB,SAhCfQ,EAAA,CAAqCgC,EAAA,QAEnCC,EAAA,CADCrL,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,+DAIjBD,EAAA,CADCrL,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,2DAIjBD,EAAA,CADCrL,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,4DAPEpC,EAAOmC,EAAA,CAD3BD,EAAA,cACoBlC,GAAA,IAAAqC,EAAA,ECzC6WC,EAAA,0BCQlYC,EAAgBzL,OAAA0L,EAAA,KAAA1L,CACdwL,EACAhD,EACAS,GACF,EACA,KACA,WACA,MAIAwC,EAAAE,QAAAC,OAAA,cACe,IAAAC,EAAAJ,UCpBXK,EAAM,WAAgB,IAAAvF,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBM,YAAA,sBAAAJ,MAAA,CAAyC6B,OAAAnC,EAAAmC,OAAAD,MAAAlC,EAAAkC,QAAuC,CAAA9B,EAAA,QAAAA,EAAA,UAA0BE,MAAA,CAAOC,GAAA,QAAY,CAAAH,EAAA,kBAAuBE,MAAA,CAAOkF,GAAA,gBAAAC,aAAA,KAAAtL,OAAA,UAA0DiG,EAAA,iBAAsBE,MAAA,CAAOkF,GAAA,OAAArH,KAAA,SAAAuH,OAAA,gDAAAvL,OAAA,SAAqGiG,EAAA,eAAoBE,MAAA,CAAOkF,GAAA,gBAAAG,IAAA,MAAAC,SAAA,WAAoD,KAAAxF,EAAA,KAAgBM,YAAA,eAA0BV,EAAAoC,GAAApC,EAAA6F,WAAA7F,EAAA8F,IAAA9F,EAAA+F,KAAA,SAAAC,EAAA5M,GAA4D,OAAAgH,EAAA,QAAkB7B,IAAAnF,EAAAsH,YAAA,aAAAJ,MAAA,CAAsC2F,OAAA,YAAAC,UAAAlG,EAAAmG,kBAAA5I,EAAAyI,EAAAI,KAAApG,EAAAqG,OAAAjN,YAC1qBkN,EAAe,4jBCmCEC,EAArB,SAAA3D,GADA,SAAA4D,IAAA,IAAApD,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAuG,kEAQEpD,EAAA0C,IAAc1C,EAAKqD,GACnBrD,EAAA2C,IAAc3C,EAAKsD,GAEnBtD,EAAAiD,OAAS,CAAC,OAAQ,OAAQ,QAX5BjD,EACA,OAAA3J,OAAAyJ,EAAA,KAAAzJ,CAAA+M,EAAA5D,GAAAnJ,OAAA0J,EAAA,KAAA1J,CAAA+M,EAAA,EAAAjI,IAAA,YAAAN,MAAA,SAca0I,GAAiB,IAAAC,EAAA3G,KACtB4G,EAAW,IACXC,EAAQ9C,KAAK+C,MACbC,EAAevN,OAAAwN,EAAA,KAAAxN,CAAkBwG,KAAK6F,IAAea,GACrDO,EAAU,SAAVA,IACF,IAAIhJ,GAAK8F,KAAK+C,MAAQD,GAASD,EAC3B3I,GAAK,EACP0I,EAAKd,IAAMa,GAEXQ,sBAAsBD,GACtBN,EAAKd,IAAMkB,EAAa9I,KAG5BgJ,MA3BJ,CAAA3I,IAAA,YAAAN,MAAA,SA+Ba0I,GAAiB,IAAAS,EAAAnH,KACtB4G,EAAW,IACXC,EAAQ9C,KAAK+C,MACbC,EAAevN,OAAAwN,EAAA,KAAAxN,CAAkBwG,KAAK8F,IAAeY,GACrDO,EAAU,SAAVA,IACF,IAAIhJ,GAAK8F,KAAK+C,MAAQD,GAASD,EAC3B3I,GAAK,EACPkJ,EAAKrB,IAAMY,GAEXQ,sBAAsBD,GACtBE,EAAKrB,IAAMiB,EAAa9I,KAG5BgJ,MA5CJ,CAAA3I,IAAA,aAAAN,MAAA,SAyDcwI,EAAYC,GAAU,IAAAW,EAAApH,KAChC,MAAO,EAAC,GAAM,EAAG,IAAKsD,IAAI,SAAA+D,GAAC,OAAID,EAAKE,UAAUd,EAAIC,EAAIY,OA1D1D,CAAA/I,IAAA,YAAAN,MAAA,SA6DawI,EAAYC,EAAYY,GACjC,IAAIE,EAAQ/N,OAAA4J,EAAA,KAAA5J,GAAO+N,MACjBnE,EAAA,KAAcoE,QAAQH,IAGxB,OAAOE,EAAMvH,KAAKyH,WAAWjB,EAAIC,EAAIY,MAlEzC,CAAA/I,IAAA,aAAAN,MAAA,SAqEcwI,EAAYC,EAAYY,GAClC,IAAIK,EAAIlB,EAAKhN,OAAAmO,EAAA,KAAAnO,CAAW6N,IAAMZ,EAAKD,GAE/BoB,EAAe,CACjB5H,KAAK6H,UAAUH,EAAGL,GAClBrH,KAAK8H,gBAAgBJ,EAAGL,GACxBrH,KAAK+H,YAAYL,EAAGL,GACpBrH,KAAKgI,iBAAiBN,EAAGL,GACzBrH,KAAKiI,WAAWP,EAAGL,IAGjBa,EAAY,IAEZC,EAASP,EAAatE,IACxB,SAACzI,GAAD,MAAyB,CAACA,EAAE,GAAIA,EAAE,GAAKqN,EAAY,KACnDjE,OACA2D,EAAaQ,UAAU9E,IACrB,SAACzI,GAAD,MAAyB,CAACA,EAAE,IAAMA,EAAE,GAAKqN,EAAY,MAMzD,OAFAC,EAAO5O,KAAK4O,EAAO,IAEZA,EAAO7E,IAAItD,KAAKqI,qBAAsBrI,KAAKiC,MAAQ,EAA6B,GAAxB,EAAIqG,KAAKC,IAAI/B,EAAIC,IAAWY,EAAIrH,KAAKwI,WA5FxG,CAAAlK,IAAA,YAAAN,MAAA,SAqGa0J,EAAWL,GACpB,MAAO,CACL7N,OAAAwN,EAAA,KAAAxN,EAAoBwG,KAAKiC,MAAQ,GAAKjC,KAAKwI,OAA3ChP,CAAmDA,OAAAmO,EAAA,KAAAnO,CAAYkO,IAE/DlO,OAAAwN,EAAA,KAAAxN,CAAkB,EAAGwG,KAAKwI,OAA1BhP,CAAmC6N,EAAIK,MAzG7C,CAAApJ,IAAA,kBAAAN,MAAA,SA6GmB0J,EAAWL,GAC1B,IAAIoB,EAAsBjP,OAAAwN,EAAA,KAAAxN,CAAkB8O,KAAKI,MAAQ,EAAG,GAE5D,MAAO,CACLlP,OAAAwN,EAAA,KAAAxN,EAAoBwG,KAAKiC,MAAQ,GAAKjC,KAAKwI,OAASC,EAAoBpB,GAAxE7N,CAA4EA,OAAAmO,EAAA,KAAAnO,CAAYkO,IAExFlO,OAAAwN,EAAA,KAAAxN,CAAkB,GAAKwG,KAAKwI,OAASC,EAAoBpB,GAAzD7N,CAA6DA,OAAAmO,EAAA,KAAAnO,CAAUkO,IAAMlO,OAAAwN,EAAA,KAAAxN,CAAkB,EAAGwG,KAAKwI,OAA1BhP,CAAmC6N,EAAIK,MAnH1H,CAAApJ,IAAA,cAAAN,MAAA,SAuHe0J,EAAWL,GACtB,MAAO,CACL,EAEA7N,OAAAwN,EAAA,KAAAxN,CAAkB,GAAKwG,KAAKwI,OAA5BhP,CAAoCA,OAAAmO,EAAA,KAAAnO,CAAakO,IAAMlO,OAAAwN,EAAA,KAAAxN,CAAkB,EAAGwG,KAAKwI,OAA1BhP,CAAmC6N,EAAIK,MA3HpG,CAAApJ,IAAA,mBAAAN,MAAA,SA+HoB0J,EAAWL,GAC3B,OAAOrH,KAAK2I,gBAAgB3I,KAAK8H,gBAAgBJ,EAAGL,MAhIxD,CAAA/I,IAAA,aAAAN,MAAA,SAmIc0J,EAAWL,GACrB,OAAOrH,KAAK2I,gBAAgB3I,KAAK6H,UAAUH,EAAGL,MApIlD,CAAA/I,IAAA,kBAAAN,MAAA,SAuImB4K,GACf,MAAO,EACJA,EAAM,GAAIA,EAAM,MAzIvB,CAAAtK,IAAA,oBAAAN,MAAA,SA6IqB4K,GACjB,MAAO,CACLA,EAAM,IAAKA,EAAM,MA/IvB,CAAAtK,IAAA,sBAAAN,MAAA,SAmJuB6K,GACnB,OAAO,SAASD,GACd,MAAO,CACLA,EAAM,GAAIC,EAAKD,EAAM,OAtJ7B,CAAAtK,IAAA,oBAAAV,IAAA,WAsDI,mBAAAqG,OAAoBjE,KAAKiC,MAAQ,EAAjC,MAAAgC,OAAuCjE,KAAKkC,OAA5C,OAtDJ,CAAA5D,IAAA,SAAAV,IAAA,WAgGI,OAAO0K,KAAKQ,KACVR,KAAKS,IAAK/I,KAAKiC,MAAQ,EAAI,GAAKqG,KAAKS,IAAK/I,KAAKkC,OAAS,EAAI,IAC1D,MAlGRqE,EAAA,CAA2C3B,EAAA,QAEzCoE,EAAA,CADCxP,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,sDAIjBkE,EAAA,CADCxP,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,sDAUjBkE,EAAA,CADCxP,OAAAoL,EAAA,SAAApL,CAAM,uHAeN,MAGDwP,EAAA,CADCxP,OAAAoL,EAAA,SAAApL,CAAM,uHAeN,MAGDwP,EAAA,CADCxP,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,4DAIjBkE,EAAA,CADCxP,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,QAAS,2DAlDEwB,EAAa0C,EAAA,CADjCpE,EAAA,cACoB0B,GAAA,IAAA2C,EAAA,ECpCmXC,EAAA,ECQpYC,aAAY3P,OAAA0L,EAAA,KAAA1L,CACd0P,EACA5D,EACAe,GACF,EACA,KACA,WACA,OAIA8C,EAAShE,QAAAC,OAAA,oBACM,IAAAgE,EAAAD,mkBCTTE,EAAkB,IAClBC,EAAS,CACbC,EAAqB,EAAlBF,EACHG,EAAqB,EAAlBH,GAGCI,EAAgBJ,EAAkBf,KAAKI,MAIvCgB,EAAe,IACfC,EAAwB,KAGTC,EAArB,SAAAjH,GAAA,SAAAkH,IAAA,OAAArQ,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAA6J,GAAArQ,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAAqQ,GAAA7P,MAAAgG,KAAAgD,YAAA,OAAAxJ,OAAAyJ,EAAA,KAAAzJ,CAAAqQ,EAAAlH,GAAAnJ,OAAA0J,EAAA,KAAA1J,CAAAqQ,EAAA,EAAAvL,IAAA,UAAAN,MAAA,WAkBIgC,KAAK8J,MAAQ,IAAIC,EAAA,KAEjB/J,KAAKgK,SAAW,IAAID,EAAA,KAAc,CAChCE,uBAAuB,IAEzBjK,KAAKgK,SAASE,gBAAiB,EAE/BlK,KAAKmK,OAAS,IAAIJ,EAAA,KAAmB,IAAKhL,OAAOqL,WAAarL,OAAOsL,YAAa,GAAK,KAIvF,IAAIC,EAAe,IAAIP,EAAA,KAAwB,CAC7CQ,MAAO,EACPC,aAAa,EACbC,QAAS,IACTC,YAAY,IAEVC,EAAY,IAAIZ,EAAA,KAA0B,EAAG,GAC7Ca,EAAW,IAAIb,EAAA,KAAWY,EAAWL,GAGrCO,EAAc,IAAId,EAAA,KACtBc,EAAYC,IAAI9K,KAAKmK,QACrBU,EAAYC,IAAIF,GAChBC,EAAYE,WAAW1B,GAGvBuB,EAASI,SAASC,GAAK,GAGvBL,EAASM,aAAe,EAExBlL,KAAK8J,MAAMgB,IAAID,GAGf,IAAIM,EAAW,IAAIpB,EAAA,KAAqB,CACtCqB,KAAM,EACNC,aAActB,EAAA,KACdU,QAAS,GACTD,aAAa,EACblH,IAAKtD,KAAKsL,qBAAqB,QAAS,IACxCZ,YAAY,IAEd1K,KAAKuL,SAAW,IAAIxB,EAAA,KAEpBtF,EAAAC,EAAE8G,MAAM9B,EAAc1J,KAAKyL,gBAC3BzL,KAAKmI,OAAS,IAAI4B,EAAA,KAAa/J,KAAKuL,SAAUJ,GAE9CnL,KAAK8J,MAAMgB,IAAI9K,KAAKmI,UAlExB,CAAA7J,IAAA,wBAAAN,MAAA,WAsEI,OAAO,IAAI+L,EAAA,KACT,GAAKzB,KAAKoD,SAAW,IAAOpC,EAAOC,EACnC,GAAKjB,KAAKoD,SAAW,IAAOpC,EAAOE,EACnC,KAzEN,CAAAlL,IAAA,iBAAAN,MAAA,WA8EIgC,KAAKuL,SAASI,SAASpS,KAAKyG,KAAK4L,yBAEjC5L,KAAKuL,SAASnF,OAAO7M,KAAK,IAAIwQ,EAAA,KAC5BzB,KAAKoD,SAAUpD,KAAKoD,SAAUpD,KAAKoD,aAjFzC,CAAApN,IAAA,UAAAN,MAAA,WAsFIgC,KAAKgK,SAAS6B,QAAQ9M,OAAOqL,WAAYrL,OAAOsL,aAChDrK,KAAKiH,UACLjH,KAAK8L,IAAI5O,YAAY8C,KAAKgK,SAAS+B,cAxFvC,CAAAzN,IAAA,UAAAN,MAAA,WA2GS,IAAAmF,EAAAnD,KAELA,KAAKuL,SAASI,SAASrI,IAAI,SAAC0I,GAC1B,GAAI1D,KAAKoD,UAAY/B,EAAuB,CAC1C,IAAIpG,EAAIJ,EAAKyI,wBACbI,EAAQC,IAAI1I,EAAE2I,EAAG3I,EAAE8D,EAAG9D,EAAE0H,GACxB9H,EAAKoI,SAASY,oBAAqB,KAKjC1H,EAAAC,EAAE0H,MAAMpM,KAAKwG,KAAQ/B,EAAAC,EAAE0H,MAAMpM,KAAKyG,MACtCzG,KAAKuL,SAASI,SAASrI,IAAK,SAAC+I,GAC3B,IAAIC,EAAInJ,EAAKoJ,mBAAmBF,GAC5BhP,EAAI8F,EAAKqJ,iBAAiBH,GAC1B5R,EAAI0I,EAAKsJ,eAAeJ,GAExBK,EAA4B,SAACJ,EAAWjP,EAAW5C,GAAvB,OAC9B0I,EAAKwJ,aAAetP,EAAI8F,EAAKyJ,aAAenS,EAAI0I,EAAK0J,iBAAmBP,GAEtEQ,EAA6B,CAC/BJ,EAA0BJ,EAAE,GAAIjP,EAAE,GAAI5C,EAAE,IACxCiS,EAA0BJ,EAAE,GAAIjP,EAAE,GAAI5C,EAAE,KAE1C0I,EAAK4J,aACHV,EAAUS,KAId9M,KAAKuL,SAASY,oBAAqB,GAGrCnM,KAAKuL,SAASnF,OAAO9C,IAAK,SAAC0J,GACzB,IAAIC,EAAIC,EAAIC,EACZF,GAAM3E,KAAKoD,SAAW,IAAO,EAC7BwB,GAAM5E,KAAKoD,SAAW,IAAO,EAC7ByB,GAAM7E,KAAKoD,SAAW,IAAO,EAE7BsB,EAAclC,IAAI,IAAIf,EAAA,KAAYkD,EAAIC,EAAIC,MAE5CnN,KAAKuL,SAAS6B,kBAAmB,EAEjCpN,KAAKgK,SAASqD,OAAOrN,KAAK8J,MAAO9J,KAAKmK,QACtCnK,KAAKsN,aAtJT,CAAAhP,IAAA,uBAAAN,MAAA,SAyJwBuM,EAAea,GACnC,IAAImC,EAAY5R,SAASG,cAAc,UACvCyR,EAAUtL,MAAQsL,EAAUrL,OAASkJ,EACrC,IAAIoC,EAAaD,EAAUE,WAAW,MAClCC,EAAU,IAAI3D,EAAA,KAAcwD,GAChC,IAAKC,EACH,OAAO,IAAIzD,EAAA,KAGb,IAAI4D,EAASvC,EAAO,EAQpB,OAPAoC,EAAWI,YACXJ,EAAWK,IAAIF,EAAQA,EAAQA,EAAQ,EAAG,EAAIrF,KAAKwF,IACnDN,EAAWO,YACXP,EAAWQ,UAAYzD,EACvBiD,EAAWrH,OAEXuH,EAAQO,aAAc,EACfP,IA1KX,CAAApP,IAAA,eAAAN,MAAA,SA6KgBqO,EAAwBS,GACpCT,EAASH,GAAKY,EAAS,GACvBT,EAAShF,GAAKyF,EAAS,GAEnBT,EAASH,EAAI5C,EAAOC,IACtB8C,EAASH,GAAK,EAAI5C,EAAOC,GACvB8C,EAASH,GAAK,EAAI5C,EAAOC,IAC3B8C,EAASH,EAAI5C,EAAOC,GAClB8C,EAAShF,EAAIiC,EAAOE,IACtB6C,EAAShF,GAAK,EAAIiC,EAAOE,GACvB6C,EAAShF,GAAK,EAAIiC,EAAOE,IAC3B6C,EAAShF,EAAIiC,EAAOE,KAxL1B,CAAAlL,IAAA,qBAAAN,MAAA,SA2LsBqO,GAClB,MAAO,CACL,EACA/D,KAAK4F,IAAI7B,EAASH,EAAI,GAAK5D,KAAKwF,IAAM,KA9L5C,CAAAxP,IAAA,mBAAAN,MAAA,SAkMoBqO,GAChB,IAAIxO,EAAIyK,KAAKS,IAAKT,KAAKS,IAAIsD,EAASH,EAAG,GAAK5D,KAAKS,IAAIsD,EAAShF,EAAG,GAAK,IAClE8G,EAAI7F,KAAK8F,MAAM/B,EAAShF,EAAGgF,EAASH,GAGpCmC,GAAM5E,EAAgB5L,GAAK,IAE3ByQ,EAAK,EAAIhG,KAAKwF,GAAK,IAEvB,MAAO,CACLO,EAAK/F,KAAKiG,IAAIJ,GAAKtQ,EAAIyK,KAAK4F,IAAIC,GAAKG,EACrCD,EAAK/F,KAAKiG,IAAIJ,GAAKtQ,EAAIyK,KAAKiG,IAAIJ,GAAKG,KA7M3C,CAAAhQ,IAAA,iBAAAN,MAAA,SAiNkBqO,GACd,IAGImC,EACA3F,EAJAqD,EAAIG,EAASH,EACb7E,EAAIgF,EAAShF,EA6BjB,OAtBI6E,GAAK,GACPrD,EAAK,EACDxB,GAAK,GACHA,GAAK,EAAI6E,GACbsC,GAAM,IAEFnH,GAAK6E,EAAI,GACbsC,EAAK,KAGP3F,GAAM,EACFxB,EAAI,GACFA,GAAK6E,EAAI,GACbsC,GAAM,IAEFnH,IAAM,EAAI6E,GACdsC,EAAK,IAMF,CAACA,EAAI3F,KAhPhB,CAAAvK,IAAA,WAAAN,MAAA,WAoPSgC,KAAKe,SACRf,KAAKyO,gBAAkB1P,OAAOmI,sBAAsBlH,KAAKiH,YArP/D,CAAA3I,IAAA,QAAAN,MAAA,WAyPQgC,KAAKyO,iBACP1P,OAAO2P,qBAAqB1O,KAAKyO,iBACnCzO,KAAKyO,qBAAkBzR,IA3P3B,CAAAsB,IAAA,kBAAAN,MAAA,WAgQIgC,KAAKe,OAASf,KAAK2O,QAAU3O,KAAKsN,aAhQtC,CAAAhP,IAAA,SAAAN,MAAA,SAmQUsO,GACN,OAAOA,EAAE,MAAO,CAAEtL,MAAO,sBApQ7B,CAAA1C,IAAA,YAAAN,MAAA,WAwQIgC,KAAK2O,QACL3O,KAAKgK,SAAS4E,UACd5O,KAAKuL,SAASqD,YA1QlB,CAAAtQ,IAAA,mBAAAV,IAAA,WA4FI,OAAO,EAAI0K,KAAKC,IAAIvI,KAAKwG,GAAIxG,KAAKyG,MA5FtC,CAAAnI,IAAA,eAAAV,IAAA,WAgGI,OAAKoC,KAAKwG,GAAKxG,KAAKyG,KAAQ,EACnB,EACFzG,KAAKwG,KAlGhB,CAAAlI,IAAA,eAAAV,IAAA,WAsGI,OAAKoC,KAAKwG,GAAKxG,KAAKyG,KAAQ,EACnB,EACFzG,KAAKyG,OAxGhBoD,EAAA,CAAoDjF,EAAA,QASlDiK,EAAA,CADCrV,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,sDAIlBD,EAAA,CADCrV,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,sDAIlBD,EAAA,CADCrV,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,SAAS,2DAiPjB+J,EAAA,CADCrV,OAAAoL,EAAA,SAAApL,CAAM,2HAGN,MAjQkBoQ,EAAsBiF,EAAA,CAD1CjK,EAAA,cACoBgF,GAAA,ICzBjBmF,EAAQC,GDyBSC,GAAA,EEzB4XC,GAAA,GDQ7YC,cAAY3V,OAAA0L,EAAA,KAAA1L,CACd0V,GACAH,EACAC,IACF,EACA,KACA,WACA,OAIAG,GAAShK,QAAAC,OAAA,6BACM,IAAAgK,GAAAD,WEVAE,sDAAA,CACbC,cAAeA,GACfC,gBAAiBA,GACjBC,cAAeA,GACfC,aAAcA,GACdC,cAAeA,GACfC,YAAaA,KAGf,SAASA,GAAYC,EAAIlC,EAASmC,GAChCD,EAAGE,cAAcF,EAAGG,SAAWF,GAC/BD,EAAGD,YAAYC,EAAGI,WAAYtC,GAGhC,SAAS+B,GAAaG,EAAI/W,GACxB,IAAIoX,EAASL,EAAGH,eAGhB,OAFAG,EAAGM,WAAWN,EAAGO,aAAcF,GAC/BL,EAAGQ,WAAWR,EAAGO,aAActX,EAAM+W,EAAGS,aACjCJ,EAGT,SAASX,GAAcM,EAAI5J,EAAQnN,EAAMoJ,EAAOC,GAC9C,IAAIwL,EAAUkC,EAAGN,gBAYjB,OAXAM,EAAGD,YAAYC,EAAGI,WAAYtC,GAC9BkC,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGW,eAAgBX,EAAGY,eACtDZ,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGa,eAAgBb,EAAGY,eACtDZ,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGc,mBAAoB1K,GACvD4J,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGe,mBAAoB3K,GACnDnN,aAAgB+X,WAChBhB,EAAGiB,WAAWjB,EAAGI,WAAY,EAAGJ,EAAGkB,KAAM7O,EAAOC,EAAQ,EAAG0N,EAAGkB,KAAMlB,EAAGmB,cAAelY,GAEtF+W,EAAGiB,WAAWjB,EAAGI,WAAY,EAAGJ,EAAGkB,KAAMlB,EAAGkB,KAAMlB,EAAGmB,cAAelY,GAExE+W,EAAGD,YAAYC,EAAGI,WAAY,MACvBtC,EAGT,SAAS6B,GAAgBK,EAAIoB,EAAatD,GACxCkC,EAAGL,gBAAgBK,EAAGqB,YAAaD,GAC/BtD,GACAkC,EAAGsB,qBAAqBtB,EAAGqB,YAAarB,EAAGuB,kBAAmBvB,EAAGI,WAAYtC,EAAS,GAI5F,SAASgC,GAAcE,EAAIK,EAAQmB,EAAWC,GAC5CzB,EAAGM,WAAWN,EAAGO,aAAcF,GAC/BL,EAAG0B,wBAAwBF,GAC3BxB,EAAG2B,oBAAoBH,EAAWC,EAAezB,EAAG4B,OAAO,EAAO,EAAG,GAGvE,SAAShC,GAAcI,EAAI6B,EAAcC,GACvC,IAAIC,EAAU/B,EAAGJ,gBAEboC,EAAeC,GAAajC,EAAIA,EAAGkC,cAAeL,GAClDM,EAAiBF,GAAajC,EAAIA,EAAGoC,gBAAiBN,GAM1D,GAJA9B,EAAGqC,aAAaN,EAASC,GACzBhC,EAAGqC,aAAaN,EAASI,GAEzBnC,EAAGsC,YAAYP,IACV/B,EAAGuC,oBAAoBR,EAAS/B,EAAGwC,aACpC,MAAM,IAAItV,MAAM8S,EAAGyC,kBAAkBV,IAGzC,IAMIxY,EANAmZ,EAAU,CACZX,QAASA,EACTY,OAAQA,GAGNC,EAAgB5C,EAAGuC,oBAAoBR,EAAS/B,EAAG6C,mBAEvD,IAAKtZ,EAAI,EAAGA,EAAIqZ,EAAerZ,IAAK,CAChC,IAAIiY,EAAYxB,EAAG8C,gBAAgBf,EAASxY,GAC5CmZ,EAAQlB,EAAU7T,MAAQqS,EAAG+C,kBAAkBhB,EAASP,EAAU7T,MAEtE,IAAIqV,EAAchD,EAAGuC,oBAAoBR,EAAS/B,EAAGiD,iBACrD,IAAK1Z,EAAI,EAAGA,EAAIyZ,EAAazZ,IAAK,CAC9B,IAAI2Z,EAAUlD,EAAGmD,iBAAiBpB,EAASxY,GAC3CmZ,EAAQQ,EAAQvV,MAAQqS,EAAGoD,mBAAmBrB,EAASmB,EAAQvV,MAGnE,OAAO+U,EAEP,SAASC,IACP3C,EAAGqD,cAActB,IAIrB,SAASE,GAAajC,EAAIlT,EAAMwW,GAC9B,IAAIC,EAASvD,EAAGiC,aAAanV,GAI7B,GAHAkT,EAAGwD,aAAaD,EAAQD,GAExBtD,EAAGyD,cAAcF,IACZvD,EAAG0D,mBAAmBH,EAAQvD,EAAG2D,gBAClC,MAAM,IAAIzW,MAAM8S,EAAG4D,iBAAiBL,IAGxC,OAAOA,sDCxGMM,GAAA,CAIbC,QAAS,EAKTC,SAAU,EAKVC,MAAO,EAKPC,OAAQ,GClBK,SAASC,GAAgBC,GACtC,iMAAA9P,OAME8P,EANF,sBCGa,SAASC,KACtB,OAAOjV,OAAOqL,WAAa,ICE7B,IAeI6J,GAfAC,GAAKC,KAAW,GAAI,CACtBC,WAAW,EAMXC,qBAAqB,IAGnBC,GAAe,GAEfC,GAAqBT,GAAe,yCAIpCU,GAAW,CACbC,SAAU,IACVC,gBAAiB,KACjBC,cAAe,IACfC,QAAS,KACTC,UAAWC,GAAWpB,SAGpBqB,GAAgB,CAClBC,UAAWhB,MAGEiB,GAAA,CACbF,iBACAG,YACAC,WACAC,YACAC,MALa,WAKH,OAAOnB,IACjBoB,YACAC,WACAC,kBAEAC,sBACAC,sBAEAC,0BACAC,0BAEAC,oBACAC,oBAEAC,cACAC,cAEAC,gBACAC,gBAEAC,oBACAC,qBAOF,SAASH,KACP,IAAIpB,EAAYX,GAAGtW,IAAI,MACvB,OAAOyY,GAAQxB,GAAaA,EAAYL,GAASK,UAGnD,SAASqB,GAAarB,GACfwB,GAAQxB,KAEbP,GAAagC,GAAKzB,GAGpB,SAASsB,KACP,IAAII,EAAgBrC,GAAGtW,IAAI,MAC3B,OAAO2Y,GAAiB,GAG1B,SAASH,GAAiBG,GAExBjC,GAAakC,GAAKD,EAGpB,SAASR,KACP,IAAInB,EAAUV,GAAGtW,IAAI,MACrB,OAAOyY,GAAQzB,GAAWA,EAAUJ,GAASI,QAG/C,SAASoB,GAAWpB,GACbyB,GAAQzB,KAEbN,GAAamC,GAAK7B,GAGpB,SAASiB,KACP,IAAIlB,EAAgBT,GAAGtW,IAAI,MAC3B,OAAOyY,GAAQ1B,GAAiBA,EAAgBH,GAASG,cAG3D,SAASmB,GAAiBnB,GACnB0B,GAAQ1B,KAEbL,GAAaoC,GAAK/B,GAGpB,SAASgB,KACP,IAAIlB,EAAWP,GAAGtW,IAAI,MACtB,OAAOyY,GAAQ5B,GAAYA,EAAWD,GAASC,SAGjD,SAASmB,GAAuBe,GACzBN,GAAQM,KAEbrC,GAAaqC,GAAKA,GAGpB,SAASlB,KACP,IAAIf,EAAkBR,GAAGtW,IAAI,MAC7B,OAAOyY,GAAQ3B,GAAmBA,EAAkBF,GAASE,gBAG/D,SAASgB,GAAmBhB,GACrB2B,GAAQ3B,IACbkC,GAAMlC,EAAiB,EAAG,GAI5B,SAASS,KACP,IAAI0B,EAAK3C,GAAGtW,IAAI,MACZkZ,EAAK5C,GAAGtW,IAAI,MACZmZ,EAAI7C,GAAGtW,IAAI,KACX0O,EAAI4H,GAAGtW,IAAI,KACf,OAAOwX,GAASyB,EAAIC,EAAIC,EAAGzK,GAG7B,SAAS8I,GAASyB,EAAIC,EAAIC,EAAGzK,GAC3B,IAAI0K,EAAcX,GAAQQ,IAAOR,GAAQS,IAAOT,GAAQU,IAAMV,GAAQ/J,GACtE,GAAK0K,EAAL,CAEA,IAAIC,EAAKF,EAAE,EACPG,EAAK5K,EAAE,EACPzR,EAAI,IACR,MAAO,CACLsc,KAAM7O,KAAK8O,MAAMvc,GAAKgc,EAAKI,IAAKpc,EAChCwc,KAAM/O,KAAK8O,MAAMvc,GAAKgc,EAAKI,IAAKpc,EAChCyc,KAAMhP,KAAK8O,MAAMvc,GAAKic,EAAKI,IAAKrc,EAChC0c,KAAMjP,KAAK8O,MAAMvc,GAAKic,EAAKI,IAAKrc,IAIpC,SAASqa,GAASsC,GAAyBxU,UAAA3J,OAAA,QAAA2D,IAAAgG,UAAA,IAAAA,UAAA,GACzCwU,EAAO,CACLX,GAA8B,IAAzBW,EAAKL,KAAOK,EAAKH,MACtBP,GAA8B,IAAzBU,EAAKF,KAAOE,EAAKD,MACtBR,EAAIS,EAAKH,KAAOG,EAAKL,KACrB7K,EAAIkL,EAAKH,KAAOG,EAAKL,MAGnBK,EAAKT,GAAK,GAAKS,EAAKlL,GAAK,IAE7BgI,GAAauC,GAAKW,EAAKX,GACvBvC,GAAawC,GAAKU,EAAKV,GACvBxC,GAAayC,EAAIS,EAAKT,EACtBzC,GAAahI,EAAIkL,EAAKlL,EAEnB2H,IACD1X,aAAa0X,IACbA,GAAc,GAKdA,GAAchX,WAAW,WACvBgX,GAAc,GAEb,MAIP,SAASsB,KACP,IAAIkC,EAASvD,GAAGtW,IAAI,MACpB,GAAI6Z,EAAQ,OAAOA,EAKnB,IAAIC,EAAUxD,GAAGtW,IAAI,QACrB,OAAI8Z,GACFD,EAAS3D,GAAgB4D,UAElBpD,GAAaqD,KAEbF,GAGFlD,GAGT,SAASiB,KACP,OAAOjB,GAGT,SAASe,GAASqC,GAIhBrD,GAAaqD,KAAOA,EAGtB,SAAStB,GAAQuB,GACf,OAAOC,OAAOC,SAASF,GAGzB,SAAShB,GAAM1K,EAAG6L,EAAKxP,GACrB,OAAO2D,EAAI6L,EAAMA,EACV7L,EAAI3D,EAAOA,EAAM2D,EA7J1BgI,GAAG8D,SAAS,WACVC,KAAIC,KAAK,cAAenZ,OAAO+K,SChEjC,IAAMqO,GAAe,CAAC3J,GAAI,EAAG3F,GAAI,EAAGuP,MAAO,GAE5B,SAASC,GAAkBC,GAAK,IAGzCC,EAAeC,EAFd5I,EAAkB0I,EAAlB1I,GAAI6I,EAAcH,EAAdG,WAGLC,EAA2B,CAAClK,GAAI,EAAG3F,GAAI,EAAGuP,MAAO,GACjDO,EAA0B,KAE9BC,IACA,IAAIC,EAAgBC,GAAQtJ,cAAcI,EAAImJ,KAAyBC,MAEnEC,EAAM,CACRC,mBACAC,sBACAP,uBAEAQ,oBAAoB,GAGtB,OAAOH,EAEP,SAASC,IAEPJ,GAAQvJ,gBAAgBK,EAAI0I,EAAItH,YAAauH,GAC7C3I,EAAGyJ,SAAS,EAAG,EAAGZ,EAAWxW,MAAOwW,EAAWvW,QAE3C+W,EAAIG,oBAAsBT,GAI5BD,EAAyBlK,KAAO8J,EAAId,KAAKL,KAAOwB,EAAwBxB,OAAOmB,EAAId,KAAKH,KAAOiB,EAAId,KAAKL,MACxGuB,EAAyB7P,KAAOyP,EAAId,KAAKF,KAAOqB,EAAwBrB,OAAOgB,EAAId,KAAKD,KAAOe,EAAId,KAAKF,MACxGoB,EAAyBN,OAASE,EAAId,KAAKH,KAAOiB,EAAId,KAAKL,OAASwB,EAAwBtB,KAAOsB,EAAwBxB,MAC3HmC,EAAYd,EAAmBF,EAAIiB,YAAab,IAEhDY,EAAYd,EAAmBF,EAAIiB,YAAapB,IAIpD,SAASgB,IACPL,GAAQvJ,gBAAgBK,EAAI,MAE5B4J,IAEA5J,EAAG6J,OAAO7J,EAAG8J,OACb9J,EAAG+J,UAAU/J,EAAGgK,UAAWhK,EAAGiK,WAC9BjK,EAAGkK,WAAWxB,EAAIyB,gBAAgBlc,EAAGya,EAAIyB,gBAAgBC,EAAG1B,EAAIyB,gBAAgBE,EAAG3B,EAAIyB,gBAAgBrV,GACvGkL,EAAGsK,MAAMtK,EAAGuK,kBACZb,EAAYf,EAAe,EAAKJ,IAChCvI,EAAGwK,QAAQxK,EAAG8J,OAEd,IAAIW,EAAO7B,EACXA,EAAoBD,EACpBA,EAAgB8B,EAEhBpB,EAAIG,oBAAqB,EACrBra,OAAOub,cACThB,EAAYva,OAAOub,aAAc,EAAKnC,IAI1C,SAASS,IAAuB,IACzB3W,EAAiBwW,EAAjBxW,MAAOC,EAAUuW,EAAVvW,OACRqY,EAAc,IAAI3J,WAAW3O,EAAQC,EAAS,GAC9CqW,GACF3I,EAAG4K,cAAcjC,GAEfC,GACF5I,EAAG4K,cAAchC,GAGnBD,EAAgBO,GAAQxJ,cAAcM,EAAIA,EAAG6K,QAASF,EAAatY,EAAOC,GAC1EsW,EAAoBM,GAAQxJ,cAAcM,EAAIA,EAAG6K,QAASF,EAAatY,EAAOC,GAGhF,SAASsX,IACFb,GAWLA,EAAwBxB,KAAOmB,EAAId,KAAKL,KACxCwB,EAAwBrB,KAAOgB,EAAId,KAAKF,KACxCqB,EAAwBtB,KAAOiB,EAAId,KAAKH,KACxCsB,EAAwBpB,KAAOe,EAAId,KAAKD,MAbtCoB,EAA0B,CACxBxB,KAAMmB,EAAId,KAAKL,KACfG,KAAMgB,EAAId,KAAKF,KACfD,KAAMiB,EAAId,KAAKH,KACfE,KAAMe,EAAId,KAAKD,MAYrB,SAAS+B,EAAY5L,EAASjD,EAASiQ,GACrC,IAAI/I,EAAUkH,EACdjJ,EAAG+K,WAAWhJ,EAAQA,SACtBmH,GAAQpJ,cAAcE,EAAI0I,EAAIsC,WAAYjJ,EAAQkJ,MAAO,GAGzD/B,GAAQnJ,YAAYC,EAAIlC,EAAS4K,EAAIwC,mBACrClL,EAAGmL,UAAUpJ,EAAQqJ,SAAU1C,EAAIwC,mBAEnClL,EAAGqL,UAAUtJ,EAAQuJ,iBAAkB,KACvCtL,EAAGqL,UAAUtJ,EAAQwJ,UAAW1Q,GAChCmF,EAAGwL,UAAUzJ,EAAQ0J,YAAaX,EAAiBlM,GAAIkM,EAAiB7R,GAAI6R,EAAiBtC,OAE7FxI,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,IAInC,SAASxC,KACP,44BA0BF,SAASC,KACP,+SC7IF,IAAMrB,GAAI,qdAiBKA,MCpBM6D,cACnB,SAAAA,IAAchiB,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAwb,+DACC,MAAO,0CACL,MAAO,yCACR,MAAO,YCOrB7D,GAAI,2wDA+DOA,MC1ER,SAAS8D,KACd,iECGmBC,eACnB,SAAAA,EAAYC,GAAY,IAAAxY,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAA0b,GACtBvY,EAAA3J,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAAkiB,GAAA/hB,KAAAqG,OACAmD,EAAKwY,WAAaA,GAAc,GAFVxY,sFAKPyY,GACf5b,KAAK2b,WAAaC,uCAIlB,8QAAA3X,OAcFwX,KAdE,6CAqBA,4OAAAxX,OAQF4X,GARE,mdAAA5X,OA2BFjE,KAAK2b,WAAa3b,KAAK2b,WAAa,iDA3BlC,eAhCqDH,ICFpCM,eACnB,SAAAA,IAAe,OAAAtiB,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAA8b,GAAAtiB,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAAsiB,GAAAniB,KAAAqG,uFAKb,sEAMA,+UAYA,+CAxB8Cwb,ICEnC,SAASO,GAAiBlH,EAAW4C,EAAQuE,GAC1D,IAAIC,EAAM,IAAIP,GAA4BjE,GACtCyE,EAAY,IAAIJ,GAEpB,MAAO,CACLK,eACAC,UACAC,cAGF,SAASF,IACP,iGAAAlY,OAKFgY,EAAIK,aALF,MAAArY,OAMFiY,EAAUI,aANR,MAUF,SAASD,IACP,uPAAApY,OAQFgY,EAAIM,eARF,MAAAtY,OASFiY,EAAUK,eATR,MAAAtY,OAUFuY,IAVE,MAcF,SAASA,IACP,GAAI3H,IAAcC,GAAWpB,QAC3B,iFAMF,GAAImB,IAAcC,GAAWnB,SAC3B,OAAOqI,GAAS,+TAUlB,GAAInH,IAAcC,GAAWjB,OAAQ,CACnC,IAAKmI,EAAW,MAAM,IAAIlf,MAAM,mEAChC,OAAOkf,EAGT,kMASF,SAASI,IACP,6DCtEiBK,cACnB,SAAAA,EAAYnE,GAAK9e,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAyc,GACfzc,KAAK6U,UAAYyD,EAAIzD,UACrB7U,KAAKuW,cAAgB+B,EAAI/B,eAAiB,sEAI1C,6JAOckB,GACd,IAAIiF,EAAkBC,KAClBC,EAAab,GAAiB/b,KAAK6U,UAAW4C,EAAQzX,KAAKuW,eAC3DsG,EAAU,GACdC,GAAWJ,EAAiBG,GAC5BC,GAAWF,EAAYC,GACvB,IAAIE,EAAO,GAIX,OAHAC,GAAQN,EAAiBK,GACzBC,GAAQJ,EAAYG,GAEpB,iIAAA9Y,OAMFyY,EAAgBP,gBAAkB,GANhC,MAAAlY,OAOF2Y,EAAWT,eAPT,QAAAlY,OASFgZ,GATE,QAAAhZ,OAWF4Y,EAAQK,KAAK,MAXX,+KAAAjZ,OAmBF8Y,EAAKG,KAAK,MAnBR,+LA4BJ,SAASJ,GAAWK,EAAUC,GACxBD,EAASd,YACXe,EAAM7jB,KAAK4jB,EAASd,cAIxB,SAASW,GAAQG,EAAUC,GACrBD,EAASf,SACXgB,EAAM7jB,KAAK4jB,EAASf,WAIxB,SAASO,KACP,MAAO,CACLR,eACAC,WAGF,SAASD,IACP,mFAMF,SAASC,IACP,8JClFJ,IAAMzE,GAAI,kiCAmCKA,MC5BM0F,eACnB,SAAAA,EAAYC,GAAU,IAAAna,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAqd,GACpBla,EAAA3J,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAA6jB,GAAA1jB,KAAAqG,OAIAmD,EAAKma,SAAWA,EALIna,oFASpB,GAAInD,KAAKsd,SACP,eAAArZ,OACAsZ,GADA,UAAAtZ,OAEAgZ,GAFA,2CAQF,GAAIjd,KAAKsd,SAET,qQAeF,OAAItd,KAAKsd,SACP,wJAOA,yVA5CyC9B,ICN9B,SAASgC,GAAYC,GAClC,IAAI9F,EAAO,GAQX,OANA8F,EAAMC,QAAQ,SAAAC,GAAcA,EAAKrB,YAAYsB,EAAUD,EAAKrB,gBAC5DmB,EAAMC,QAAQ,SAAAC,GAAcA,EAAKpB,cAAcqB,EAAUD,EAAKpB,kBAE9DqB,EAAU,iBACRH,EAAMC,QAAQ,SAAAC,GAAcA,EAAKE,aAAaD,EAAUD,EAAKE,iBAC/DD,EAAU,KACHjG,EAAKuF,KAAK,MAEjB,SAASU,EAAUE,GACbA,GAAMnG,EAAKpe,KAAKukB,QCXHC,eACnB,SAAAA,EAAYC,GAAQ,IAAA7a,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAA+d,GAClB5a,EAAA3J,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAAukB,GAAApkB,KAAAqG,OAGAmD,EAAK8a,OAASD,GAAUA,EAAOC,OAC/B9a,EAAK+a,WAAcF,GAAUA,EAAOG,SAAY,MAL9Bhb,kFASlB,GAAInD,KAAKie,OAET,+FAQA,OAAIje,KAAKie,OACP,yGAAAha,OAGMjE,KAAKke,WAHX,oCAAAja,OAIMjE,KAAKke,WAJX,0BAOF,gBAAAja,OACSjE,KAAKke,WADd,oCAAAja,OAESjE,KAAKke,WAFd,gCA5B0C1C,ICKzB4C,cACnB,SAAAA,EAAYjZ,GAAS3L,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAoe,GACnBpe,KAAKqe,mBAAqB,IAAIC,IAAqC,GACnEte,KAAKue,YAAc,IAAI7C,GACvB1b,KAAKwe,mBAAqB,IAAI1C,GAC9B9b,KAAKye,cAAgB,IAAIC,GACzB1e,KAAK2e,sBAAwB,IAAIL,IAAqC,GACtEte,KAAK4e,cAAgB,IAAIb,GAAiB,CAACE,QAAQ,IACnDje,KAAK6e,cAAgB,IAAId,GAAiB,CAACE,QAAQ,IAEnDje,KAAK6U,UAAY1P,GAAWA,EAAQ0P,8EAGjBiK,GACnB9e,KAAKue,YAAYQ,iBAAiBD,6CAIlC,qQAcA,IAAIrB,EAAQ,CACVzd,KAAKqe,mBACLre,KAAKye,cACLze,KAAKue,YACLve,KAAKwe,mBAAoB,CACvBX,YADuB,WAErB,gDAKJ7d,KAAK2e,uBAEP,OAAOnB,GAAYC,YAIjBiB,uMAEF,oJAWA,iDAKA,6gBAlBgClD,cC3C7B,SAAS+B,GAAgByB,EAAKC,EAAKC,GACxC,GAAW,GAAPF,EAEF,OADAC,EAAIC,EAAc,GAAK,EAAGD,EAAIC,EAAc,GAAK,EAAGD,EAAIC,EAAc,GAAK,OAAGD,EAAIC,EAAc,GAAK,GAIvG,IAMIC,EANAC,EAAM9W,KAAK+W,IAAIL,GACfM,EAAWhX,KAAKiX,MAAMjX,KAAKkX,KAAKJ,IAEpCE,GAAaG,GAAKH,IAAaF,EAAM,EAAO,EAAI,EAChDE,GAAaG,GAAKH,GAAYF,EAAO,EAAI,EAIrCD,EADAG,EAAW,IACAF,EAAM,KAASK,GAAKH,EAAW,IAAQ,EAEvCF,EAAOK,GAAKH,GAAa,EAGxC,IAAI5a,EAAI4a,EAAW,IACnBH,GAAY,IACZ,IAAIlF,EAAI3R,KAAKiX,MAAMJ,GACnBA,GAAYlF,EACZkF,GAAY,IACZ,IAAI9hB,EAAIiL,KAAKiX,MAAMJ,GACnBA,GAAY9hB,EACZ8hB,GAAY,IACZ,IAAI7hB,EAA2B,EAAvBgL,KAAKiX,MAAMJ,IAAoBH,EAAM,EAAO,EAAG,GAEvDC,EAAIC,EAAc,GAAKxa,EAAGua,EAAIC,EAAc,GAAKjF,EAAGgF,EAAIC,EAAc,GAAK7hB,EAAG4hB,EAAIC,EAAc,GAAK5hB,EAWhG,SAAS2f,GAAgBpf,EAAGmc,EAAGC,EAAGvV,GACvC,IAAIgb,EAAIpX,KAAKiX,MAAM1hB,EAAI,IACnB8hB,EAAIrX,KAAKiX,MAAMvF,EAAI,IACnB4F,EAAItX,KAAKiX,MAAMtF,EAAI,IACnB4F,EAAIvX,KAAKiX,MAAM7a,EAAI,IAEnB4a,EAAWI,EAAI,IACfI,EAAO,EAAOD,EAAI,EAAO,EACzBV,GAAaO,EAAI,EAAO,EAAI,GACdC,EAAI,IACJC,EAAI,MACJtX,KAAKiX,MAAMM,EAAI,GAAO,QACxC,OAAOC,EAAOX,EAAWM,GAAKH,GAGhC,SAASG,GAAKH,GAAY,OAAOhX,KAAKyX,IAAIT,EAAWhX,KAAK0X,KCjE3C,SAASC,KACtB,IAAIlI,EAAKxP,EAEL0Q,EAAM,CACRiH,OADQ,WACG,OAAOnI,GAClBoI,OAFQ,WAEG,OAAO5X,GAClBuC,IAHQ,SAGJoB,GACEA,EAAI6L,IAAKA,EAAM7L,GACfA,EAAI3D,IAAKA,EAAM2D,IAErBkU,MAAOA,GAGT,OAAOnH,EAEP,SAASmH,IACPrI,EAAMF,OAAOwI,kBACb9X,EAAMsP,OAAOyI,mBCfjB,IAAMC,GAAU,EACVC,GAAU,EAMD,SAASC,GAAanI,GACnC,IAEIoI,EAAoBC,EACpBC,EACAC,EACAC,EAEAC,EACAC,EARAC,GAAmB,EAClBrR,EAAM0I,EAAN1I,GAKDsR,EAAkBjB,KAMtB,OAFAkB,IAEO,CACLxF,aACAyF,2BACAC,uBACAC,iBACAC,qBACA3S,WAGF,SAASuS,IACPlJ,KAAI5W,GAAG,+BAAgCkgB,GACvCtJ,KAAI5W,GAAG,cAAekgB,GACtBtJ,KAAI5W,GAAG,gBAAiBkgB,GAG1B,SAAS3S,IACPqJ,KAAIuJ,IAAI,+BAAgCD,GACxCtJ,KAAIuJ,IAAI,cAAeD,GACvBtJ,KAAIuJ,IAAI,gBAAiBD,GACzBE,IAGF,SAASA,IACHd,GAAoB/Q,EAAG4K,cAAcmG,GACrCD,GAAoB9Q,EAAG4K,cAAckG,GAG3C,SAASa,IACHV,GAAoBtkB,aAAaskB,GACrCA,EAAqB5jB,WAAW,WAC9BgkB,GAAmB,EACnBJ,EAAqB,GACpB,IAGL,SAASS,EAAe3P,GACtB/B,EAAG8R,UAAU/P,EAAQgQ,iBAAkBT,EAAgBhB,SAAUgB,EAAgBf,UAGnF,SAASkB,IACPI,IAEAb,EAA0BtI,EAAIsI,wBAC9BE,EAAeF,EAA0BA,EAEzCG,EAAa,IAAInQ,WAA0B,EAAfkQ,GAC5BE,EAAa,IAAIpQ,WAA0B,EAAfkQ,GAC5BH,EAAqBiB,GAAKtS,cAAcM,EAAIA,EAAG6K,QAASsG,EAAYH,EAAyBA,GAC7FF,EAAqBkB,GAAKtS,cAAcM,EAAIA,EAAG6K,QAASuG,EAAYJ,EAAyBA,GAE7FW,IAGF,SAAS5F,IACP4F,IAGF,SAASH,EAAyBzP,GAC3BsP,GAAqBF,GAAeC,IACzCC,GAAmB,EAGnBW,GAAKrS,gBAAgBK,EAAI0I,EAAItH,YAAa2P,GAC1C/Q,EAAGmL,UAAUpJ,EAAQkQ,iBAAkBtB,IACvC3Q,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,GAC/B3L,EAAGkS,WAAW,EAAG,EAAGlB,EAAyBA,EAAyBhR,EAAGkB,KAAMlB,EAAGmB,cAAegQ,GAEjGa,GAAKrS,gBAAgBK,EAAI0I,EAAItH,YAAa0P,GAC1C9Q,EAAGmL,UAAUpJ,EAAQkQ,iBAAkBrB,IACvC5Q,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,GAC/B3L,EAAGkS,WAAW,EAAG,EAAGlB,EAAyBA,EAAyBhR,EAAGkB,KAAMlB,EAAGmB,cAAeiQ,GAEjGe,KAGF,SAASA,IACPb,EAAgBd,QAEhB,IAAI,IAAIjnB,EAAI,EAAGA,EAAI6nB,EAAW3nB,OAAQF,GAAG,EAAG,CAC1C,IAAI6oB,EAAKC,GAAUlB,EAAY5nB,GAC3B+oB,EAAKD,GAAUjB,EAAY7nB,GAC3BoK,EAAI+E,KAAKQ,KAAKkZ,EAAKA,EAAKE,EAAKA,GACjChB,EAAgBpW,IAAIvH,KAK1B,SAAS0e,GAAUhS,EAAQkS,GACvB,OAAOlF,GACLhN,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,IC/GP,SAASC,GAAkBxS,EAAIyS,EAAYzB,GACxD,IAAI0B,EAAWD,EAAW/e,IAAI,SAAChG,EAAG3C,GAChC,IAAI4nB,EAAc,CAChB7U,QAAS8U,GAAOlT,cAAcM,EAAIA,EAAG6K,QAASnd,EAAEmlB,cAAe7B,EAAyBA,GACxFjmB,MAAOA,EACP4C,KAAMD,EAAEC,MAGV,OAAOglB,IAGT,MAAO,CACL3T,UACA8T,eACAC,wBACAtpB,OAAQgpB,EAAWhpB,OACnBipB,WACA1kB,IANK,SAMDzE,GAAK,OAAOmpB,EAASnpB,KAG3B,SAASwpB,EAAsBhR,GAC7B2Q,EAAS5E,QAAQ,SAAAkF,GACfhT,EAAGmL,UAAUpJ,EAAQ,eAAiBiR,EAAMrlB,MAAOqlB,EAAMjoB,SAI7D,SAASiU,IACP0T,EAAS5E,QAAQ,SAAAkF,GAAK,OAAIhT,EAAG4K,cAAcoI,EAAMlV,WAGnD,SAASgV,EAAa9S,EAAI+B,GACxB2Q,EAAS5E,QAAQ,SAACkF,GAChBJ,GAAO7S,YAAYC,EAAIgT,EAAMlV,QAASkV,EAAMjoB,OAC5CiV,EAAGmL,UAAUpJ,EAAQ,eAAiBiR,EAAMrlB,MAAOqlB,EAAMjoB,UC9B/D,IAAMkoB,GAAoC,IAAIzE,GAE/B,SAAS0E,GAAsBxK,GAC5C,IACIyK,EAAcC,EACdpC,EACAqC,EAMAC,EATAtT,EAAK0I,EAAI1I,GAITuT,EAAeC,GAAgB9K,GAUnC,OAFAL,KAAI5W,GAAG,uBAAwBgiB,GAExB,CACL1H,aACAyF,2BACAC,uBACAiC,gBACAC,kBAGF,SAAS5H,EAAW6H,GAClBX,GAAkCY,qBAAqBD,GACvD,IAAIE,EAAWb,GAAkCc,oBAC7CC,EAASf,GAAkCgB,kBAE3CC,EAAalC,GAAKpS,cAAcI,EAAIgU,EAAQF,GAE5CT,GAAeA,EAAc1Q,SACjC0Q,EAAgBa,EAEZxL,EAAIzD,YAAckP,GAAUpQ,UAAUwP,EAAa5B,qBAGzD,SAASgC,EAAeS,EAAShmB,GAC/B,IAAIimB,EAAkBrU,EAAGoD,mBAAmBiQ,EAActR,QAApC,KAAA1N,OAAkD+f,IACxEpU,EAAG+K,WAAWsI,EAActR,SAC5B/B,EAAGqL,UAAUgJ,EAAiBjmB,GAGhC,SAASqjB,EAAqBnV,EAAG7E,GAC/BuZ,EAA0BtI,EAAIsI,wBAE9B,IAAIyB,EAAa,CAAC,CAChB9kB,KAAM,IACNklB,cAAevW,GACd,CACD3O,KAAM,IACNklB,cAAepb,IAGb0b,GAAcA,EAAanU,UAC/BmU,EAAeX,GAAkBxS,EAAIyS,EAAYzB,GAE7CoC,GAAeA,EAAcpU,UACjCoU,EAAgBZ,GAAkBxS,EAAIyS,EAAYzB,GAElDuC,EAAa9B,uBAGf,SAASiC,EAAc3R,GACrB,IAAIkD,EAAYyD,EAAIzD,UAChBA,IAAckP,GAAUpQ,UAAUwP,EAAa7B,eAAe3P,GAElEoR,EAAaL,aAAa9S,EAAI+B,GAGhC,SAASyP,IACP,IAAIzP,EAAUsR,EACdrT,EAAG+K,WAAWhJ,EAAQA,SAEtBiQ,GAAKlS,cAAcE,EAAI0I,EAAIsC,WAAYjJ,EAAQkJ,MAAO,GAEtDvC,EAAI4L,OAAOC,eAAexS,GAGtB2G,EAAIgC,eACNsH,GAAKjS,YAAYC,EAAI0I,EAAIgC,aAAc,GACvC1K,EAAGmL,UAAUpJ,EAAQ,WAAY,IAGnCoR,EAAaL,aAAa9S,EAAI+B,GAE9B/B,EAAGqL,UAAUtJ,EAAQyS,YAAa9L,EAAI+L,WACtCzU,EAAGqL,UAAUtJ,EAAQ2S,IAAKhM,EAAIiM,qBAC9B3U,EAAGqL,UAAUtJ,EAAQ6S,MAAOlM,EAAIkM,OAChC,IAAIC,EAASnM,EAAImM,OACjB7U,EAAG8U,UAAU/S,EAAQ8S,OAAQA,EAAOE,OAAQF,EAAOG,OAAQH,EAAOI,OAAQJ,EAAOK,QAEjF,IAAItN,EAAOc,EAAId,KACf5H,EAAG8R,UAAU/P,EAAQoT,MAAOvN,EAAKL,KAAMK,EAAKF,MAC5C1H,EAAG8R,UAAU/P,EAAQqT,MAAOxN,EAAKH,KAAMG,EAAKD,MAE5C3H,EAAGqL,UAAUtJ,EAAQsT,YAAa3M,EAAI5D,iBAGtC,IAAI,IAAIvb,EAAI,EAAGA,EAAI6pB,EAAc3pB,SAAUF,EAAG,CAC5C,IAAI+rB,EAAYlC,EAAcplB,IAAIzE,GAClCyW,EAAGmL,UAAUpJ,EAAQkQ,iBAAkB1oB,GACvCyoB,GAAKrS,gBAAgBK,EAAI0I,EAAItH,YAAakU,EAAUxX,SACpDkC,EAAGyJ,SAAS,EAAG,EAAGuH,EAAyBA,GAC3ChR,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,GAK7BjD,EAAIzD,YAAckP,GAAUpQ,UAC9BwP,EAAa/B,yBAAyBzP,GAGpCuR,IACFiC,EAA0BxT,GAC1BuR,EAAqB,MAIvB,IAAI7I,EAAO0I,EACXA,EAAeC,EACfA,EAAgB3I,EAGlB,SAASgJ,EAA+BtmB,GACtCmmB,EAAqBnmB,EAGvB,SAASooB,EAA0BxT,GAEjC,IAAI0Q,EAAa,CAAC,CAChB9kB,KAAM,IACNklB,cAAeS,EAAmBhX,GACjC,CACD3O,KAAM,IACNklB,cAAeS,EAAmB7b,IAIhC+d,EAAiClC,EAAmBmC,WACpDvE,EAAesE,EAAiCA,EAEhDE,EAAkBlD,GAAkBxS,EAAIyS,EAAY+C,GACpDG,EAAmBnD,GAAkBxS,EAAIyS,EAAY+C,GAEzDE,EAAgB5C,aAAa9S,EAAI+B,GAGjC,IAAIuT,EAAYK,EAAiB3nB,IAAI,GACrCgS,EAAGmL,UAAUpJ,EAAQkQ,iBAAkB,GAEvCD,GAAKrS,gBAAgBK,EAAI0I,EAAItH,YAAakU,EAAUxX,SACpDkC,EAAGyJ,SAAS,EAAG,EAAG+L,EAAgCA,GAClDxV,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,GAE/B,IAAIwF,EAAa,IAAInQ,WAA0B,EAAfkQ,GAChClR,EAAGkS,WAAW,EAAG,EAAGsD,EAAgCA,EAAgCxV,EAAGkB,KAAMlB,EAAGmB,cAAegQ,GAE/GnR,EAAGmL,UAAUpJ,EAAQkQ,iBAAkB,GACvCqD,EAAYK,EAAiB3nB,IAAI,GACjCgkB,GAAKrS,gBAAgBK,EAAI0I,EAAItH,YAAakU,EAAUxX,SACpDkC,EAAGyJ,SAAS,EAAG,EAAG+L,EAAgCA,GAClDxV,EAAG0L,WAAW1L,EAAG2L,UAAW,EAAG,GAE/B,IAAIyF,EAAa,IAAIpQ,WAA0B,EAAfkQ,GAChClR,EAAGkS,WAAW,EAAG,EAAGsD,EAAgCA,EAAgCxV,EAAGkB,KAAMlB,EAAGmB,cAAeiQ,GAE/GuE,EAAiB3W,UACjB0W,EAAgB1W,UAOhB,IALA,IAAI4W,EAASvF,KACTwF,EAASxF,KAETyF,EAAqB,IAAIC,aAAa7E,GACtC8E,EAAqB,IAAID,aAAa7E,GAClC3nB,EAAI,EAAGA,EAAI6nB,EAAW3nB,OAAQF,GAAG,EAAG,CAC1C,IAAI0sB,EAAM1sB,EAAE,EACR6oB,EAAKC,GAAUlB,EAAY5nB,GAC3B+oB,EAAKD,GAAUjB,EAAY7nB,GAC/BusB,EAAmBG,GAAO7D,EAC1B4D,EAAmBC,GAAO3D,EAC1BsD,EAAO1a,IAAIkX,GACXyD,EAAO3a,IAAIoX,GAGb,IAAI4D,EAAiB,CACnBN,SACAC,SACAC,qBACAE,qBACAP,WAAYD,GAGdnN,KAAIC,KAAK,oBAAqB4N,IAIlC,SAAS7D,GAAUhS,EAAQkS,GACvB,OAAOlF,GACLhN,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,GAChBlS,EAAOkS,EAAS,IClNtB,IAAM4D,GAAgB,CAEpBC,gBAAgB,EAGhBC,oBAAoB,EAGpBC,kBAAmB,EAGnBC,aAAclR,GAASI,QAAQzX,IAAI,kBAAmB,GAGzCmoB,MCbAK,MAEf,SAASA,GAAa9N,GACpB,IAAI1I,EAAK0I,EAAI1I,GAETyW,EAAa,EAAGC,EAAc,EAC9BC,EAAc,IAAI3V,WAAWyV,EAAaC,EAAc,GACxDhM,EAAekI,GAAOlT,cAAcM,EAAIA,EAAG6K,QAAS8L,EAAaF,EAAYC,GAC7EE,GAAa,EAKjB,OAJAlO,EAAIgC,aAAeA,EAEnBrC,KAAI5W,GAAG,QAASolB,GAET,CACLC,iBACA9X,WAGF,SAASA,IACPqJ,KAAIuJ,IAAI,QAASiF,GACjB7W,EAAG4K,cAAcF,GAGnB,SAASoM,IACP,GAAKF,EAAL,CACAA,GAAa,EAGb,IAAIvkB,EAAQ,EAAGC,EAAS,EACxB0N,EAAGD,YAAYC,EAAGI,WAAYsK,GAC9B1K,EAAGiB,WAAWjB,EAAGI,WAAY,EAAGJ,EAAGkB,KAAM7O,EAAOC,EAAQ,EAAG0N,EAAGkB,KAAMlB,EAAGmB,cAAewV,GACtF3W,EAAGD,YAAYC,EAAGI,WAAY,OAGhC,SAASyW,EAAkBE,GACzBJ,EAAcI,EACdH,GAAa,GC1BF,SAASI,GAAqBtO,GAC3C,IAEIsI,EAAyBiG,EACzB/F,EAIAsF,EAEAU,EATAlX,EAAK0I,EAAI1I,GAKTmX,EAAqB,GACrBjE,EAAwBkE,GAA0B1O,GAMtD,OAFA2O,IAEO,CACL5F,uBACAD,2BACA8F,gBACAvL,aACAwL,kBACA5D,iBACA6D,uBAGF,SAASH,IAEPI,IAEIrJ,GAAOgI,iBACLI,GAAcA,EAAaxX,UAC/BwX,EAAekB,GAAmBhP,IAItC,SAAS+O,IACHP,GAAaA,EAAYvU,SAE7B,IAAMgV,EAAY,IAAI9K,GAAkBnE,GAClCkP,EAAmBD,EAAU1D,gBAAgBkD,GACnDD,EAAclF,GAAKpS,cAAcI,EAAI4X,EAAkBD,EAAU5D,qBAGnE,SAASvC,IACF2F,IAELzO,EAAIkM,OAAS,EACblM,EAAI+L,UAAY/b,KAAKoD,SAGjB0a,GAAcA,EAAaM,iBAE/B5D,EAAsB1B,4BAGxB,SAAS+F,IACPE,IAGF,SAAS1L,EAAWlE,GAClBa,EAAIkM,MAAQ,EACZuC,EAAqBtP,EACrBqL,EAAsBnH,WAAWlE,GAEjC4P,IAGF,SAASI,EAA6BzD,EAAShmB,GAC7C,IAAIimB,EAAkBrU,EAAGoD,mBAAmB8T,EAAYnV,QAAlC,KAAA1N,OAAgD+f,IACtEpU,EAAG+K,WAAWmM,EAAYnV,SAC1B/B,EAAGqL,UAAUgJ,EAAiBjmB,GAGhC,SAASulB,EAAeS,EAAShmB,GAC/B8kB,EAAsBS,eAAeS,EAAShmB,GAC9CypB,EAA6BzD,EAAShmB,GAGxC,SAASopB,EAAoBppB,GAC3BypB,EAA6B,IAAKzpB,GAGpC,SAASqjB,IACPT,EAA0BtI,EAAIsI,wBAC9BE,EAAeF,EAA0BA,EAQzC,IAPA,IAAI8G,EAAkB,IAAI/B,aAAa7E,GACnC6G,EAAiB,IAAI/W,WAA0B,EAAfkQ,GAChC8G,EAAiB,IAAIhX,WAA0B,EAAfkQ,GAEhC3J,EAAOmB,EAAId,KAAKL,KAAUG,EAAOgB,EAAId,KAAKF,KAC1CrV,EAAQqW,EAAId,KAAKH,KAAOF,EACxBjV,EAASoW,EAAId,KAAKD,KAAOD,EACpBne,EAAI,EAAGA,EAAI2nB,EAAc3nB,IAChCokB,GAAiBjV,KAAKoD,SAAYzJ,EAAQkV,EAAMwQ,EAAoB,EAAJxuB,GAChEokB,GAAiBjV,KAAKoD,SAAYxJ,EAASoV,EAAMsQ,EAAoB,EAAJzuB,GAEjEuuB,EAAgBvuB,GAAKA,EAGnB0tB,GAAqBjX,EAAGiY,aAAahB,GACzCA,EAAsBjF,GAAKnS,aAAaG,EAAI8X,GAE5C5E,EAAsBzB,qBAAqBsG,EAAgBC,GAG7D,SAASV,IACP,GAAKH,EAAL,CAEA,IAAIpV,EAAUmV,EACdlX,EAAG+K,WAAWhJ,EAAQA,SAEtBiQ,GAAKlS,cAAcE,EAAIiX,EAAqBlV,EAAQmW,QAAS,GAE7DhF,EAAsBQ,cAAc3R,GACpC2G,EAAI4L,OAAOC,eAAexS,GAE1B/B,EAAGqL,UAAUtJ,EAAQ2S,IAAKhM,EAAIiM,qBAC9B3U,EAAGqL,UAAUtJ,EAAQ6S,MAAOlM,EAAIkM,OAChC5U,EAAGqL,UAAUtJ,EAAQoW,gBAAiBnH,GACtC,IAAIpJ,EAAOc,EAAId,KACf5H,EAAG8R,UAAU/P,EAAQoT,MAAOvN,EAAKL,KAAMK,EAAKF,MAC5C1H,EAAG8R,UAAU/P,EAAQqT,MAAOxN,EAAKH,KAAMG,EAAKD,MAE5C,IAAIkN,EAASnM,EAAImM,OACjB7U,EAAG8U,UAAU/S,EAAQ8S,OAAQA,EAAOE,OAAQF,EAAOG,OAAQH,EAAOI,OAAQJ,EAAOK,QACjFlV,EAAG0L,WAAW1L,EAAGoY,OAAQ,EAAGlH,mCCnIjB,SAAS/jB,GAAQkrB,EAAK9iB,GAGnC,OAFKA,IAASA,EAAU,IAEjB,IAAI7J,QAAQ4sB,GAEnB,SAASA,EAAS3sB,EAASC,GACzB,IAAI2sB,EAAM,IAAIC,eAgBd,SAASC,EAAentB,GAClBA,EAAEotB,kBACJnjB,EAAQojB,SAAS,CACfC,OAAQttB,EAAEstB,OACVC,MAAOvtB,EAAEutB,MACTC,QAASxtB,EAAEstB,OAASttB,EAAEutB,QAK5B,SAASE,IACP,GAAmB,MAAfR,EAAIS,OAAR,CAIA,IAAIC,EAAWV,EAAIU,SAEU,SAAzB1jB,EAAQ2jB,cAA+C,kBAAbD,IAE5CA,EAAWjlB,KAAKmlB,MAAMF,IAGxBttB,EAAQstB,QAVNrtB,EAAM,0BAAAyI,OAA2BkkB,EAAIS,OAA/B,kBAAA3kB,OAAsDgkB,IAahE,SAASe,IACPxtB,EAAM,sBAAAyI,OAAuBgkB,IAG/B,SAASgB,IACPztB,EAAM,yBAAAyI,OAA0BgkB,IA5CF,oBAArB9iB,EAAQojB,UACjBJ,EAAIe,iBAAiB,WAAYb,GAAgB,GAGnDF,EAAIe,iBAAiB,OAAQP,GAAkB,GAC/CR,EAAIe,iBAAiB,QAASF,GAAgB,GAC9Cb,EAAIe,iBAAiB,QAASD,GAAkB,GAEhDd,EAAIgB,KAAK,MAAOlB,GACZ9iB,EAAQ2jB,eACVX,EAAIW,aAAe3jB,EAAQ2jB,cAE7BX,EAAIiB,KAAK,OCzBb,IAAIC,GAAc,IAAIC,IAGP,SAASC,GAAUC,GAChC,IAAKA,EAAM,OAAOluB,QAAQE,OAAO,gBACjC,IAAIiuB,EAAUD,EAAKE,OACnB,IAAKD,EAAS,OAAOnuB,QAAQE,OAAO,gBAEpC,IAAImuB,EAAiBN,GAAYzrB,IAAI6rB,GACrC,OAAIE,EAAuBruB,QAAQC,QAAQouB,GAEpC5sB,GAAQysB,GAAMI,KAAK,SAAAjS,GAExB,OADA0R,GAAYpd,IAAIud,EAAM7R,GACfA,ICXX,IAAIkS,GAAgB,YAChBC,GAAW,CAAEnS,KAAM,IAQR,SAASoS,GAAiBpS,GACvC,IAAKA,EAAM,OAAO,IAAIrc,QAAQ,SAAAC,GAAO,OAAIA,EAAQuuB,MAEjD,IAAIE,EAAcC,GAAkBtS,GACpC,OAAIqS,EAAYE,QAAQ7wB,OAAS,EACxBiC,QAAQ6B,IAAI6sB,EAAYE,SAASN,KAAK,kBAAMI,IAChDG,MAAM,SAAAttB,GAAW,MAAO,CAACA,MAAO,CAACA,YAG/B,IAAIvB,QAAQ,SAAAC,GAAO,OAAIA,EAAQyuB,KAGxC,SAASC,GAAkBtS,GACzB,IAAIuS,EAAU,GACVE,EAAQzS,EAAK0S,MAAM,MACnBC,EAAc,GACdC,EAAe,EAWnB,OAVAH,EAAM1M,QAAQ,SAACI,EAAMnjB,GACnB4vB,EAAe5vB,EACXmjB,GAAoB,MAAZA,EAAK,IACfwM,EAAY/wB,KAAK,IACjBixB,EAAc1M,IAEdwM,EAAY/wB,KAAKukB,KAId,CACLvI,UACA2U,WAGF,SAAS3U,IACP,OAAO+U,EAAYpN,KAAK,MAG1B,SAASsN,EAAc1M,GACrB,GAAoC,IAAhCA,EAAK2M,QAAQZ,IAAsB,CACrC,IAAIa,EAAU5M,EAAK6M,OAAOd,GAAcxwB,QACpCuxB,EAAcL,EAClBL,EAAQ3wB,KAAKgwB,GAAUmB,GAASd,KAAK,SAAAjS,GACnC2S,EAAYM,GAAejT,OC1CnC,IAAIkT,GAAa,CACfC,MADe,SACTnT,GACJ,MAAO,CACLA,OACAoT,IAAK,CACHC,WAAY,MAQpB7rB,sCAEE0rB,GAAa1rB,EAAQ,QAGrB8Y,KAAIC,KAAK,sBALX3Z,KAAA,KAAA/D,IAAA2vB,MAAA3vB,EAAAmE,IAQA,IAAIssB,GAAkB,2NAmBP,SAASC,GAA6BC,GAEnD,OAAOC,GAAYD,GAAiBvB,KAAK,SAAAyB,GACvC,GAAIA,EAAkBxuB,MACpB,OAAOwuB,EAGTF,EAAkBE,EAAkB9V,UAEpC,IAAI+V,EAAeT,GAAWC,MAAMK,EAAiB,CAAEI,QAASN,KAKhE,OAJAK,EAAa3T,KAAOwT,EAEhBG,EAAaP,IAAIC,aAAYM,EAAazuB,MAAQ2uB,GAAYF,EAAaP,MAExEO,IAIX,SAASE,GAAYT,GACnB,IAAIU,EAAOV,EAAIW,YAAY,GAEvBC,EAAaF,EAAKlnB,MAClBqnB,EAAaD,EAAWC,aACxB1Y,EAASyY,EAAWzY,OACpBiP,EAASjP,EAAO2Y,aAAaD,EAAW9N,MACxCA,EAAO5K,EAAO4Y,SAASnB,OAAOxI,EAASyJ,EAAWG,QACtDjO,GAAQ5K,EAAO4Y,SAASE,UAAUL,EAAW9kB,MAAO8kB,EAAWM,KAC/D,IAAIC,EAAS,QAAUN,EAAW9N,KAAO,KACrCqO,EAAWV,EAAKW,KACpB,MAAO,CACLvvB,MACEqvB,EAASpO,EAAO,KAChBuO,GAAWH,EAAO7yB,QAAUgzB,GAAWT,EAAWG,QAAU,IAC9DO,YAAaH,EACbI,aAAcA,GAAaJ,IAI/B,SAASI,GAAaJ,GACpB,OAAOA,EAAS1B,QAAQ,UAAY,GAClC0B,EAAS1B,QAAQ,YAAe,EAGpC,SAAS4B,GAAWhzB,GAClB,OAAO,IAAImzB,MAAMnzB,EAAS,GAAG6jB,KAAK,KCpFrB,SAASuP,GAA6B3F,GACnD7O,KAAI5W,GAAG,oBAAqBqrB,GAC5B,IAOIpB,EAPAqB,EAA4B,EAG5BC,EAAyB3X,GAASM,UAMtCsX,IAEA,IAAI5T,EAAM,CACR1D,UACAuX,UACAle,UACA2U,iBAGA5L,KAAMiV,EACN/vB,MAAO,GACPyvB,YAAa,GACbC,cAAc,GAGhB,OAAOtT,EAEP,SAASrK,IACPqJ,KAAIuJ,IAAI,oBAAqBkL,GAG/B,SAASnX,IACP,OAAON,GAASM,UAGlB,SAASuX,EAAQ3B,GACXA,IAAoByB,EAUxBG,EAAc5B,GAAiBvB,KAAK,SAAC1vB,GACnC,IAAIA,EAAO8yB,UAAX,CAEA,GAAI9yB,GAAUA,EAAO2C,MAEnB,OADAowB,EAAgB/yB,EAAO2C,OAChB3C,EAGT0yB,EAAyBzB,EACzBlS,EAAItB,KAAOwT,EACXlW,GAASK,SAAS6V,MAjBdG,GAAgBA,EAAazuB,OAE/B6vB,IAmBN,SAASO,EAAgB3B,GACnBA,GAAgBA,EAAazuB,OAC/Boc,EAAIpc,MAAQyuB,EAAazuB,MACzBoc,EAAIqT,YAAchB,EAAagB,YAC/BrT,EAAIsT,aAAejB,EAAaiB,eAEhCtT,EAAIpc,MAAQ,GACZoc,EAAIqT,YAAc,GAClBrT,EAAIsT,cAAe,GAIvB,SAASM,IACP,IAAIK,EAAgBjY,GAASM,UACzB2X,EACFH,EAAcG,GAAetD,KAAK,SAAA1vB,GAC3BA,EAAO2C,QAEZgC,QAAQhC,MAAM,4CAA6C3C,EAAO2C,OAElEkwB,EAAc9X,GAASO,qBAIzBuX,EAAc9X,GAASO,kBAI3B,SAASkX,EAAUS,GACjB,OAAOjC,GAA6BiC,GAAcP,GAC/ChD,KAAK,SAAAwD,GAGJ,OAFA9B,EAAe8B,EACfH,EAAgB3B,EAAazuB,OACtByuB,IAIb,SAASyB,EAAc5B,GACrBwB,GAA6B,EAC7B,IAAIU,EAAkBV,EAEtB,OAAOD,EAAUvB,GAAiBvB,KAAK,SAAA0B,GACrC,GAAI+B,IAAoBV,EAGtB,OAFArB,EAAa0B,WAAY,EAElB1B,EAGT,GAAIA,EAAazuB,MACf,OAAOyuB,EAGT,IAEE,OADAxE,EAAYnL,WAAW2P,EAAa3T,MAC7B2T,EACP,MAAOpwB,GACP,MAAO,CACL2B,MAAO,CACLA,MAAO3B,EAAEoyB,aAOnB,SAAS/J,EAAeS,EAAShmB,GAC/B8oB,EAAYvD,eAAeS,EAAShmB,cCrIzB,SAASuvB,KACtB,IACIC,EADAC,EAAc,IAAInE,IAEtB,MAAO,CACLnF,iBACAuJ,aAGF,SAASA,EAAUC,EAAYC,GAC7B,IAAIC,EAAcJ,EAAY7vB,IAAI+vB,GAC9BE,GACFA,EAAYjf,UAEd6e,EAAYxhB,IAAI0hB,EAAYC,GAG9B,SAASzJ,EAAexS,GACtB6b,EAAiB7b,EACjB8b,EAAY/P,QAAQoQ,GAGtB,SAASA,EAAmBC,EAAOJ,GACjCI,EAAMC,cAAcR,EAAgBG,ICzBzB,SAASM,GAAYre,EAAIqY,GACtC,IAAIiG,EAAgBC,EAEhBC,EAAQ,IAAIC,MAOhB,OANAD,EAAME,YAAc,GAEpBF,EAAM9xB,OAASqT,EACfye,EAAM/xB,QAAUkyB,EAChBH,EAAMjyB,IAAM8rB,EAEL,IAAI3sB,QAAQ,SAACC,EAASC,GAC3B0yB,EAAiB3yB,EACjB4yB,EAAgB3yB,IAGlB,SAAS+yB,EAAY3vB,GACnBuvB,EAAcvvB,GAGhB,SAAS+Q,IACP,IAAIjC,EAAUkC,EAAGN,gBACbkf,EAAQ,EACRC,EAAiB7e,EAAGkB,KACpB4d,EAAY9e,EAAGkB,KACf6d,EAAU/e,EAAGmB,cACjBnB,EAAGD,YAAYC,EAAGI,WAAYtC,GAC9BkC,EAAGiB,WAAWjB,EAAGI,WAAYwe,EAAOC,EACtBC,EAAWC,EAASP,GAE9BQ,GAAWR,EAAMnsB,QAAU2sB,GAAWR,EAAMlsB,QAC7C0N,EAAGif,eAAejf,EAAGI,aAErBJ,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGW,eAAgBX,EAAGY,eACtDZ,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGa,eAAgBb,EAAGY,eACtDZ,EAAGU,cAAcV,EAAGI,WAAYJ,EAAGc,mBAAoBd,EAAGkf,SAG7DZ,EAAexgB,IAInB,SAASkhB,GAAW5wB,GAClB,OAAgC,IAAxBA,EAASA,EAAQ,GCnC3B,IAAMkoB,GAAoBlI,GAAOkI,kBAElB,SAAS6I,GAAwBzW,EAAK2P,EAAK+G,GACxD,IAAIthB,EAAU,KAGd,OAFAugB,GAAY3V,EAAI1I,GAAIqY,GAAK2B,KAAKqF,GAAY9E,MAAM+E,GAEzC,CACLlB,gBACApf,QAFK,WAIH0J,EAAI1I,GAAG4K,cAAc9M,KAIzB,SAASwhB,EAAYtwB,GACfowB,GAAaA,EAAUnyB,OACzBmyB,EAAUnyB,MAAM+B,GAIpB,SAASqwB,EAAWE,GAClBzhB,EAAUyhB,EACVlX,KAAIC,KAAK,iBACL8W,GAAaA,EAAUI,MACzBJ,EAAUI,KAAKnH,GAInB,SAAS+F,EAAcrc,EAASgc,GAC9B,GAAKjgB,EAAL,CAEA,IAAI2hB,EAAY1B,EAAazH,GAC7BpN,GAAQnJ,YAAY2I,EAAI1I,GAAIlC,EAAS2hB,GACrC/W,EAAI1I,GAAGmL,UAAUpJ,EAAO,QAAA1N,OAAS0pB,IAAe0B,KCnCrC,SAASC,GAAkBhX,GACxCA,EAAI4L,OAASqJ,KACb,IAAIrJ,EAAS,GACbqL,IAEA,IAAItW,EAAM,CACRuW,YACAC,YAGF,OAAOxW,EAEP,SAASuW,IACP,OAAOtL,EAGT,SAASuL,EAASC,GAChB,IAAIC,EAAKC,GAA4BtX,EAAKoX,GAE1C,OADAxL,EAAO3qB,KAAKo2B,GACLA,EAGT,SAASJ,IACP,IAAIM,EAAK5a,GAASI,QAAQzX,IAAI,MAC9B,GAAIiyB,EAAI,CACN,IAAIF,EAAKF,EAAS,GAClBE,EAAGnG,KAAOqG,EACVF,EAAG3B,eAAgC,KAKzC,SAAS4B,GAA4BtX,EAAKoX,GACxC,IAAII,EAAgB,KAEhB/B,EAAQ,CACVvE,KAAM,GACN3sB,MAAO,KACPU,KAAI,QAAA0G,OAAUyrB,GACd1B,iBAGF,OAAOD,EAEP,SAASC,EAAc+B,GACjBD,IACFvzB,aAAauzB,GACbA,EAAgB,MAGdC,EACFC,IAEAF,EAAgB7yB,WAAW+yB,EAAY,KAI3C,SAASA,IACPjC,EAAMlxB,MAAQ,KACdizB,EAAgB,KAChB,IAAIG,EAAUlB,GAAwBzW,EAAKyV,EAAMvE,KAAM,CACrD4F,KADqD,WAGnDna,GAASI,QAAQpJ,IAAjB,IAAAhI,OAAyByrB,GAAe3B,EAAMvE,OAEhD3sB,MALqD,SAK/C+B,GAEJmvB,EAAMlxB,MAAQ+B,KAGlB0Z,EAAI4L,OAAOwJ,UAAU,EAAGuC,ICzD5B,IAAMC,GAAgB,EAEtB,SAASC,GAA6BC,GACpC,MAAe,KAARA,EAGT,SAASC,GAAiBD,GACxB,OAAO,EAAY,KAARA,EAQE,SAASE,GAAU1gB,GAEhC,IAAI6I,EAAa,CAAExW,MAAO,EAAGC,OAAQ,EAAGquB,IAAK,EAAGC,KAAM,GACtDC,EAAe1xB,OAAOqL,WAAYrL,OAAOsL,aAEzCqmB,IAIA,IAAIlZ,EAAOvC,GAASE,WAAa,GAC7Bwb,EAA0B,CAC5BvY,MAAO,GACPlM,EAAGnN,OAAOqL,WAAa,EACvB/C,EAAGtI,OAAOsL,YAAc,GAItBsK,EAAgBM,GAASY,mBAE7BjG,EAAGwK,QAAQxK,EAAGghB,YACdhhB,EAAGwK,QAAQxK,EAAGihB,cAKd,IAuDIC,EACAC,EAxDAzY,EAAM,CACR1I,KACA4H,OACAiB,aAEAyL,OAAQ,KAERlT,YAAapB,EAAGohB,oBAGhBpW,WAAYgH,GAAKnS,aAAaG,EAAI,IAAI+V,aAAa,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,KAErF9Q,UAAWI,GAASgB,eACpBM,cAAetB,GAASkB,mBAKxB2E,kBAAmB,EAEnBsV,MAAOF,GACP3L,oBAAqB4L,GAA6BD,IAGlDxb,gBAAiBO,GAASQ,qBAG1B+O,MAAO,EAKPC,OAAQ,CAENE,OAAQ,EAAGC,OAAQ,EAGnBC,OAAQ,EAAGC,OAAQ,GAIrBlE,wBAAyB,EAGzBrH,YAAa8W,GAAiBH,IAE9BnW,gBAAiB,CAAElc,EAAG,EAAGmc,EAAG,EAAGC,EAAG,EAAGvV,EAAG,GAKxC4V,aAAc,MAMZ2W,GAAW,EAEXC,EAAc5B,GAAkBhX,GAGhCO,EAAgBsY,GAAoB7Y,GACpCwO,EAAcsK,GAA2B9Y,GAEzC+Y,EAAyB5E,GAA6B3F,GAG1DzF,EAAqB1M,GAErB,IAAIsE,EAAM,CACRpS,MAAOyqB,EACPC,OACA3iB,UAEA4iB,YAEAC,oBACAC,oBAEAC,kBACAC,kBAEAlc,qBACAD,qBAEAoc,WACAC,WAEA5b,eACAD,eAEAG,mBACAD,mBAEAkb,yBACAjK,sBAEA8J,cAEAa,qBAEAC,cAhCQ,WAkCN,OAAOvZ,GAGTwZ,eArCQ,WAuCN,OAAO3Z,EAAId,OAUf,OANA0a,IAEAj1B,WAAW,WACTgb,KAAIC,KAAK,cAAee,KAGnBA,EAUP,SAAS/C,EAAahK,GACpB,IAAIhO,EAAOi0B,SAASjmB,EAAG,IACvBoM,EAAIzD,UAAY3W,EAChB4oB,EAAYK,gBAAgBjpB,GAG9B,SAAS+X,IACP,OAAOqC,EAAIzD,UAGb,SAASuB,EAAiBuB,GACxBW,EAAI/B,cAAgBoB,EACpBmP,EAAYK,gBAAgB7O,EAAIzD,WAGlC,SAASuS,EAAoBppB,GAC3B8oB,EAAYM,oBAAoBppB,GAGlC,SAASmY,IACP,OAAOmC,EAAI/B,cAGb,SAASsb,IACP,OAAOvZ,EAAI8X,MAGb,SAAS0B,EAAS5lB,GAChB,IAAIkmB,EAAIC,WAAWnmB,GACf2L,OAAOC,SAASsa,KAClB9Z,EAAI8X,MAAQgC,EACZ9Z,EAAIiM,oBAAsB4L,GAA6BC,OACvD9X,EAAIiB,YAAc8W,GAAiBD,OACnCnY,KAAIC,KAAK,+BAAgCI,EAAIiM,sBAIjD,SAASiN,EAAUc,GACjBrB,EAAWqB,EACXhB,IAIF,SAASK,EAAgBzlB,GACvB,IAAIkmB,EAAIC,WAAWnmB,GACf2L,OAAOC,SAASsa,KAClB9Z,EAAIiB,YAAc6Y,EAClBnd,GAASe,WAAWoc,IAIxB,SAASR,IACP,OAAO3c,GAASc,aAIlB,SAAS0b,IACP,OAAOxc,GAASY,mBAGlB,SAAS6b,EAAkBa,GACpB1a,OAAOC,SAASya,IACjBA,IAAqB5d,IACrB4d,EAAmB,IAEvBlR,EAAqBkR,GAErB5d,EAAgB4d,EAChBtd,GAASa,iBAAiByc,KAI5B,SAAS7c,EAAmBxJ,GAC1B,IAAIkmB,EAAIC,WAAWnmB,GACf2L,OAAOC,SAASsa,KAElBnd,GAASS,mBAAmB0c,GAC5B9Z,EAAI5D,gBAAkB0d,GAI1B,SAAS3c,IACP,OAAOR,GAASQ,qBAGlB,SAASib,IACPD,EAAe1xB,OAAOqL,WAAYrL,OAAOsL,aAErCwO,IACFA,EAAcD,uBACd4Z,KAIJ,SAAS/B,EAAe1Z,EAAGzK,GACzB,IAAIkC,EAAKlG,KAAKC,IAAQ,IAAJwO,EAAU,IACxBlO,EAAKP,KAAKC,IAAQ,IAAJ+D,EAAU,IACxBJ,EAAI6K,EAAI,EAAIvI,EACZnH,EAAIiF,EAAI,EAAIzD,EAChB4P,EAAWxW,MAAQlD,OAAO0zB,iBAAmBvmB,EAC7CuM,EAAWvW,OAASnD,OAAO0zB,iBAAmBprB,EAC9CoR,EAAW8X,KAAQ1nB,EACnB4P,EAAW+X,MAAShiB,EAGpB,IAAIkkB,EAAS9iB,EAAG8iB,OAChBA,EAAOC,MAAM1wB,MAAQiK,EAAI,KACzBwmB,EAAOC,MAAMzwB,OAASmF,EAAI,KAC1BqrB,EAAOC,MAAMnC,MAAShiB,EAAM,KAC5BkkB,EAAOC,MAAMpC,KAAQ1nB,EAAM,KAC3B6pB,EAAOzwB,MAAQwW,EAAWxW,MAC1BywB,EAAOxwB,OAASuW,EAAWvW,OAG7B,SAAS0M,IACP2iB,IACAxyB,OAAO6zB,oBAAoB,SAAUlC,GAAU,GAC/CW,EAAuBziB,UAGzB,SAAS0iB,IACHR,GAEAG,IAEJH,EAAqB5pB,sBAAsB2rB,GAC3C9B,EAAyBhtB,KAAK+C,OAGhC,SAASyqB,IACP7iB,qBAAqBoiB,GACrBA,EAAqB,EACrBC,OAAyB/zB,EAG3B,SAAS61B,IAIP,GAHA/B,EAAqB,EAGjBC,EAAwB,CAC1B,IAAI+B,EAAqB/uB,KAAK+C,MAAQiqB,EAClCgC,EAAoB,IAAO,GAAMD,EACjCE,EAAiB1a,EAAI8X,MAAQ9nB,KAAKyP,IAAIgb,EAAkB,GAC5Dza,EAAIiM,oBAAsB4L,GAA6B6C,GACvD1a,EAAIiB,YAAc8W,GAAiB2C,GAGrCC,IAEA3B,IAGF,SAAS2B,IACPpa,EAAcK,mBACd4N,EAAYI,gBACZrO,EAAcM,sBACd2N,EAAY1F,2BAGd,SAASC,EAAqBP,GAE5BxI,EAAIsI,wBAA0BtY,KAAK4qB,KAAK5qB,KAAKQ,KAAKgY,IAClDgG,EAAYzF,uBAGd,SAAS6Q,IACezZ,EAAjBxW,MAAiBwW,EAAVvW,OAEHoG,KAAKwF,GAAKxF,KAAK6qB,EACf7qB,KAAKwF,GAAKxF,KAAK6qB,EAMxBX,IAGF,SAASA,IACP3Z,EAAcO,oBAAqB,EAEnCuX,EAA0B,CACxBvY,MAAO,GACPlM,EAAGnN,OAAOqL,WAAa,EACvB/C,EAAGtI,OAAOsL,YAAc,GANC,IAStBpI,EAAiBwW,EAAjBxW,MAAOC,EAAUuW,EAAVvW,OACZD,GAASlD,OAAO0zB,iBAChBvwB,GAAUnD,OAAO0zB,iBAEjB,IAAItb,EAAOic,EAAQ,GACf9b,EAAO+b,EAAQ,GACfhc,EAAO+b,EAAQnxB,GACfsV,EAAO8b,EAAQnxB,GAIfrH,EAAI,IAQR,SAASu4B,EAAQlnB,GACf,OAAQA,EAAIykB,EAAwBzkB,GAAGykB,EAAwBvY,MAGjE,SAASib,EAAQhsB,GACf,OAAQA,EAAIspB,EAAwBtpB,GAAGspB,EAAwBvY,MAZjEZ,EAAKL,KAAO7O,KAAK8O,MAAMvc,EAAIsc,EAAKlV,GAAOpH,EACvC2c,EAAKF,KAAOhP,KAAK8O,MAAMvc,GAAKyc,EAAKrV,GAAOpH,EACxC2c,EAAKH,KAAO/O,KAAK8O,MAAMvc,EAAIwc,EAAKpV,GAAOpH,EACvC2c,EAAKD,KAAOjP,KAAK8O,MAAMvc,GAAK0c,EAAMtV,GAAOpH,EAEzCod,KAAIC,KAAK,cAAeV,GAY1B,SAASua,EAAmBhY,GAC1BzB,EAAIyB,gBAAkBA,0iBC5Y1B,SAAS3B,GAAMlM,GAEb,OAAOA,EAIT,IAAqBonB,GAArB,SAAA3wB,GADA,SAAA4wB,IAAA,IAAApwB,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAuzB,kEA+CUpwB,EAAAsR,SAAmB,IACnBtR,EAAAuR,gBAA0B,KAC1BvR,EAAAyR,QAAkB,KAjD5BzR,EACA,OAAA3J,OAAAyJ,EAAA,KAAAzJ,CAAA+5B,EAAA5wB,GAAAnJ,OAAA0J,EAAA,KAAA1J,CAAA+5B,EAAA,EAAAj1B,IAAA,UAAAN,MAAA,WAyDI,IAAI00B,EAA4B1yB,KAAK8L,IACjC0nB,EAAa,CAAEC,WAAW,EAAM/yB,OAAO,EAAOuJ,uBAAuB,GACrE2F,EAAK8iB,EAAOjlB,WAAW,QAAS+lB,IACpCd,EAAOjlB,WAAW,qBAAsB+lB,GAExCxzB,KAAK8J,MAAQwmB,GAAU1gB,GACvB5P,KAAK8J,MAAM4nB,kBAAkB1xB,KAAK2U,eAClC3U,KAAK8J,MAAMioB,mBAAmB,CAC5Bl0B,EAAG,IAAMmc,EAAG,EAAGC,EAAG,GAAKvV,EAAG,IAE5B1E,KAAK8J,MAAM4L,mBAAmB,MAC9B1V,KAAK0zB,oBACL1zB,KAAK2zB,sBACL3zB,KAAK8J,MAAMoM,aAAazC,GAAWE,UAE9B3T,KAAK4zB,gBACR5zB,KAAK8J,MAAMjD,UAzEjB,CAAAvI,IAAA,gBAAAN,MAAA,WA6EIgC,KAAK8J,MAAM8E,UACX5O,KAAK8L,IAAI+nB,WA9Eb,CAAAv1B,IAAA,sBAAAN,MAAA,SAiFuBQ,GACnB,OAAIiG,EAAAC,EAAE0H,MAAM5N,GACH,KACFA,EAAEs1B,QAAQ,KApFrB,CAAAx1B,IAAA,oBAAAN,MAAA,WAiKSgC,KAAK8J,OAGV9J,KAAK8J,MAAMunB,uBAAuBvE,QAAQ9sB,KAAK+zB,YApKnD,CAAAz1B,IAAA,iBAAAN,MAAA,SAuKkBgmB,EAAShmB,GAClBgC,KAAK8J,OAGV9J,KAAK8J,MAAMunB,uBAAuB9N,eAAeS,EAAShmB,KA3K9D,CAAAM,IAAA,sBAAAN,MAAA,SA8KuBA,GACdgC,KAAK8J,OAGV9J,KAAK8J,MAAMsd,oBAAoBppB,KAlLnC,CAAAM,IAAA,sBAAAN,MAAA,WA+MSgC,KAAK8J,OAGV9J,KAAK8J,MAAMsM,iBAAiBpW,KAAKuW,iBAlNrC,CAAAjY,IAAA,YAAAN,MAAA,WAuNIgC,KAAKujB,eAAe,KAAMvjB,KAAKwG,MAvNnC,CAAAlI,IAAA,YAAAN,MAAA,WA2NIgC,KAAKujB,eAAe,KAAMvjB,KAAKyG,MA3NnC,CAAAnI,IAAA,YAAAN,MAAA,WA+NIgC,KAAKujB,eAAe,KAAMvjB,KAAKg0B,MA/NnC,CAAA11B,IAAA,YAAAN,MAAA,WAmOIgC,KAAKujB,eAAe,KAAMvjB,KAAKi0B,MAnOnC,CAAA31B,IAAA,YAAAN,MAAA,WAuOIgC,KAAKujB,eAAe,KAAMvjB,KAAKk0B,MAvOnC,CAAA51B,IAAA,gBAAAN,MAAA,WA4OIgC,KAAKonB,oBAAoBpnB,KAAKm0B,UA5OlC,CAAA71B,IAAA,cAAAN,MAAA,WAiPQgC,KAAK8J,OACP9J,KAAK8J,MAAM9J,KAAK4zB,eAAiB,OAAS,aAlPhD,CAAAt1B,IAAA,sBAAAN,MAAA,WAuPQgC,KAAK8J,OACP9J,KAAK8J,MAAM4nB,kBAAkB1xB,KAAK2U,iBAxPxC,CAAArW,IAAA,SAAAN,MAAA,SA2PUsO,GACN,OAAOA,EAAE,SAAU,CAAEtL,MAAO,sBA5PhC,CAAA1C,IAAA,KAAAV,IAAA,WAmBI,OAAOwa,GAAMpY,KAAKU,SAnBtB,CAAApC,IAAA,KAAAV,IAAA,WAuBI,OAAOwa,GAAMpY,KAAKc,SAvBtB,CAAAxC,IAAA,KAAAV,IAAA,WA2BI,OAAOwa,GAAMpY,KAAKW,SA3BtB,CAAArC,IAAA,KAAAV,IAAA,WA8BI,OAAOwa,GAAMpY,KAAKY,SA9BtB,CAAAtC,IAAA,KAAAV,IAAA,WAiCI,OAAOwa,GAAMpY,KAAKa,SAjCtB,CAAAvC,IAAA,iBAAAV,IAAA,WA2CI,OAAOoC,KAAKe,QAAUf,KAAKxB,EAAI,IA3CnC,CAAAF,IAAA,gBAAAV,IAAA,WAmDI,OAAO0K,KAAKC,IACVvI,KAAKxB,GAAKO,OAAOsL,YAActL,OAAOqL,YAAc,IAAO9B,KAAKS,IAAIhK,OAAO0zB,iBAAkB,GAC7F,KArDN,CAAAn0B,IAAA,WAAAV,IAAA,WAwFI,IAAIw2B,EAAsB,GAE1BA,EAAU76B,KAAV,aACA66B,EAAU76B,KAAV,aACA66B,EAAU76B,KAAV,yBACA66B,EAAU76B,KAAV,wBACA66B,EAAU76B,KAAV,wBAEA66B,EAAU76B,KAAV,oBACE,IAAI86B,EAAS,CACXnoB,EAAC,MACD7E,EAAC,QAEH+sB,EAAU76B,KAAV,2BAAA0K,OAA0CowB,EAAOnoB,EAAjD,kDACAkoB,EAAU76B,KAAV,2BAAA0K,OAA0CowB,EAAOhtB,EAAjD,kDACF+sB,EAAU76B,KAAV,KAGA66B,EAAU76B,KAAV,oBACE,IAAI+6B,EAAU,CACZpoB,EAAC,yDACD7E,EAAC,gEAEH+sB,EAAU76B,KAAV,+CACA66B,EAAU76B,KAAV,yCACE66B,EAAU76B,KAAV,2BAAA0K,OAA0CqwB,EAAQpoB,EAAlD,OACAkoB,EAAU76B,KAAV,2BAAA0K,OAA0CqwB,EAAQjtB,EAAlD,OACF+sB,EAAU76B,KAAV,KACF66B,EAAU76B,KAAV,KAGA66B,EAAU76B,KAAV,oBACE,IAAIg7B,EAAQ,CACVroB,EAAC,iEACD7E,EAAC,oEAEH+sB,EAAU76B,KAAV,2BAAA0K,OAA0CswB,EAAMroB,EAAhD,OACAkoB,EAAU76B,KAAV,2BAAA0K,OAA0CswB,EAAMltB,EAAhD,OACF+sB,EAAU76B,KAAV,KAGA66B,EAAU76B,KAAV,oBACE66B,EAAU76B,KAAV,mCACA66B,EAAU76B,KAAV,mCACF66B,EAAU76B,KAAV,KAEA66B,EAAU76B,KAAV,oBACE66B,EAAU76B,KAAV,oCACA66B,EAAU76B,KAAV,oCACA66B,EAAU76B,KAAV,sDAEA,IAAIi7B,EAAc,CAChBtoB,EAAC,0EACD7E,EAAC,2EASL,OAPE+sB,EAAU76B,KAAV,2BAAA0K,OAA0CuwB,EAAYtoB,EAAtD,OACAkoB,EAAU76B,KAAV,2BAAA0K,OAA0CuwB,EAAYntB,EAAtD,OACF+sB,EAAU76B,KAAV,KAEA66B,EAAU76B,KAAV,cACA66B,EAAU76B,KAAV,cAEA,4EAAA0K,OAIImwB,EAAUlX,KAAK,MAJnB,gCAtJJ,CAAA5e,IAAA,SAAAV,IAAA,WAsLI,IAAI62B,EAAKnsB,KAAKS,KAAK/I,KAAKyG,GAAKzG,KAAKwG,IAAM,EAAI,GAAK,GAC7CkuB,EAAKpsB,KAAKS,KAAK/I,KAAKg0B,GAAKh0B,KAAKi0B,GAAKj0B,KAAKk0B,IAAM,EAAG,GACjDxsB,EAAI+sB,EAAKC,EAMb,OAHAhtB,EAAIY,KAAKyP,IAAI,EAAGrQ,GAChBA,EAAIY,KAAKC,IAAI,EAAGb,GAETA,IA9LX,CAAApJ,IAAA,gBAAAV,IAAA,WAkMI,ucAlMJ21B,EAAA,CAAgD3uB,EAAA,QAI9C+vB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,2DAIlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,2DAIlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,2DAIlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,2DAIlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,2DAsBlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsV,UAAU,uDAIlB6lB,GAAA,CADCn7B,OAAAoL,EAAA,QAAApL,CAAK,CAAEsL,SAAS,6DA+KjB6vB,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,qHAGN,MAEDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,qHAGN,MAEDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,qHAGN,MAEDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,qHAGN,MAEDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,qHAGN,MAGDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,6HAGN,MAGDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,mIAIN,MAGDm7B,GAAA,CADCn7B,OAAAoL,EAAA,SAAApL,CAAM,0IAIN,MAzPkB85B,GAAkBqB,GAAA,CADtC/vB,EAAA,cACoB0uB,IAAA,ICfjBsB,GAAQC,GDeSC,GAAA,GEfwXC,GAAA,GDQzYC,cAAYx7B,OAAA0L,EAAA,KAAA1L,CACdu7B,GACAH,GACAC,IACF,EACA,KACA,WACA,OAIAG,GAAS7vB,QAAAC,OAAA,yBACM,IAAA6vB,GAAAD,8hCE2VfE,GAAA,WAAYC,QAAQrqB,IAClBsqB,GAAA1wB,EAAa2wB,GAAA3wB,EACb4wB,GAAA5wB,EAAc6wB,GAAA7wB,EACd8wB,GAAA9wB,EAAmB+wB,GAAA/wB,EACnBgxB,GAAAhxB,EAAQixB,GAAAjxB,EACRkxB,GAAAlxB,EAAamxB,GAAAnxB,EAAcoxB,GAAApxB,EAAWqxB,GAAArxB,EAAYsxB,GAAAtxB,EAASuxB,GAAAvxB,GAkB7D,IAAqBwxB,GAArB,SAAAvzB,GATA,SAAAwzB,IAAA,IAAAhzB,EAAA,OAAA3J,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAm2B,kEAWUhzB,EAAAjC,kBAA4B,EAC5BiC,EAAAizB,mBAA6B,EAE7BjzB,EAAAkzB,sBAAgC,EAChClzB,EAAAmzB,iBAA2B,EAC3BnzB,EAAAozB,uBAAiC,EACjCpzB,EAAAqzB,gBAA0B,GAC1BrzB,EAAAszB,gBAA0B,EAE1BtzB,EAAAuzB,eAA+C,GAE/CvzB,EAAAzC,MAAgB,EAChByC,EAAAxC,MAAgB,EAChBwC,EAAAvC,MAAgB,EAChBuC,EAAAtC,MAAgB,EAChBsC,EAAArC,MAAgB,EAChBqC,EAAA3E,EAAY,EACZ2E,EAAApC,QAAkB,EAClBoC,EAAAwzB,uBAAiC,EAEjCxzB,EAAAyzB,WAAqB,EACrBzzB,EAAA0zB,YAAc,CACpBC,MAAO,CAAC,GAAK,KACbC,OAAQ,CAAC,IAAK,KACdC,OAAQ,CAAC,IAAK,KACdC,OAAQ,CAAC,IAAK,KACdC,MAAO,CAAC,GAAK,KArCjB/zB,EASA,OAAA3J,OAAAyJ,EAAA,KAAAzJ,CAAA28B,EAAAxzB,GAAAnJ,OAAA0J,EAAA,KAAA1J,CAAA28B,EAAA,EAAA73B,IAAA,UAAAN,MAAA,WAkCIgC,KAAKm3B,WAAa,IAAIC,EAAA,gBAlC1B,CAAA94B,IAAA,uBAAAN,MAAA,WAsCIe,OAAOs4B,SAASC,KAAO,2BAtC3B,CAAAh5B,IAAA,4BAAAN,MAAA,wKA0CIgC,KAAKu3B,OAASC,KAAG,yBAA0B,CACzCC,qBAAsB,IAGxBz3B,KAAKu3B,OAAOl2B,GAAG,UAAW,WACxBsF,EAAKnI,EAAI,IACTmI,EAAKjG,MAAQ,EACbiG,EAAK5F,QAAS,IAGhBf,KAAKu3B,OAAOl2B,GAAG,UAAW,SAACq2B,GACzB/wB,EAAKnI,EAAIk5B,EAAcl5B,EACvBmI,EAAKjG,MAAQg3B,EAAch3B,MAC3BiG,EAAKhG,MAAQ+2B,EAAc/2B,MAC3BgG,EAAK/F,MAAQ82B,EAAc92B,MAC3B+F,EAAK9F,MAAQ62B,EAAc72B,MAC3B8F,EAAK7F,MAAQ42B,EAAc52B,QAG7Bd,KAAKu3B,OAAOl2B,GAAG,aAAc,WAC3BsF,EAAK5F,QAAS,EACd4F,EAAKnI,EAAI,oDA/Df,CAAAF,IAAA,gBAAAN,MAAA,2KAoESgC,KAAKkB,iCACR,gBAAMlB,KAAKm3B,WAAWQ,iBACtB,gBAAM33B,KAAKm3B,WAAWtwB,eACtB7G,KAAKm3B,WAAWj2B,iBAAiB02B,UAC/B,SAAAC,GAAE,OAAI1wB,EAAKjG,iBAAmB22B,WAIlC73B,KAAK83B,+DA5ET,CAAAx5B,IAAA,eAAAN,MAAA,WA+EsB,IAAAoJ,EAAApH,KAClB,SAAS4W,EAAOrT,GACd,OAAO+E,KAAKC,IAAID,KAAKyP,IAAI,EAAGxU,GAAI,GAGlCvD,KAAK02B,eAAiB,GAClB12B,KAAK+3B,4BACP/3B,KAAK+3B,2BAA2BC,cAIlCh4B,KAAK+3B,2BAA8B/3B,KAAKm3B,WAAWc,mBAChDC,KACC1+B,OAAA2+B,EAAA,eAAA3+B,CAAY,IAAK,IAEjBA,OAAA2+B,EAAA,OAAA3+B,CAAK,SAAC4+B,GAAD,OACH5+B,OAAO4K,KAAKgzB,EAAA,gBAAa9zB,IAAK,SAACoE,GAC7B,MAAO,CACL2wB,KAAMjB,EAAA,eAAY1vB,GAClB4wB,MAAOF,EAAS90B,IACZ,SAACi1B,GACC,IAAIC,EAAcD,EAAQE,KAAM,SAAA56B,GAAC,OAAIA,EAAEw6B,KAAK/3B,IAAM82B,EAAA,eAAY1vB,GAAGpH,KACjE,OAAIk4B,EACKA,EAAYF,MAEZI,MAGXC,OACC,SAACC,EAAeC,GAAhB,OACCD,EAAiBC,GAChB,GACDT,EAAS/+B,YAKrBG,OAAA2+B,EAAA,OAAA3+B,CAAK,SAACs/B,GACJ,IAAIC,EAAoC,GAExC,OADAD,EAAKpb,QAAS,SAACsb,GAAD,OAASD,EAAMC,EAAIX,KAAK/3B,IAAM04B,EAAIV,QACzCS,KAETnB,UACA,SAACmB,GACMt0B,EAAAC,EAAEu0B,KAAKF,EAAO,SAAAx1B,GAAC,OAAIkB,EAAAC,EAAE0H,MAAM7I,OAEhC6D,EAAKsvB,eAAen9B,KAAKC,OAAO0/B,OAAOH,IACvC3xB,EAAKsvB,eAAiBjyB,EAAAC,EAAEy0B,UAAU/xB,EAAKsvB,eAAgB,KACvDtvB,EAAK5I,EAAI8J,KAAKyP,IAAiC,EAA7B3Q,EAAKsvB,eAAer9B,OAAY,KAE9C+N,EAAKwvB,WACPxvB,EAAK1G,MAAQkW,GACTmiB,EAAMjC,MAAQ1vB,EAAKyvB,YAAYC,MAAM,KAAS1vB,EAAKyvB,YAAYC,MAAM,GAAK1vB,EAAKyvB,YAAYC,MAAM,KAErG1vB,EAAKzG,MAAQiW,GACTmiB,EAAMhC,OAAS3vB,EAAKyvB,YAAYE,OAAO,KAAS3vB,EAAKyvB,YAAYE,OAAO,GAAK3vB,EAAKyvB,YAAYE,OAAO,KAEzG3vB,EAAKxG,MAAQgW,GACTmiB,EAAM/B,OAAS5vB,EAAKyvB,YAAYG,OAAO,KAAS5vB,EAAKyvB,YAAYG,OAAO,GAAK5vB,EAAKyvB,YAAYG,OAAO,KAEzG5vB,EAAKvG,MAAQ+V,GACTmiB,EAAM9B,OAAS7vB,EAAKyvB,YAAYI,OAAO,KAAS7vB,EAAKyvB,YAAYI,OAAO,GAAK7vB,EAAKyvB,YAAYI,OAAO,KAEzG7vB,EAAKtG,MAAQ8V,GACTmiB,EAAM7B,MAAQ9vB,EAAKyvB,YAAYK,MAAM,KAAS9vB,EAAKyvB,YAAYK,MAAM,GAAK9vB,EAAKyvB,YAAYK,MAAM,OAGrG9vB,EAAK1G,OACHq4B,EAAMjC,MAAQxuB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEw5B,YAE1DxuB,KAAKC,IAALvO,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEw5B,UAAWxuB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEw5B,WAErG1vB,EAAKtG,OACHi4B,EAAM7B,MAAQ5uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE45B,YAE1D5uB,KAAKC,IAALvO,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE45B,UAAW5uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE45B,WAErG9vB,EAAKzG,OACHo4B,EAAMhC,OAASzuB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEy5B,aAE3DzuB,KAAKC,IAALvO,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEy5B,WAAYzuB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAEy5B,YAEtG3vB,EAAKxG,OACHm4B,EAAM/B,OAAS1uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE05B,aAE3D1uB,KAAKC,IAALvO,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE05B,WAAY1uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE05B,YAEtG5vB,EAAKvG,OACHk4B,EAAM9B,OAAS3uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE25B,aAE3D3uB,KAAKC,IAALvO,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE25B,WAAY3uB,KAAKyP,IAAL/d,MAAAsO,KAAI9O,OAAA4/B,EAAA,KAAA5/B,CAAQ4N,EAAKsvB,eAAepzB,IAAK,SAAAhG,GAAC,OAAIA,EAAE25B,gBAK9Gj3B,KAAKo2B,mBAAoB,EACzBp2B,KAAKe,QAAS,IA/KlB,CAAAzC,IAAA,wBAAAN,MAAA,WAmLIgC,KAAKw2B,gBAAkB,GACvBx2B,KAAKy2B,gBAAiB,EACtBz2B,KAAKu2B,uBAAyBv2B,KAAKu2B,wBArLvC,CAAAj4B,IAAA,cAAAN,MAAA,WAyLQgC,KAAK+3B,4BACP/3B,KAAK+3B,2BAA2BC,cAElCh4B,KAAKo2B,mBAAoB,EACzBp2B,KAAKe,QAAS,EACdf,KAAKxB,EAAI,IA9Lb,CAAAF,IAAA,6BAAAN,MAAA,WAkMIgC,KAAKq2B,sBAAwBr2B,KAAKq2B,uBAlMtC,CAAA/3B,IAAA,SAAAN,MAAA,WAsMIe,OAAOs4B,SAASgC,WAtMpB,CAAA/6B,IAAA,iBAAAN,MAAA,WAyMwB,IAAAs7B,EAAAt5B,KAChB0yB,EAAS1yB,KAAK8L,IAAIytB,cAAc,UAC/B7G,GAELA,EAAO8G,OAAQ,SAAC91B,GACTA,IACLlK,OAAA2K,EAAA,UAAA3K,CAAOkK,EAAD,GAAAO,OAAUq1B,EAAK9C,iBAAmB,YAAlC,KAAAvyB,OAAiDF,OAAO01B,WAAxD,SACNH,EAAK7C,gBAAiB,EACtB6C,EAAK9C,gBAAkB,GAEvBv5B,WAAY,WACVq8B,EAAK/C,uBAAwB,GAC5B,UArNT,CAAAj4B,IAAA,gBAAAN,MAAA,WA2NIgC,KAAK05B,kBA3NTvD,EAAA,CAA0CvxB,EAAA,QAArBsxB,GAAYyD,GAAA,CAThCngC,OAAAoL,EAAA,aAAApL,CAAU,CACTogC,WAAY,CACVh3B,QAAAyC,EACA+D,gBACAgG,0BACA6lB,sBACA4E,gBAAAC,GAAAp1B,MAGiBwxB,IAAA,IAAA6D,GAAA,GCtYkXC,GAAA,GCQnYC,cAAYzgC,OAAA0L,EAAA,KAAA1L,CACdwgC,GACAx5B,EACAuB,GACF,EACA,KACA,WACA,OAIAk4B,GAAS90B,QAAAC,OAAA,mBACM,IAAA80B,GAAAD,wYCLME,GAArB,SAAAx3B,GAAA,SAAAy3B,IAAA,OAAA5gC,OAAAqJ,EAAA,KAAArJ,CAAAwG,KAAAo6B,GAAA5gC,OAAAsJ,EAAA,KAAAtJ,CAAAwG,KAAAxG,OAAAuJ,EAAA,KAAAvJ,CAAA4gC,GAAApgC,MAAAgG,KAAAgD,YAAA,OAAAxJ,OAAAyJ,EAAA,KAAAzJ,CAAA4gC,EAAAz3B,GAAAy3B,EAAA,CAAiCx1B,EAAA,QAAZu1B,GAAGE,GAAA,CALvB7gC,OAAAoL,EAAA,aAAApL,CAAU,CACTogC,WAAY,CACVzD,aAAA+D,OAGiBC,IAAA,IAAAG,GAAA,GCfuVC,GAAA,GCQxWC,cAAYhhC,OAAA0L,EAAA,KAAA1L,CACd+gC,GACAz6B,EACAS,GACF,EACA,KACA,KACA,OAIAi6B,GAASr1B,QAAAC,OAAA,UACM,IAAAq1B,GAAAD,wBCjBfE,EAAA,WAAIC,IAAIC,GAAA,MAEO,IAAAC,GAAA,IAAID,GAAA,KAAKE,MAAM,CAC5BC,MAAO,GAGPC,UAAW,GAGXC,QAAS,KCPXP,EAAA,WAAI1c,OAAOkd,eAAgB,EAE3B,IAAIR,EAAA,WAAI,CACNG,SACAxtB,OAAQ,SAACf,GAAD,OAAOA,EAAEmuB,OAChBU,OAAO,2CCVV,IAAAC,EAAA5gC,EAAA,QAAA6gC,EAAA7gC,EAAAgE,EAAA48B,GAAwiBC,EAAG","file":"js/index.3ddd2622.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-2d0e8bde\":\"9a9c3d16\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar head = document.getElementsByTagName('head')[0];\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\thead.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * A simple message bus. Facilitates uncoupled communication between\n * components of fieldplay.\n */\nvar eventify = require('ngraph.events');\n\nmodule.exports = eventify({});","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=style&index=0&id=9c0368c6&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=style&index=0&id=9c0368c6&scoped=true&lang=scss&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"muse-recorder-app\"}},[_c('MuseRecorder')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder\"},[_c('div',{staticClass:\"muse-recorder__viz-container\"},[_c('field-visualization',{attrs:{\"alpha\":_vm.alpha,\"beta1\":_vm.beta1,\"beta2\":_vm.beta2,\"beta3\":_vm.beta3,\"gamma\":_vm.gamma,\"n\":_vm.n,\"paused\":_vm.paused}})],1),(_vm.n == 0)?_c('div',{staticClass:\"muse-recorder__greeting\",class:{'muse-recorder__greeting--connected': _vm.connectionStatus && !_vm.paused}},[_vm._m(0),_c('div',{staticClass:\"muse-recorder__greeting-tuto\"},[_c('div',{staticClass:\"muse-recorder__greeting-tuto-intro\"},[_vm._v(\"\\n        Turn on the headband, adjust it on your forehead, wait 10s and observe...\\n      \")]),_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.connectToMuse()}}},[_vm._v(\"\\n        Start \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"play\"}})],1),_c('div',{staticClass:\"muse-recorder__greeting-tuto-outro\"},[_vm._v(\"\\n        When your finished or before passing the headband to someone else, hit STOP \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"stop\"}})],1),_c('hr'),_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.connectToRemoteController()}}},[_vm._v(\"\\n        Screen mode \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"play\"}})],1),_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.goToRemoteController()}}},[_vm._v(\"\\n        Tablet mode \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"play\"}})],1)])]):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder__greeting-title\"},[_c('div',{staticStyle:{\"font-size\":\"6em\"}},[_vm._v(\"Do you feel in control\")]),_c('div',{staticStyle:{\"font-size\":\"4em\"}},[_vm._v(\"of what's happenning\")]),_c('div',{staticStyle:{\"font-size\":\"8em\"}},[_vm._v(\"in your brain?\")])])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder__session\"},[_c('svg',{staticClass:\"session__chart\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},_vm._l((_vm.series),function(serie){return _c('path',{key:serie,class:['session__serie', 'session__serie--' + serie.toLowerCase()],attrs:{\"d\":_vm.lineForSerie(serie)}})})),_c('div',{staticClass:\"session__legend\"},_vm._l((_vm.series),function(serie){return _c('div',{key:serie,class:['session__legend__item', 'session__legend__item--' + serie.toLowerCase()]},[_c('div',{staticClass:\"session__legend__item__color\"}),_c('span',[_vm._v(_vm._s(serie))]),_vm._v(\" - \"),_c('span',[_vm._v(\" \"+_vm._s(_vm.lastSessionPointForSerie(serie))+\" \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport _ from 'lodash';\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { AveragedRelativeBandPowers } from './MuseRecorder.vue';\nimport { line } from 'd3-shape';\nimport { scaleLinear } from 'd3-scale';\nimport { saveAs } from 'file-saver';\n\n@Component\nexport default class Session extends Vue {\n  @Prop({ default: [] })\n  sessionData: AveragedRelativeBandPowers[];\n  \n  @Prop({ default: 800 })\n  width: number;\n\n  @Prop({ default: 500 })\n  height: number;\n\n  get series(): string[] {\n    return Object.keys(this.sessionData[0] || {});\n  }\n\n  get xScale() {\n    return scaleLinear()\n      .domain([0, this.sessionData.length - 1])\n      .range([0, this.width]);\n  }\n\n  get yScale() {\n    return scaleLinear()\n      .domain([0, 0.5])\n      .range([this.height, 0]);\n  }\n\n  get lastSessionPointForSerie () {\n    let lastSessionPoint = _.last(this.sessionData);\n    return (serie) => {\n      if ( lastSessionPoint && lastSessionPoint[serie] )\n        return lastSessionPoint[serie];\n      else\n        return '-';\n    }\n  }\n\n  private lineForSerie(serie: string): string | null {\n    return line()(this.sessionData.map(\n      (v, i) => [\n        this.xScale(i),\n        this.yScale(v[serie])\n      ] as [number, number]\n    ));\n  }\n\n  private saveAsJSON(): void {\n    let blob = new Blob(\n      [JSON.stringify(this.sessionData, null, 2)],\n      {type: \"application/json;charset=utf-8\"}\n    );\n    let exportDate = new Date();\n    let filename = `muse-session-${exportDate.toISOString()}.json` \n    saveAs(blob, filename);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Session.vue?vue&type=template&id=684ff5ac&scoped=true&\"\nimport script from \"./Session.vue?vue&type=script&lang=ts&\"\nexport * from \"./Session.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"684ff5ac\",\n  null\n  \n)\n\ncomponent.options.__file = \"Session.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"brain-visualization\",attrs:{\"height\":_vm.height,\"width\":_vm.width}},[_c('defs',[_c('filter',{attrs:{\"id\":\"goo\"}},[_c('feGaussianBlur',{attrs:{\"in\":\"SourceGraphic\",\"stdDeviation\":\"10\",\"result\":\"blur\"}}),_c('feColorMatrix',{attrs:{\"in\":\"blur\",\"mode\":\"matrix\",\"values\":\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -18\",\"result\":\"goo\"}}),_c('feComposite',{attrs:{\"in\":\"SourceGraphic\",\"in2\":\"goo\",\"operator\":\"atop\"}})],1)]),_c('g',{staticClass:\"brain-wires\"},_vm._l((_vm.brainWires(_vm.tk1, _vm.tk2)),function(wire,i){return _c('path',{key:i,staticClass:\"brain-wire\",attrs:{\"filter\":\"url(#goo)\",\"transform\":_vm.originTranslation,\"d\":wire,\"fill\":_vm.colors[i]}})}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport { line, lineRadial, arc, curveCardinal, curveNatural, curveMonotoneX, curveBasis } from 'd3-shape';\nimport { interpolateString, interpolateNumber, interpolate } from 'd3-interpolate';\nimport { easeCubicOut, easeCubicIn, easeCubic, easeCircle } from 'd3-ease';\n\n@Component\nexport default class Vizualisation extends Vue {\n  @Prop({ default: 1 })\n  k1: number;\n\n  @Prop({ default: 1 })\n  k2: number;\n\n  tk1: number = this.k1;\n  tk2: number = this.k2;\n\n  colors = ['#00f', '#0f0', '#f00'];\n  // colors = ['cyan', 'magenta', 'yellow'];\n\n  @Watch('k1')\n  animateK1 (targetVal: number) {\n    let duration = 1000;\n    let start = Date.now();\n    let interpolator = interpolateNumber(this.tk1 as number, targetVal);\n    let animate = () => {\n      let t = (Date.now() - start) / duration;\n      if (t >= 1) {\n        this.tk1 = targetVal;\n      } else {\n        requestAnimationFrame(animate);\n        this.tk1 = interpolator(t);\n      }\n    }\n    animate();\n  }\n\n  @Watch('k2')\n  animateK2 (targetVal: number) {\n    let duration = 1000;\n    let start = Date.now();\n    let interpolator = interpolateNumber(this.tk2 as number, targetVal);\n    let animate = () => {\n      let t = (Date.now() - start) / duration;\n      if (t >= 1) {\n        this.tk2 = targetVal;\n      } else {\n        requestAnimationFrame(animate);\n        this.tk2 = interpolator(t);\n      }\n    }\n    animate();\n  }\n\n  @Prop({ default: 800 })\n  height: number;\n\n  @Prop({ default: 800 })\n  width: number;\n\n  get originTranslation () {\n    return `translate(${this.width / 2}, ${this.height})`;\n  }\n\n  brainWires (k1: number, k2: number) {\n    return [-1/2, 0, 1/2].map(y => this.brainWire(k1, k2, y))\n  }\n\n  brainWire (k1: number, k2: number, y: number) {\n    let curve = line().curve(\n      curveCardinal.tension(y)\n    );\n\n    return curve(this.wirePoints(k1, k2, y));\n  }\n\n  wirePoints (k1: number, k2: number, y: number) {\n    let k = k1 + easeCircle(y) * (k2 - k1);\n\n    let masterPoints = [\n      this.leftPoint(k, y),\n      this.leftMiddlePoint(k, y),\n      this.middlePoint(k, y),\n      this.rightMiddlePoint(k, y),\n      this.rightPoint(k, y),\n    ]\n\n    let wireWidth = 100;\n\n    let points = masterPoints.map(\n      (p): [number, number] => [p[0], p[1] + wireWidth / 2]\n    ).concat(\n      masterPoints.reverse().map(\n        (p): [number, number] => [p[0], - p[1] - wireWidth / 2]\n      )\n    );\n\n    points.push(points[0]);\n\n    return points.map(this.verticalTranslation(- this.width / 2 - (1 - Math.max(k1, k2)) * 2 * y * this.radius));\n  }\n\n  get radius () {\n    return Math.sqrt(\n      Math.pow((this.width / 2), 2) + Math.pow((this.height / 2), 2)\n    ) / 2;\n  }\n\n  leftPoint (k: number, y: number): [number, number] {\n    return [\n      interpolateNumber(- this.width / 2, - this.radius)(easeCubicIn(k))\n    ,\n      interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  leftMiddlePoint (k: number, y: number): [number, number] {\n    let circleOrSquareRatio = interpolateNumber(Math.SQRT2 / 2, 1);\n\n    return [\n      interpolateNumber(- this.width / 4, - this.radius * circleOrSquareRatio(y))(easeCubicIn(k))\n    ,\n      interpolateNumber(0, - this.radius * circleOrSquareRatio(y))(easeCubic(k)) + interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  middlePoint (k: number, y: number): [number, number] {\n    return [\n      0\n    ,\n      interpolateNumber(0, - this.radius)(easeCubicOut(k)) + interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  rightMiddlePoint (k: number, y: number): [number, number] {\n    return this.verticalSymetry(this.leftMiddlePoint(k, y));\n  }\n\n  rightPoint (k: number, y: number): [number, number] {\n    return this.verticalSymetry(this.leftPoint(k, y));\n  }\n\n  verticalSymetry (point: [number, number]): [number, number] {\n    return [\n      -point[0], point[1]\n    ]\n  }\n\n  horizontalSymetry (point: [number, number]): [number, number] {\n    return [\n      point[0], -point[1]\n    ]\n  }\n\n  verticalTranslation (dy: number) {\n    return function(point: [number, number]): [number, number] {\n      return [\n        point[0], dy + point[1]\n      ]\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Visualization.vue?vue&type=template&id=888b4562&scoped=true&\"\nimport script from \"./Visualization.vue?vue&type=script&lang=ts&\"\nexport * from \"./Visualization.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"888b4562\",\n  null\n  \n)\n\ncomponent.options.__file = \"Visualization.vue\"\nexport default component.exports","\nimport _ from 'lodash';\nimport { CreateElement, VNode } from 'vue';\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport {\n  Scene, Camera,\n  WebGLRenderer, PerspectiveCamera\n} from 'three';\n\nimport * as THREE from 'three';\n\nconst CAMERA_DISTANCE = 200;\nconst BOUNDS = {\n  X: CAMERA_DISTANCE * 2,\n  Y: CAMERA_DISTANCE * 2\n};\n\nconst CIRCLE_RADIUS = CAMERA_DISTANCE * Math.SQRT2;\nconst SQUARE_SIZE = CAMERA_DISTANCE;\nconst SQUARE_RADIUS = SQUARE_SIZE / 2;\n\nconst POINTS_COUNT = 1000\nconst POINTS_RENEWAL_CHANCE = 0.001;\n\n@Component\nexport default class ParticlesVizualisation extends Vue {\n  private scene: Scene;\n  private renderer: WebGLRenderer;\n  private camera: Camera;\n  private geometry: THREE.Geometry;\n  private points: THREE.Points;\n  private lastAnimationId: number | undefined;\n\n  @Prop({ required: true })\n  public k1: number;\n\n  @Prop({ required: true })\n  public k2: number;\n\n  @Prop({ default: false })\n  public paused: boolean;\n\n  created () {\n    this.scene = new Scene();\n\n    this.renderer = new WebGLRenderer({\n      preserveDrawingBuffer: true\n    });\n    this.renderer.autoClearColor = false;\n\n    this.camera = new PerspectiveCamera( 120, window.innerWidth / window.innerHeight, 0.1, 1000 );\n\n    // TRAIL EFFECT\n    // Create a semi-transparent plane\n    let fadeMaterial = new THREE.MeshBasicMaterial({\n      color: 0x000000,\n      transparent: true,\n      opacity: 0.04,\n      depthWrite: false\n    });\n    let fadePlane = new THREE.PlaneBufferGeometry(1, 1);\n    let fadeMesh = new THREE.Mesh(fadePlane, fadeMaterial);\n\n    // Group the plane and the camera in cameraGroup\n    let cameraGroup = new THREE.Object3D();\n    cameraGroup.add(this.camera);\n    cameraGroup.add(fadeMesh);\n    cameraGroup.translateZ(CAMERA_DISTANCE);\n\n    // Place the plane in front of the camera\n    fadeMesh.position.z = -0.1;\n\n    //Render the Make plane before points\n    fadeMesh.renderOrder = -1;\n\n    this.scene.add(cameraGroup);\n\n    // POINTS\n    let material = new THREE.PointsMaterial({\n      size: 2,\n      vertexColors: THREE.VertexColors,\n      opacity: 0.6,\n      transparent: true,\n      map: this.createCanvasMaterial('white', 64),\n      depthWrite: false\n    });\n    this.geometry = new THREE.Geometry();\n\n    _.times(POINTS_COUNT, this.addRandomPoint);\n    this.points = new THREE.Points(this.geometry, material);\n\n    this.scene.add(this.points);\n  }\n\n  randomPositionOnPlane () {\n    return new THREE.Vector3(\n      2 * (Math.random() - 0.5) * BOUNDS.X,\n      2 * (Math.random() - 0.5) * BOUNDS.Y,\n      0\n    )\n  }\n\n  addRandomPoint () {\n    this.geometry.vertices.push(this.randomPositionOnPlane());\n\n    this.geometry.colors.push(new THREE.Color(\n      Math.random(), Math.random(), Math.random()\n    ));\n  }\n\n  mounted () {\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.animate();\n    this.$el.appendChild(this.renderer.domElement);\n  }\n\n  get horizontalWeigth () {\n    return 1 - Math.max(this.k1, this.k2);\n  }\n\n  get circleWeigth () {\n    if ((this.k1 + this.k2) === 0)\n      return 0\n    return this.k1;\n  }\n\n  get squareWeigth () {\n    if ((this.k1 + this.k2) === 0)\n      return 0\n    return this.k2;\n  }\n\n  animate () {\n    // Re-randomly position some of the points\n    this.geometry.vertices.map((vertice) => {\n      if (Math.random() <= POINTS_RENEWAL_CHANCE) {\n        let v = this.randomPositionOnPlane();\n        vertice.set(v.x, v.y, v.z);\n        this.geometry.verticesNeedUpdate = true;\n      }\n    });\n\n    // Move points\n    if ( !_.isNaN(this.k1) && !_.isNaN(this.k2) ) {\n      this.geometry.vertices.map( (particle) => {\n        let h = this.horizontalMovement(particle);\n        let c = this.circularMovement(particle);\n        let s = this.squareMovement(particle);\n\n        let weightedMovementAlongAxis = (h: number, c: number, s: number): number =>\n          this.circleWeigth * c + this.squareWeigth * s + this.horizontalWeigth * h\n\n        let movement: [number, number] = [\n          weightedMovementAlongAxis(h[0], c[0], s[0]),\n          weightedMovementAlongAxis(h[1], c[1], s[1])\n        ]\n        this.moveParticle(\n          particle, movement\n        );\n      });\n\n      this.geometry.verticesNeedUpdate = true;\n    }\n\n    this.geometry.colors.map( (particleColor) => {\n      let dX, dY, dZ;\n      dX = (Math.random() - .5 ) / 5;\n      dY = (Math.random() - .5 ) / 5;\n      dZ = (Math.random() - .5 ) / 5;\n\n      particleColor.add(new THREE.Color(dX, dY, dZ));\n    });\n    this.geometry.colorsNeedUpdate = true;\n\n    this.renderer.render(this.scene, this.camera);\n    this.continue()\n  }\n\n  createCanvasMaterial (color: string, size: number): THREE.Texture {\n    let matCanvas = document.createElement('canvas');\n    matCanvas.width = matCanvas.height = size;\n    let matContext = matCanvas.getContext('2d');\n    let texture = new THREE.Texture(matCanvas);\n    if (!matContext)\n      return new THREE.Texture();\n\n    // Circle\n    let center = size / 2;\n    matContext.beginPath();\n    matContext.arc(center, center, center, 0, 2 * Math.PI);\n    matContext.closePath();\n    matContext.fillStyle = color;\n    matContext.fill();\n\n    texture.needsUpdate = true;\n    return texture;\n  }\n\n  moveParticle (particle: THREE.Vertex, movement: [number, number]) {\n    particle.x += movement[0];\n    particle.y += movement[1];\n\n    if (particle.x > BOUNDS.X)\n      particle.x = -1 * BOUNDS.X;\n    if (particle.x < -1 * BOUNDS.X)\n      particle.x = BOUNDS.X;\n    if (particle.y > BOUNDS.Y)\n      particle.y = -1 * BOUNDS.Y;\n    if (particle.y < -1 * BOUNDS.Y)\n      particle.y = BOUNDS.Y;\n  }\n\n  horizontalMovement (particle: THREE.Vertex): [number, number] {\n    return [\n      1,\n      Math.sin(particle.x / 16 / Math.PI) / 2\n    ];\n  }\n\n  circularMovement (particle: THREE.Vertex): [number, number] {\n    let r = Math.pow( Math.pow(particle.x, 2) + Math.pow(particle.y, 2) , .5);\n    let θ = Math.atan2(particle.y, particle.x);\n\n    // Movement towards the circle\n    let dr = (CIRCLE_RADIUS - r) / 250; // 250 frames to match the circle\n    // Movement along the circle\n    let dθ = 2 * Math.PI / 2000; // 1000 frames to complete the circle\n\n    return [\n      dr * Math.cos(θ) - r * Math.sin(θ) * dθ,\n      dr * Math.cos(θ) + r * Math.cos(θ) * dθ\n    ];\n  }\n\n  squareMovement (particle: THREE.Vertex) {\n    let x = particle.x;\n    let y = particle.y;\n\n    let dx: number;\n    let dy: number;\n    let r: number;\n    let dr = (x: number, y: number, r: number): [number, number] => [0, 0]\n\n    if (x >= 0) {\n      dy = 1;\n      if (y >= 0) {\n        r = y / (1 - x); \n        dx = -1;\n      } else { // y < 0\n        r = y / (x - 1); \n        dx = 1;\n      }\n    } else { // x < 0\n      dy = -1;\n      if (y > 0) {\n        r = y / (x + 1); \n        dx = -1;\n      } else { // y < 0\n        r = y / (-1 - x); \n        dx = 1;\n      }\n    }\n\n    // let dr = (SQUARE_SIZE - r) / 1000;\n\n    return [dx, dy];\n  }\n\n  continue () {\n    if (!this.paused)\n      this.lastAnimationId = window.requestAnimationFrame(this.animate);\n  }\n\n  pause () {\n    if (this.lastAnimationId)\n      window.cancelAnimationFrame(this.lastAnimationId);\n    this.lastAnimationId = undefined;\n  }\n\n  @Watch('paused')\n  onPausedChanged () {\n    this.paused ? this.pause() : this.continue()\n  }\n\n  render (h: CreateElement): VNode {\n    return h('div', { class: 'brain-particles' });\n  }\n\n  destroyed () {\n    this.pause();\n    this.renderer.dispose();\n    this.geometry.dispose();\n  }\n}\n","var render, staticRenderFns\nimport script from \"./ParticlesVisualization.vue?vue&type=script&lang=ts&\"\nexport * from \"./ParticlesVisualization.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f884374\",\n  null\n  \n)\n\ncomponent.options.__file = \"ParticlesVisualization.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=script&lang=ts&\"","/**\n * This file is based on https://github.com/mapbox/webgl-wind\n * by Vladimir Agafonkin\n * \n * Released under ISC License, Copyright (c) 2016, Mapbox\n * https://github.com/mapbox/webgl-wind/blob/master/LICENSE\n * \n * Adapted to field maps by Andrei Kashcha\n * Copyright (C) 2017\n */\nexport default {\n  createTexture: createTexture,\n  bindFramebuffer: bindFramebuffer,\n  createProgram: createProgram, \n  createBuffer: createBuffer,\n  bindAttribute: bindAttribute,\n  bindTexture: bindTexture\n}\n\nfunction bindTexture(gl, texture, unit) {\n  gl.activeTexture(gl.TEXTURE0 + unit);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n}\n\nfunction createBuffer(gl, data) {\n  var buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n  return buffer;\n}\n\nfunction createTexture(gl, filter, data, width, height) {\n  var texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n  if (data instanceof Uint8Array) {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n  } else {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n  }\n  gl.bindTexture(gl.TEXTURE_2D, null);\n  return texture;\n}\n\nfunction bindFramebuffer(gl, framebuffer, texture) {\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n  if (texture) {\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n  }\n}\n\nfunction bindAttribute(gl, buffer, attribute, numComponents) {\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.enableVertexAttribArray(attribute);\n  gl.vertexAttribPointer(attribute, numComponents, gl.FLOAT, false, 0, 0);\n}\n\nfunction createProgram(gl, vertexSource, fragmentSource) {\n  var program = gl.createProgram();\n\n  var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexSource);\n  var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentSource);\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      throw new Error(gl.getProgramInfoLog(program));\n  }\n\n  var wrapper = {\n    program: program,\n    unload: unload\n  };\n\n  var numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n  var i;\n  for (i = 0; i < numAttributes; i++) {\n      var attribute = gl.getActiveAttrib(program, i);\n      wrapper[attribute.name] = gl.getAttribLocation(program, attribute.name);\n  }\n  var numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  for (i = 0; i < numUniforms; i++) {\n      var uniform = gl.getActiveUniform(program, i);\n      wrapper[uniform.name] = gl.getUniformLocation(program, uniform.name);\n  }\n\n  return wrapper; \n\n  function unload() {\n    gl.deleteProgram(program);\n  }\n}\n\nfunction createShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new Error(gl.getShaderInfoLog(shader));\n  }\n\n  return shader;\n}","/**\n * Various color modes.\n */\nexport default {\n  /**\n   * Each particle gets its own color\n   */\n  UNIFORM: 1,\n\n  /**\n   * Color of a particle depends on its velocity\n   */\n  VELOCITY: 2,\n\n  /**\n   * Color of a particle depends on its velocity vector angle.\n   */\n  ANGLE: 3,\n\n  /**\n   * The color comes from a shader. WIP\n   */\n  CUSTOM: 4\n}","/**\n * Wraps a simple vector field string into our default shader code.\n * @param {String} field \n */\nexport default function wrapVectorField(field) {\n  return `// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  ${field}\n\n  return v;\n}`\n}","/**\n * Checks whether current window belongs to a \"Small\" screen\n * size. Small screens have slightly different initial behavior.\n * E.g. the settings window is always collapsed.\n * \n * This needs to be in sync with `small-screen` variable in\n *  ../commponents/shared.styl\n */\nexport default function isSmallScreen() {\n  return window.innerWidth < 600\n}\n","import queryState from 'query-state';\nimport bus from './bus';\nimport ColorModes from './programs/colorModes';\nimport wrapVectorField from './wrapVectorField';\nimport isSmallScreen from './isSmallScreen';\n\n/**\n * The state of the fieldplay is stored in the query string. This is the\n * only place where query string can be manipulated or fetched.\n */\n\nvar qs = queryState({}, {\n  useSearch: true,\n  // Older version of the app used hash to store application arguments.\n  // Turns out hash is not good for websites like reddit. They can block\n  // url, saying \"url was already submitted\" if the only part that is different\n  // is hash. So, we switch to search string, and maintain backward compatibility\n  // for fields created before.\n  rewriteHashToSearch: true\n});\n\nvar currentState = {}; //qs.get();\n\nvar defaultVectorField = wrapVectorField(`v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;`);\n\nvar pendingSave;\nvar defaults = {\n  timeStep: 0.01,\n  dropProbability: 0.009,\n  particleCount: 10000,\n  fadeout: .998,\n  colorMode: ColorModes.UNIFORM\n}\n\nlet settingsPanel = {\n  collapsed: isSmallScreen(),\n};\n\nexport default {\n  settingsPanel,\n  saveBBox,\n  getBBox,\n  makeBBox,\n  getQS() { return qs; },\n  saveCode,\n  getCode,\n  getDefaultCode,\n\n  getDropProbability,\n  setDropProbability,\n\n  getIntegrationTimeStep,\n  setIntegrationTimeStep,\n\n  getParticleCount,\n  setParticleCount,\n\n  getFadeout,\n  setFadeout,\n\n  getColorMode,\n  setColorMode,\n\n  getColorFunction,\n  setColorFunction\n}\n\nqs.onChange(function() {\n  bus.fire('scene-ready', window.scene);\n});\n\nfunction getColorMode() {\n  let colorMode = qs.get('cm');\n  return defined(colorMode) ? colorMode : defaults.colorMode;\n}\n\nfunction setColorMode(colorMode) {\n  if (!defined(colorMode)) return;\n  // qs.set({cm: colorMode});\n  currentState.cm = colorMode;\n}\n\nfunction getColorFunction() {\n  let colorFunction = qs.get('cf');\n  return colorFunction || '';\n}\n\nfunction setColorFunction(colorFunction) {\n  // qs.set({cf: colorFunction});\n  currentState.cf = colorFunction;\n}\n\nfunction getFadeout() {\n  let fadeout = qs.get('fo');\n  return defined(fadeout) ? fadeout : defaults.fadeout;\n}\n\nfunction setFadeout(fadeout) {\n  if (!defined(fadeout)) return;\n  // qs.set({fo: fadeout});\n  currentState.fo = fadeout;\n}\n\nfunction getParticleCount() {\n  let particleCount = qs.get('pc');\n  return defined(particleCount) ? particleCount : defaults.particleCount;\n}\n\nfunction setParticleCount(particleCount) {\n  if (!defined(particleCount)) return;\n  // qs.set({pc: particleCount});\n  currentState.pc = particleCount;\n}\n\nfunction getIntegrationTimeStep() {\n  let timeStep = qs.get('dt');\n  return defined(timeStep) ? timeStep : defaults.timeStep;\n}\n\nfunction setIntegrationTimeStep(dt) {\n  if (!defined(dt)) return;\n  // qs.set({dt: dt})\n  currentState.dt = dt;\n}\n\nfunction getDropProbability() {\n  let dropProbability = qs.get('dp');\n  return defined(dropProbability) ? dropProbability : defaults.dropProbability;\n}\n\nfunction setDropProbability(dropProbability) {\n  if (!defined(dropProbability)) return;\n  clamp(dropProbability, 0, 1);\n  // qs.set({dp: dropProbability})\n}\n\nfunction getBBox() {\n  let cx = qs.get('cx');\n  let cy = qs.get('cy');\n  let w = qs.get('w');\n  let h = qs.get('h');\n  return makeBBox(cx, cy, w, h);\n}\n\nfunction makeBBox(cx, cy, w, h) {\n  let bboxDefined = defined(cx) && defined(cy) && defined(w) && defined(h);\n  if (!bboxDefined) return;\n\n  let w2 = w/2;\n  let h2 = h/2;\n  var p = 10000;\n  return {\n    minX: Math.round(p * (cx - w2))/p,\n    maxX: Math.round(p * (cx + w2))/p,\n    minY: Math.round(p * (cy - h2))/p,\n    maxY: Math.round(p * (cy + h2))/p\n  };\n}\n\nfunction saveBBox(bbox, immediate = false) {\n  bbox = {\n    cx: (bbox.minX + bbox.maxX) * 0.5,\n    cy: (bbox.minY + bbox.maxY) * 0.5,\n    w: (bbox.maxX - bbox.minX),\n    h: (bbox.maxX - bbox.minX)\n  }\n\n  if (bbox.w <= 0 || bbox.h <= 0) return;\n\n  currentState.cx = bbox.cx;\n  currentState.cy = bbox.cy;\n  currentState.w = bbox.w;\n  currentState.h = bbox.h;\n\n  if(pendingSave) {\n    clearTimeout(pendingSave);\n    pendingSave = 0;\n  }\n\n  // if (immediate) qs.set(bbox);\n  else {\n    pendingSave = setTimeout(() => {\n      pendingSave = 0;\n      // qs.set(bbox);\n    }, 300);\n  }\n}\n\nfunction getCode() {\n  var vfCode = qs.get('vf');\n  if (vfCode) return vfCode;\n\n  // If we didn't get code yet, let's try read to read it from previous version\n  // of the API.\n  // TODO: Need to figure out how to develop this in backward/future compatible way.\n  var oldCode = qs.get('code');\n  if (oldCode) {\n    vfCode = wrapVectorField(oldCode);\n    // side effect - let's clean the old URL\n    delete(currentState.code);\n    // qs.set('vf', vfCode);\n    return vfCode;\n  }\n\n  return defaultVectorField;\n}\n\nfunction getDefaultCode() {\n  return defaultVectorField;\n}\n\nfunction saveCode(code) {\n  // qs.set({\n  //   vf: code\n  // });\n  currentState.code = code;\n}\n\nfunction defined(number) {\n  return Number.isFinite(number);\n}\n\nfunction clamp(x, min, max) {\n  return x < min ? min :\n        (x > max) ? max : x;\n}\n","/**\n * Renders computed state onto the screen.\n */\nimport glUtils from '../gl-utils';\n\nconst NO_TRANSFORM = {dx: 0, dy: 0, scale: 1};\n\nexport default function makeScreenProgram(ctx) {\n  var {gl, canvasRect} = ctx;\n\n  var screenTexture, backgroundTexture;\n  var boundBoxTextureTransform = {dx: 0, dy: 0, scale: 1};\n  var lastRenderedBoundingBox = null;\n\n  updateScreenTextures();\n  var screenProgram = glUtils.createProgram(gl, getScreenVertexShader(), getScreenFragmentShader());\n  \n  var api = {\n    fadeOutLastFrame,\n    renderCurrentScreen,\n    updateScreenTextures,\n\n    boundingBoxUpdated: false\n  };\n\n  return api;\n  \n  function fadeOutLastFrame() {\n    // render to the frame buffer\n    glUtils.bindFramebuffer(gl, ctx.framebuffer, screenTexture);\n    gl.viewport(0, 0, canvasRect.width, canvasRect.height);\n\n    if (api.boundingBoxUpdated && lastRenderedBoundingBox) {\n      // We move the back texture, relative to the bounding box change. This eliminates\n      // particle train artifacts, though, not all of them: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n      // If you know how to improve this - please let me know.\n      boundBoxTextureTransform.dx = -(ctx.bbox.minX - lastRenderedBoundingBox.minX)/(ctx.bbox.maxX - ctx.bbox.minX);\n      boundBoxTextureTransform.dy = -(ctx.bbox.minY - lastRenderedBoundingBox.minY)/(ctx.bbox.maxY - ctx.bbox.minY);\n      boundBoxTextureTransform.scale = (ctx.bbox.maxX - ctx.bbox.minX) / (lastRenderedBoundingBox.maxX - lastRenderedBoundingBox.minX);\n      drawTexture(backgroundTexture, ctx.fadeOpacity, boundBoxTextureTransform);\n    } else {\n      drawTexture(backgroundTexture, ctx.fadeOpacity, NO_TRANSFORM)\n    }\n  }\n\n  function renderCurrentScreen() {\n    glUtils.bindFramebuffer(gl, null);\n\n    saveLastBbox();\n\n    gl.enable(gl.BLEND); \n    gl.blendFunc(gl.SRC_ALPHA, gl.DST_ALPHA);\n    gl.clearColor(ctx.backgroundColor.r, ctx.backgroundColor.g, ctx.backgroundColor.b, ctx.backgroundColor.a);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    drawTexture(screenTexture, 1.0, NO_TRANSFORM);\n    gl.disable(gl.BLEND);\n\n    var temp = backgroundTexture;\n    backgroundTexture = screenTexture;\n    screenTexture = temp;\n\n    api.boundingBoxUpdated = false;\n    if (window.audioTexture) {\n      drawTexture(window.audioTexture, 1.0, NO_TRANSFORM);\n    }\n  }\n\n  function updateScreenTextures() {\n    var {width, height} = canvasRect;\n    var emptyPixels = new Uint8Array(width * height * 4);\n    if (screenTexture) {\n      gl.deleteTexture(screenTexture);\n    }\n    if (backgroundTexture) {\n      gl.deleteTexture(backgroundTexture);\n    }\n\n    screenTexture = glUtils.createTexture(gl, gl.NEAREST, emptyPixels, width, height);\n    backgroundTexture = glUtils.createTexture(gl, gl.NEAREST, emptyPixels, width, height);\n  }\n\n  function saveLastBbox() {\n    if (!lastRenderedBoundingBox) {\n      lastRenderedBoundingBox = {\n        minX: ctx.bbox.minX,\n        minY: ctx.bbox.minY,\n        maxX: ctx.bbox.maxX,\n        maxY: ctx.bbox.maxY\n      }\n\n      return;\n    } \n\n    lastRenderedBoundingBox.minX = ctx.bbox.minX;\n    lastRenderedBoundingBox.minY = ctx.bbox.minY;\n    lastRenderedBoundingBox.maxX = ctx.bbox.maxX;\n    lastRenderedBoundingBox.maxY = ctx.bbox.maxY;\n  }\n\n  function drawTexture(texture, opacity, textureTransform) {\n    var program = screenProgram;\n    gl.useProgram(program.program);\n    glUtils.bindAttribute(gl, ctx.quadBuffer, program.a_pos, 2);\n\n    // TODO: This index is very fragile. I need to find a way\n    glUtils.bindTexture(gl, texture, ctx.screenTextureUnit);\n    gl.uniform1i(program.u_screen, ctx.screenTextureUnit);\n\n    gl.uniform1f(program.u_opacity_border, 0.02);\n    gl.uniform1f(program.u_opacity, opacity);\n    gl.uniform3f(program.u_transform, textureTransform.dx, textureTransform.dy, textureTransform.scale);\n\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n}\n\nfunction getScreenVertexShader() {\n  return `// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}`\n}\n\nfunction getScreenFragmentShader() {\n  return `precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n}`\n}","/**\n * A shader function to decode rgba encoded color into float position.\n */\nconst code = `\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n`\n\nexport default code;","export default class BaseShaderNode {\n  constructor() { }\n  getDefines() { return ''; }\n  getFunctions() { return ''; }\n  getMainBody() { return ''; }\n}\n","//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvar code = `\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n`\n\nexport default code;","export function getInputUniforms() {\n  return `uniform sampler2D input0;\nuniform sampler2D input1;`;\n}","import BaseShaderNode from './BaseShaderNode';\nimport snoise from './parts/simplex-noise';\nimport {getInputUniforms} from './customInput';\n\nexport default class UserDefinedVelocityFunction extends BaseShaderNode {\n  constructor(updateCode) {\n    super();\n    this.updateCode = updateCode || '';\n  }\n\n  setNewUpdateCode(newUpdateCode) {\n    this.updateCode = newUpdateCode;\n  }\n\n  getDefines() {\n    return `\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\nuniform float u_k1;\nuniform float u_k2;\nuniform float u_k3;\nuniform float u_k4;\nuniform float u_k5;\n\n#define PI 3.1415926535897932384626433832795\n\n${getInputUniforms()}\n`\n  }\n\n  getFunctions() {\n  // TODO: Do I need to worry about \"glsl injection\" (i.e. is there potential for security attack?)\n  // TODO: Do I need to inject snoise only when it's used?\n    return `\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n${snoise}\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n${this.updateCode ? this.updateCode : 'vec2 get_velocity(vec2 p) { return vec2(0.); }'}\n  `\n  }\n}\n","import BaseShaderNode from './BaseShaderNode';\n\nexport default class RungeKuttaIntegrator extends BaseShaderNode {\n  constructor () {\n    super();\n  }\n\n  getDefines() {\n    return `\nuniform float u_h;\n`\n  }\n\n  getFunctions() {\n    return `\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}`\n  }\n\n  getMainBody() {\n    return `\n  vec2 velocity = rk4(pos);\n`\n  }\n}","import UserDefinedVelocityFunction from './UserDefinedVelocityFunction';\nimport RungeKuttaIntegrator from './RungeKuttaIntegrator';\nimport ColorModes from '../programs/colorModes';\n\nexport default function shaderBasedColor(colorMode, vfCode, colorCode) {\n  var udf = new UserDefinedVelocityFunction(vfCode);\n  var integrate = new RungeKuttaIntegrator();\n\n  return {\n    getVariables,\n    getMain,\n    getMethods\n  }\n\n  function getVariables() {\n    return `\nuniform vec2 u_velocity_range;\nuniform float u_k;\nvarying vec4 v_particle_color;\n\n${udf.getDefines()}\n${integrate.getDefines()}\n`\n  }\n\n  function getMethods() {\n    return `\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n${udf.getFunctions()}\n${integrate.getFunctions()}\n${getColorFunctionBody()}\n`\n  }\n\n  function getColorFunctionBody() {\n    if (colorMode === ColorModes.UNIFORM) {\n      return `\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n`\n    }\n    if (colorMode === ColorModes.VELOCITY) {\n      return colorCode || `\n        vec4 get_color(vec2 p) {\n          vec2 velocity = get_velocity(p);\n          float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n          float hue = 0.05 + (1. - speed) * 0.5;\n          return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n        }\n      `;\n    }\n\n    if (colorMode === ColorModes.CUSTOM) {\n      if (!colorCode) throw new Error('color mode is set to custom, but no color function is specified');\n      return colorCode;\n    }\n\n    return ` \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n`;\n  }\n\n  function getMain() {\n    return `  v_particle_color = get_color(v_particle_pos);`\n  }\n}\n","import decodeFloatRGBA from './parts/decodeFloatRGBA';\nimport shaderBasedColor from './shaderBasedColor';\n\n// TODO: this duplicates code from texture position.\nexport default class DrawParticleGraph {\n  constructor(ctx) {\n    this.colorMode = ctx.colorMode;\n    this.colorFunction = ctx.colorFunction || '';\n  }\n\n  getFragmentShader() {\n    return `precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}`\n  }\n\n  getVertexShader(vfCode) {\n    let decodePositions = textureBasedPosition();\n    let colorParts = shaderBasedColor(this.colorMode, vfCode, this.colorFunction);\n    let methods = []\n    addMethods(decodePositions, methods);\n    addMethods(colorParts, methods);\n    let main = [];\n    addMain(decodePositions, main);\n    addMain(colorParts, main);\n\n    return `precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n${decodePositions.getVariables() || ''}\n${colorParts.getVariables()}\n\n${decodeFloatRGBA}\n\n${methods.join('\\n')}\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n${main.join('\\n')}\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}`\n  }\n}\n\nfunction addMethods(producer, array) {\n  if (producer.getMethods) {\n    array.push(producer.getMethods());\n  }\n}\n\nfunction addMain(producer, array) {\n  if (producer.getMain) {\n    array.push(producer.getMain());\n  }\n}\n\nfunction textureBasedPosition() {\n  return {\n    getVariables,\n    getMain\n  }\n\n  function getVariables() {\n    return `\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    `\n  }\n\n  function getMain() {\n    return `\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n`\n  }\n}","const code = `\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n`\n\nexport default code;","import BaseShaderNode from './BaseShaderNode';\nimport encodeFloatRGBA from './parts/encodeFloatRGBA';\nimport decodeFloatRGBA from './parts/decodeFloatRGBA';\n\n/**\n * Reads/writes particle coordinates from/to a texture;\n */\nexport default class TexturePosition extends BaseShaderNode {\n  constructor(isDecode) {\n    super();\n\n    // When it's decoding, it must read from the texture.\n    // Otherwise it must write to the texture;\n    this.isDecode = isDecode;\n  }\n\n  getFunctions() {\n    if (this.isDecode) {\n      return `\n    ${encodeFloatRGBA}\n    ${decodeFloatRGBA}\n`\n    }\n  }\n\n  getDefines() {\n    if (this.isDecode) {\n      // TODO: How to avoid duplication and silly checks?\n    return `\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n`;\n    }\n  }\n\n  getMainBody() {\n  if (this.isDecode) {\n    return `\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n`\n    }\n    return `\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n`\n  }\n}","\nexport default function renderNodes(nodes) {\n  let code = [] \n\n  nodes.forEach(node => { if (node.getDefines) addToCode(node.getDefines()); });\n  nodes.forEach(node => { if (node.getFunctions) addToCode(node.getFunctions()); });\n\n  addToCode('void main() {')\n    nodes.forEach(node => { if (node.getMainBody) addToCode(node.getMainBody()); });\n  addToCode('}')\n  return code.join('\\n');\n\n  function addToCode(line) {\n    if (line) code.push(line)\n  }\n}\n","import BaseShaderNode from './BaseShaderNode';\n\nexport default class PanzoomTransform extends BaseShaderNode {\n  constructor(config) {\n    super();\n    // decode is used when we move particle read from the texture\n    // otherwise we write particle to texture and need to reverse transform\n    this.decode = config && config.decode;\n    this.srcPosName = (config && config.posName) || 'pos';\n  }\n\n  getDefines() {\n    if (this.decode) {\n      // TODO: Need to figure out how to not duplicate this.\n    return `\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n`;\n    }\n  }\n\n  getMainBody() {\n    if (this.decode) {\n      return `\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = ${this.srcPosName}.x * du.x + u_min.x;\n  pos.y = ${this.srcPosName}.y * du.y + u_min.y;\n`\n    }\n    return `\n  pos.x = (${this.srcPosName}.x - u_min.x)/du.x;\n  pos.y = (${this.srcPosName}.y - u_min.y)/du.y;\n`\n  }\n}","import BaseShaderNode from './BaseShaderNode';\nimport TexturePositionNode from './TexturePositionNode';\nimport renderNodes from './renderNodes';\nimport UserDefinedVelocityFunction from './UserDefinedVelocityFunction';\nimport PanzoomTransform from './PanzoomTransform';\nimport RungeKuttaIntegrator from './RungeKuttaIntegrator';\n\nexport default class UpdatePositionGraph {\n  constructor(options) {\n    this.readStoredPosition = new TexturePositionNode(/* isDecode = */ true);\n    this.udfVelocity = new UserDefinedVelocityFunction();\n    this.integratePositions = new RungeKuttaIntegrator();\n    this.dropParticles = new RandomParticleDropper();\n    this.writeComputedPosition = new TexturePositionNode(/* isDecode = */ false);\n    this.panZoomDecode = new PanzoomTransform({decode: true});\n    this.panZoomEncode = new PanzoomTransform({decode: false});\n\n    this.colorMode = options && options.colorMode;\n  }\n\n  setCustomVectorField(velocityCode) {\n    this.udfVelocity.setNewUpdateCode(velocityCode);\n  }\n\n  getVertexShader () {\n    return `precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}`\n  }\n\n  getFragmentShader() {\n    var nodes = [\n      this.readStoredPosition,\n      this.dropParticles,\n      this.udfVelocity,\n      this.integratePositions, {\n        getMainBody() {\n          return `\n  vec2 newPos = pos + velocity;\n  `\n        }\n      },\n      this.writeComputedPosition\n    ];\n    return renderNodes(nodes);\n  }\n}\n\nclass RandomParticleDropper extends BaseShaderNode {\n  getDefines() {\n    return `\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n`\n  }\n\n  getFunctions() {\n    // TODO: Ideally this node should probably depend on\n    // random number generator node, so that we don't duplicate code\n    return `\n`\n  }\n\n  getMainBody() {\n    return `\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n`;\n  }\n\n}","/**\n * This file encodes/decodes float values into 32bit rgba array\n * \n * It is based on https://computergraphics.stackexchange.com/questions/4151/webgl-packing-unpacking-functions-that-can-roundtrip-all-typical-32-bit-floats\n * and it is not perfect. If you know how to improve it - please let me know.\n */\n\n/**\n * Encodes float value into output array\n * @param {float} val - value to be encode\n * @param {Uint8Array} out  - array where encoded value needs to be written.\n * @param {Number} writeOffset - offset in the original array where values should be written.\n */\nexport function encodeFloatRGBA(val, out, writeOffset) {\n  if (val == 0.0) {\n    out[writeOffset + 0] = 0; out[writeOffset + 1] = 0; out[writeOffset + 2] = 0; out[writeOffset + 3] = 0;\n    return;\n  }\n\n  var mag = Math.abs(val);\n  var exponent = Math.floor(Math.log2(mag));\n  // Correct log2 approximation errors.\n  exponent += (exp2(exponent) <= mag / 2.0) ? 1 : 0;\n  exponent -= (exp2(exponent) > mag) ? 1 : 0;\n\n  var mantissa;\n  if (exponent > 100.0) {\n      mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n  } else {\n      mantissa = mag / (exp2(exponent)) - 1.0;\n  }\n\n  var a = exponent + 127.0;\n  mantissa *= 256.0;\n  var b = Math.floor(mantissa);\n  mantissa -= b;\n  mantissa *= 256.0;\n  var c = Math.floor(mantissa);\n  mantissa -= c;\n  mantissa *= 128.0;\n  var d = Math.floor(mantissa) * 2.0 + ((val < 0.0) ? 1: 0);\n\n  out[writeOffset + 0] = a; out[writeOffset + 1] = b; out[writeOffset + 2] = c; out[writeOffset + 3] = d;\n}\n\n/**\n * Given byte values in range [0..255] returns decoded float value.\n * \n * @param {Byte} r \n * @param {Byte} g \n * @param {Byte} b \n * @param {Byte} a \n */\nexport function decodeFloatRGBA(r, g, b, a) {\n  var A = Math.floor(r + 0.5);\n  var B = Math.floor(g + 0.5);\n  var C = Math.floor(b + 0.5);\n  var D = Math.floor(a + 0.5);\n\n  var exponent = A - 127.0;\n  var sign = 1.0 - (D % 2.0) * 2.0;\n  var mantissa = ((A > 0.0) ? 1 : 0)\n                  + B / 256.0\n                  + C / 65536.0\n                  + Math.floor(D / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n\nfunction exp2(exponent) { return Math.exp(exponent * Math.LN2); }","/**\n * A simple interface to compute eventual min/max \n */\nexport default function makeStatCounter() {\n  var min, max;\n\n  var api = {\n    getMin() { return min; },\n    getMax() { return max; },\n    add(x) {\n      if (x < min) min = x;\n      if (x > max) max = x;\n    },\n    reset: reset\n  };\n\n  return api;\n\n  function reset() {\n    min = Number.POSITIVE_INFINITY;\n    max = Number.NEGATIVE_INFINITY;\n  }\n}\n","import util from '../gl-utils';\nimport bus from '../bus';\nimport {decodeFloatRGBA} from '../utils/floatPacking';\nimport makeStatCounter from '../utils/makeStatCounter';\n\nconst OUT_V_X = 6;\nconst OUT_V_Y = 7;\n/**\n * This program allows to change color of each particle. It works by\n * reading current velocities into a texture from the framebuffer. Once\n * velocities are read, it checks velocity scale and passes it to a draw program.\n */\nexport default function colorProgram(ctx) {\n  var speedNeedsUpdate = true;\n  var {gl} = ctx;\n  var velocity_y_texture, velocity_x_texture;\n  var particleStateResolution;\n  var pendingSpeedUpdate;\n  var numParticles;\n  var velocityCounter = makeStatCounter();\n  var velocity_x;\n  var velocity_y;\n\n  listenToEvents();\n\n  return {\n    updateCode,\n    updateParticlesPositions,\n    updateParticlesCount,\n    setColorMinMax,\n    requestSpeedUpdate,\n    dispose\n  };\n\n  function listenToEvents() {\n    bus.on('integration-timestep-changed', requestSpeedUpdate);\n    bus.on('bbox-change', requestSpeedUpdate);\n    bus.on('refresh-speed', requestSpeedUpdate);\n  }\n\n  function dispose() {\n    bus.off('integration-timestep-changed', requestSpeedUpdate);\n    bus.off('bbox-change', requestSpeedUpdate);\n    bus.off('refresh-speed', requestSpeedUpdate);\n    disposeTextures();\n  }\n\n  function disposeTextures() {\n    if (velocity_x_texture) gl.deleteTexture(velocity_x_texture);\n    if (velocity_y_texture) gl.deleteTexture(velocity_y_texture);\n  }\n\n  function requestSpeedUpdate() {\n    if (pendingSpeedUpdate) clearTimeout(pendingSpeedUpdate);\n    pendingSpeedUpdate = setTimeout(() => {\n      speedNeedsUpdate = true;\n      pendingSpeedUpdate = 0;\n    }, 50);\n  }\n\n  function setColorMinMax(program) {\n    gl.uniform2f(program.u_velocity_range, velocityCounter.getMin(), velocityCounter.getMax());\n  }\n\n  function updateParticlesCount() {\n    disposeTextures();\n\n    particleStateResolution = ctx.particleStateResolution;\n    numParticles = particleStateResolution * particleStateResolution;\n\n    velocity_x = new Uint8Array(numParticles * 4);\n    velocity_y = new Uint8Array(numParticles * 4);\n    velocity_x_texture = util.createTexture(gl, gl.NEAREST, velocity_x, particleStateResolution, particleStateResolution);\n    velocity_y_texture = util.createTexture(gl, gl.NEAREST, velocity_y, particleStateResolution, particleStateResolution);\n\n    requestSpeedUpdate();\n  }\n\n  function updateCode() {\n    requestSpeedUpdate();\n  }\n\n  function updateParticlesPositions(program) {\n    if (!speedNeedsUpdate || !velocity_x || !velocity_y) return;\n    speedNeedsUpdate = false;\n\n    // We assume this is called from update position program\n    util.bindFramebuffer(gl, ctx.framebuffer, velocity_x_texture);\n    gl.uniform1i(program.u_out_coordinate, OUT_V_X);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.readPixels(0, 0, particleStateResolution, particleStateResolution, gl.RGBA, gl.UNSIGNED_BYTE, velocity_x);\n\n    util.bindFramebuffer(gl, ctx.framebuffer, velocity_y_texture);\n    gl.uniform1i(program.u_out_coordinate, OUT_V_Y);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.readPixels(0, 0, particleStateResolution, particleStateResolution, gl.RGBA, gl.UNSIGNED_BYTE, velocity_y);\n\n    updateMinMax();\n  }\n\n  function updateMinMax() {\n    velocityCounter.reset();\n    // TODO: Do I want this to be async?\n    for(var i = 0; i < velocity_y.length; i+=4) {\n      var vx = readFloat(velocity_x, i);\n      var vy = readFloat(velocity_y, i);\n      var v = Math.sqrt(vx * vx + vy * vy);\n      velocityCounter.add(v);\n    }\n  }\n}\n\nfunction readFloat(buffer, offset) {\n    return decodeFloatRGBA(\n      buffer[offset + 0],\n      buffer[offset + 1],\n      buffer[offset + 2],\n      buffer[offset + 3]\n    );\n}","/**\n * A wrapper over collection of textures. Can be used to represent\n * individual textures for every dimension.\n */\nimport glUtil from '../gl-utils';\n\nexport default function textureCollection(gl, dimensions, particleStateResolution) {\n  var textures = dimensions.map((d, index) => {\n    var textureInfo = {\n      texture: glUtil.createTexture(gl, gl.NEAREST, d.particleState, particleStateResolution, particleStateResolution),\n      index: index,\n      name: d.name\n    }\n\n    return textureInfo;\n  })\n\n  return {\n    dispose,\n    bindTextures,\n    assignProgramUniforms,\n    length: dimensions.length,\n    textures,\n    get(i) { return textures[i]; }\n  }\n\n  function assignProgramUniforms(program) {\n    textures.forEach(tInfo => {\n      gl.uniform1i(program['u_particles_' + tInfo.name], tInfo.index);\n    });\n  }\n\n  function dispose() {\n    textures.forEach(tInfo => gl.deleteTexture(tInfo.texture));\n  }\n\n  function bindTextures(gl, program) {\n    textures.forEach((tInfo) => {\n      glUtil.bindTexture(gl, tInfo.texture, tInfo.index);\n      gl.uniform1i(program['u_particles_' + tInfo.name], tInfo.index);\n    })\n  }\n}","import util from '../gl-utils';\nimport UpdatePositionGraph from '../shaderGraph/updatePositionGraph';\nimport ColorMode from './colorModes';\nimport makeReadProgram from './colorProgram';\nimport textureCollection from '../utils/textureCollection';\nimport makeStatCounter from '../utils/makeStatCounter';\nimport {decodeFloatRGBA} from '../utils/floatPacking';\nimport bus from '../bus';\n\nconst particlePositionShaderCodeBuilder = new UpdatePositionGraph();\n\nexport default function updatePositionProgram(ctx) {\n  var gl = ctx.gl;\n  var readTextures, writeTextures;\n  var particleStateResolution;\n  var updateProgram;\n  var readVelocity = makeReadProgram(ctx);\n\n  // If someone needs to get vectors out from the GPU, they send a `vector-lines-request`\n  // over the bus. This request is delayed until next compute frame. Once it is handled,\n  // we send them back response with calculated vectors.\n  var pendingVectorLines;\n\n  // TODO: need to make sure we are not leaking.\n  bus.on('vector-lines-request', putVectorLinesRequestIntoQueue);\n\n  return {\n    updateCode,\n    updateParticlesPositions,\n    updateParticlesCount,\n    prepareToDraw,\n    updateVariable\n  };\n\n  function updateCode(vectorField) {\n    particlePositionShaderCodeBuilder.setCustomVectorField(vectorField);\n    let fragment = particlePositionShaderCodeBuilder.getFragmentShader();\n    let vertex = particlePositionShaderCodeBuilder.getVertexShader();\n\n    let newProgram = util.createProgram(gl, vertex, fragment);\n\n    if (updateProgram) updateProgram.unload();\n    updateProgram = newProgram;\n\n    if (ctx.colorMode === ColorMode.VELOCITY) readVelocity.requestSpeedUpdate();\n  }\n\n  function updateVariable(varName, value) {\n    var uniformLocation = gl.getUniformLocation(updateProgram.program, `u_${varName}`);\n    gl.useProgram(updateProgram.program);\n    gl.uniform1f(uniformLocation, value);\n  }\n\n  function updateParticlesCount(x, y) {\n    particleStateResolution = ctx.particleStateResolution;\n\n    var dimensions = [{\n      name: 'x',\n      particleState: x\n    }, {\n      name: 'y',\n      particleState: y\n    }];\n\n    if (readTextures) readTextures.dispose();\n    readTextures = textureCollection(gl, dimensions, particleStateResolution);\n\n    if (writeTextures) writeTextures.dispose();\n    writeTextures = textureCollection(gl, dimensions, particleStateResolution);\n\n    readVelocity.updateParticlesCount();\n  }\n\n  function prepareToDraw(program) {\n    var colorMode = ctx.colorMode;\n    if (colorMode === ColorMode.VELOCITY) readVelocity.setColorMinMax(program);\n\n    readTextures.bindTextures(gl, program);\n  }\n\n  function updateParticlesPositions() {\n    var program = updateProgram;\n    gl.useProgram(program.program);\n  \n    util.bindAttribute(gl, ctx.quadBuffer, program.a_pos, 2);\n  \n    ctx.inputs.updateBindings(program);\n\n    // TODO: Remove this.\n    if (ctx.audioTexture) {\n      util.bindTexture(gl, ctx.audioTexture, 5);\n      gl.uniform1i(program['u_audio'], 5);\n    }\n\n    readTextures.bindTextures(gl, program);\n  \n    gl.uniform1f(program.u_rand_seed, ctx.frameSeed);\n    gl.uniform1f(program.u_h, ctx.integrationTimeStep);\n    gl.uniform1f(program.frame, ctx.frame);\n    var cursor = ctx.cursor;\n    gl.uniform4f(program.cursor, cursor.clickX, cursor.clickY, cursor.hoverX, cursor.hoverY);\n\n    var bbox = ctx.bbox;\n    gl.uniform2f(program.u_min, bbox.minX, bbox.minY);\n    gl.uniform2f(program.u_max, bbox.maxX, bbox.maxY);\n\n    gl.uniform1f(program.u_drop_rate, ctx.dropProbability);\n  \n    // Draw each coordinate individually\n    for(var i = 0; i < writeTextures.length; ++i) {\n      var writeInfo = writeTextures.get(i);\n      gl.uniform1i(program.u_out_coordinate, i);\n      util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n      gl.viewport(0, 0, particleStateResolution, particleStateResolution);\n      gl.drawArrays(gl.TRIANGLES, 0, 6);\n    }\n\n    // TODO: I think I need to keep this time-bound, i.e. allocate X ms to\n    // process particle positions, and move on. So that the rendering thread is not paused for too long\n    if (ctx.colorMode === ColorMode.VELOCITY) {\n      readVelocity.updateParticlesPositions(program);\n    }\n\n    if (pendingVectorLines) {\n      processVectorLinesRequest(program);\n      pendingVectorLines = null;\n    }\n\n    // swap the particle state textures so the new one becomes the current one\n    var temp = readTextures;\n    readTextures = writeTextures;\n    writeTextures = temp;\n  }\n\n  function putVectorLinesRequestIntoQueue(request) {\n    pendingVectorLines = request;\n  }\n\n  function processVectorLinesRequest(program) {\n    // TODO: Move this out\n    var dimensions = [{\n      name: 'x',\n      particleState: pendingVectorLines.x\n    }, {\n      name: 'y',\n      particleState: pendingVectorLines.y\n    }];\n\n    // We create temporary textures and load requested positions in there\n    var resolutionOfParticlesInRequest = pendingVectorLines.resolution;\n    var numParticles = resolutionOfParticlesInRequest * resolutionOfParticlesInRequest;\n\n    var texturesForRead = textureCollection(gl, dimensions, resolutionOfParticlesInRequest);\n    var texturesForWrite = textureCollection(gl, dimensions, resolutionOfParticlesInRequest);\n\n    texturesForRead.bindTextures(gl, program);\n\n    // Then we request coordinates out from GPU for each dimension\n    var writeInfo = texturesForWrite.get(0);\n    gl.uniform1i(program.u_out_coordinate, 6); // v_x\n\n    util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n    gl.viewport(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n    var velocity_x = new Uint8Array(numParticles * 4);\n    gl.readPixels(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest, gl.RGBA, gl.UNSIGNED_BYTE, velocity_x);\n\n    gl.uniform1i(program.u_out_coordinate, 7); // v_y\n    writeInfo = texturesForWrite.get(1);\n    util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n    gl.viewport(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n    var velocity_y = new Uint8Array(numParticles * 4);\n    gl.readPixels(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest, gl.RGBA, gl.UNSIGNED_BYTE, velocity_y);\n\n    texturesForWrite.dispose();\n    texturesForRead.dispose();\n\n    var xStats = makeStatCounter();\n    var yStats = makeStatCounter();\n\n    var decoded_velocity_x = new Float32Array(numParticles);\n    var decoded_velocity_y = new Float32Array(numParticles);\n    for(var i = 0; i < velocity_y.length; i+=4) {\n      var idx = i/4;\n      var vx = readFloat(velocity_x, i);\n      var vy = readFloat(velocity_y, i);\n      decoded_velocity_x[idx] = vx;\n      decoded_velocity_y[idx] = vy;\n      xStats.add(vx);\n      yStats.add(vy);\n    }\n\n    var vectorLineInfo = {\n      xStats,\n      yStats,\n      decoded_velocity_x,\n      decoded_velocity_y,\n      resolution: resolutionOfParticlesInRequest\n    };\n\n    bus.fire('vector-line-ready', vectorLineInfo);\n  }\n}\n\nfunction readFloat(buffer, offset) {\n    return decodeFloatRGBA(\n      buffer[offset + 0],\n      buffer[offset + 1],\n      buffer[offset + 2],\n      buffer[offset + 3]\n    );\n}\n","import appState from './appState';\n\nconst defaultConfig = {\n  // I need to flash our more details before making any promises.\n  isAudioEnabled: false,\n  // this allows to render an overlay grid with vectors. Enable it\n  // and drag the scene a little bit.\n  vectorLinesEnabled: false,\n\n  // Starting from which texture unit we can bind custom inputs?\n  FREE_TEXTURE_UNIT: 4,\n\n  // whether input bindings should be visible\n  showBindings: appState.getQS().get('showBindings') || false\n}\n\nexport default defaultConfig;","import bus from '../bus';\nimport glUtil from '../gl-utils';\n\nexport default audioProgram;\n\nfunction audioProgram(ctx) {\n  var gl = ctx.gl;\n\n  var audioWidth = 8, audioHeight = 8;\n  var audioBuffer = new Uint8Array(audioWidth * audioHeight * 4);\n  var audioTexture = glUtil.createTexture(gl, gl.NEAREST, audioBuffer, audioWidth, audioHeight);\n  var audioDirty = false;\n  ctx.audioTexture = audioTexture;\n\n  bus.on('audio', updateAudioBuffer);\n\n  return {\n    updateTextures,\n    dispose\n  };\n\n  function dispose() {\n    bus.off('audio', updateAudioBuffer);\n    gl.deleteTexture(audioTexture);\n  }\n\n  function updateTextures() {\n    if (!audioDirty) return;\n    audioDirty = false;\n\n    // TODO: This should come from fftSize?\n    var width = 5, height = 5;\n    gl.bindTexture(gl.TEXTURE_2D, audioTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, audioBuffer);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  function updateAudioBuffer(newBuffer) {\n    audioBuffer = newBuffer;\n    audioDirty = true;\n  }\n}\n","import util from '../gl-utils';\nimport DrawParticleGraph from '../shaderGraph/DrawParticleGraph';\nimport makeUpdatePositionProgram from './updatePositionProgram';\nimport { encodeFloatRGBA } from '../utils/floatPacking.js';\nimport config from '../config';\nimport createAudioProgram from './audioProgram';\n\n/**\n * This program manages particles life-cycle. It updates particles positions\n * and initiates drawing them on screen.\n * \n * @param {Object} ctx rendering context. Holds WebGL state\n */\nexport default function drawParticlesProgram(ctx) {\n  var gl = ctx.gl;\n\n  var particleStateResolution, particleIndexBuffer;\n  var numParticles;\n\n  var currentVectorField = '';\n  var updatePositionProgram = makeUpdatePositionProgram(ctx);\n  var audioProgram;\n\n  var drawProgram;\n  initPrograms();\n\n  return {\n    updateParticlesCount,\n    updateParticlesPositions,\n    drawParticles,\n    updateCode,\n    updateColorMode,\n    updateVariable,\n    updateColorVariable\n  }\n\n  function initPrograms() {\n    // need to update the draw graph because color mode shader has changed.\n    initDrawProgram();\n\n    if (config.isAudioEnabled) {\n      if (audioProgram) audioProgram.dispose();\n      audioProgram = createAudioProgram(ctx);\n    }\n  }\n\n  function initDrawProgram() {\n    if (drawProgram) drawProgram.unload();\n\n    const drawGraph = new DrawParticleGraph(ctx);\n    const vertexShaderCode = drawGraph.getVertexShader(currentVectorField);\n    drawProgram = util.createProgram(gl, vertexShaderCode, drawGraph.getFragmentShader());\n  }\n\n  function updateParticlesPositions() {\n    if (!currentVectorField) return;\n\n    ctx.frame += 1\n    ctx.frameSeed = Math.random();\n\n    // TODO: Remove this.\n    if (audioProgram) audioProgram.updateTextures();\n\n    updatePositionProgram.updateParticlesPositions();\n  }\n\n  function updateColorMode() {\n    initDrawProgram();\n  }\n\n  function updateCode(vfCode) {\n    ctx.frame = 0;\n    currentVectorField = vfCode;\n    updatePositionProgram.updateCode(vfCode);\n    \n    initDrawProgram();\n  }\n\n  function updateVariableForDrawProgram(varName, value) {\n    var uniformLocation = gl.getUniformLocation(drawProgram.program, `u_${varName}`);\n    gl.useProgram(drawProgram.program);\n    gl.uniform1f(uniformLocation, value);\n  }\n\n  function updateVariable(varName, value) {\n    updatePositionProgram.updateVariable(varName, value);\n    updateVariableForDrawProgram(varName, value);\n  }\n\n  function updateColorVariable(value) {\n    updateVariableForDrawProgram('k', value);\n  }\n\n  function updateParticlesCount() {\n    particleStateResolution = ctx.particleStateResolution;\n    numParticles = particleStateResolution * particleStateResolution;\n    var particleIndices = new Float32Array(numParticles);\n    var particleStateX = new Uint8Array(numParticles * 4);\n    var particleStateY = new Uint8Array(numParticles * 4);\n\n    var minX = ctx.bbox.minX; var minY = ctx.bbox.minY;\n    var width = ctx.bbox.maxX - minX;\n    var height = ctx.bbox.maxY - minY;\n    for (var i = 0; i < numParticles; i++) {\n      encodeFloatRGBA((Math.random()) * width + minX, particleStateX, i * 4); // randomize the initial particle positions\n      encodeFloatRGBA((Math.random()) * height + minY, particleStateY, i * 4); // randomize the initial particle positions\n\n      particleIndices[i] = i;\n    }\n\n    if (particleIndexBuffer) gl.deleteBuffer(particleIndexBuffer);\n    particleIndexBuffer = util.createBuffer(gl, particleIndices);\n\n    updatePositionProgram.updateParticlesCount(particleStateX, particleStateY);\n  }\n\n  function drawParticles() {\n    if (!currentVectorField) return;\n\n    var program = drawProgram;\n    gl.useProgram(program.program);\n  \n    util.bindAttribute(gl, particleIndexBuffer, program.a_index, 1);\n    \n    updatePositionProgram.prepareToDraw(program);\n    ctx.inputs.updateBindings(program);\n  \n    gl.uniform1f(program.u_h, ctx.integrationTimeStep);\n    gl.uniform1f(program.frame, ctx.frame);\n    gl.uniform1f(program.u_particles_res, particleStateResolution);\n    var bbox = ctx.bbox;\n    gl.uniform2f(program.u_min, bbox.minX, bbox.minY);\n    gl.uniform2f(program.u_max, bbox.maxX, bbox.maxY);\n  \n    var cursor = ctx.cursor;\n    gl.uniform4f(program.cursor, cursor.clickX, cursor.clickY, cursor.hoverX, cursor.hoverY);\n    gl.drawArrays(gl.POINTS, 0, numParticles); \n  }\n}","/**\n * XMLHttpRequest wrapped into a promise.\n * \n * @param {String} url \n */\nexport default function request(url, options) {\n  if (!options) options = {};\n\n  return new Promise(download);\n\n  function download(resolve, reject) {\n    var req = new XMLHttpRequest();\n\n    if (typeof options.progress === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open('GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n    req.send(null);\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        options.progress({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total\n        });\n      }\n    }\n\n    function transferComplete() {\n      if (req.status !== 200) {\n        reject(`Unexpected status code ${req.status} when calling ${url}`);\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      resolve(response);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject(`Cancelled download of ${url}`);\n    }\n  }\n}","var loadedLinks = new Map(); // from link to response\nimport request from '../utils/request';\n\nexport default function fetchGLSL(link) {\n  if (!link) return Promise.reject('Missing link')\n  var trimmed = link.trim();\n  if (!trimmed) return Promise.reject('Missing link');\n\n  let cachedResponse = loadedLinks.get(trimmed)\n  if (cachedResponse) return Promise.resolve(cachedResponse);\n\n  return request(link).then(code => {\n    loadedLinks.set(link, code);\n    return code;\n  });\n}","import fetchGLSL from './fetchGLSL.js';\n\nvar pragmaInclude = '#include ';\nvar nullCode = { code: '' }\n\n/**\n * Naively parses glsl code and tries to replace all `#pragma` statements\n * with empty string. Gives structured collection of pragma statements back\n * \n * @param {String} code \n */\nexport default function makePragmaParser(code) {\n  if (!code) return new Promise(resolve => resolve(nullCode));\n\n  var parsedLines = processLineByLine(code);\n  if (parsedLines.pending.length > 0) {\n    return Promise.all(parsedLines.pending).then(() => parsedLines)\n      .catch(error => { return {error: {error}}; });\n  }\n\n  return new Promise(resolve => resolve(parsedLines));\n}\n\nfunction processLineByLine(code) {\n  var pending = []\n  var lines = code.split('\\n');\n  var outputLines = [];\n  var currentIndex = 0;\n  lines.forEach((line, index) => {\n    currentIndex = index;\n    if (line && line[0] === '#') {\n      outputLines.push('');\n      processPragma(line);\n    } else {\n      outputLines.push(line);\n    }\n  });\n\n  return {\n    getCode,\n    pending\n  };\n\n  function getCode() {\n    return outputLines.join('\\n');\n  }\n\n  function processPragma(line) {\n    if (line.indexOf(pragmaInclude) === 0) {\n      var include = line.substr(pragmaInclude.length);\n      var insertIndex = currentIndex;\n      pending.push(fetchGLSL(include).then(code => {\n        outputLines[insertIndex] = code\n      }))\n    }\n  }\n}","/**\n * This module parses user defined vector field code.\n */\n\nimport bus from '../bus';\nimport pragmaParse from './pragmaParser';\n\n// This is naive parser that is being used until the real `glsl-parser`\n// is loaded asynchronously. This parser assumes there are no errors\n// TODO: maybe I should be more careful here?\nvar glslParser = {\n  check(code) {\n    return {\n      code,\n      log: {\n        errorCount: 0\n      }\n    };\n  }\n};\n\n// glsl-parser is ~179KB uncompressed, we don't want to wait until it is downloaded.\n// So we load it asynchronously...\nrequire.ensure('glsl-parser', () => {\n  // ... and replace the naive parser with the real one, when ready.\n  glslParser = require('glsl-parser');\n\n  // notify interested parties, so that they can recheck code if they wish.\n  bus.fire('glsl-parser-ready'); \n});\n\nvar vectorFieldGlobals = `\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}`;\n\n/**\n * Given a string, verifies that it is a valid glsl code for a vector field,\n * and then returns code + log.\n * \n * @param {String} vectorFieldCode \n */\nexport default function getParsedVectorFieldFunction(vectorFieldCode) {\n  // TODO: what if we want to support 3d?\n  return pragmaParse(vectorFieldCode).then(pragmaParseResult => {\n    if (pragmaParseResult.error) {\n      return pragmaParseResult;\n    }\n\n    vectorFieldCode = pragmaParseResult.getCode();\n\n    var parserResult = glslParser.check(vectorFieldCode, { globals: vectorFieldGlobals });\n    parserResult.code = vectorFieldCode;\n\n    if (parserResult.log.errorCount) parserResult.error = parserError(parserResult.log);\n\n    return parserResult;\n  });\n}\n\nfunction parserError(log) {\n  let diag = log.diagnostics[0];\n  // TODO probably need to check kind (errors are 0, warnings are 1)\n  let firstError = diag.range;\n  let lineColumn = firstError.lineColumn();\n  let source = firstError.source;\n  let offset = source._lineOffsets[lineColumn.line]\n  let line = source.contents.substr(offset,  lineColumn.column);\n  line += source.contents.substring(firstError.start, firstError.end);\n  let prefix = 'Line ' + lineColumn.line + ': ';\n  let diagText = diag.text;\n  return {\n    error: \n      prefix + line + '\\n' +\n      whitespace(prefix.length) + whitespace(lineColumn.column) + '^',\n    errorDetail: diagText,\n    isFloatError: isFloatError(diagText)\n  };\n}\n\nfunction isFloatError(diagText) {\n  return diagText.indexOf('\"int\"') > -1 &&\n    diagText.indexOf('\"float\"')  > -1;\n}\n\nfunction whitespace(length) {\n  return new Array(length + 1).join(' ');\n}\n","import bus from '../bus';\nimport appState from '../appState';\nimport getParsedVectorFieldFunction from './getParsedVectorFieldFunction';\n\n/**\n * A text editor state for the vector field equation. Manages vector field\n * program compilation and error reporting state.\n *\n * @param {Object} drawProgram \n */\nexport default function createVectorFieldEditorState(drawProgram) {\n  bus.on('glsl-parser-ready', parseCode);\n  var currentVectorFieldVersion = 0;\n\n  // What is the current code?\n  var currentVectorFieldCode = appState.getCode();\n\n  // For delayed parsing result verification (e.g. when vue is loaded it\n  // can request us to see if there were any errors)\n  var parserResult;\n\n  loadCodeFromAppState();\n\n  var api = {\n    getCode,\n    setCode,\n    dispose,\n    updateVariable,\n\n    // These properties are for UI only\n    code: currentVectorFieldCode,\n    error: '',\n    errorDetail: '',\n    isFloatError: false \n  };\n\n  return api;\n\n  function dispose() {\n    bus.off('glsl-parser-ready', parseCode);\n  }\n\n  function getCode() {\n    return appState.getCode();\n  }\n\n  function setCode(vectorFieldCode) {\n    if (vectorFieldCode === currentVectorFieldCode) {\n      // If field hasn't changed, let's make sure that there was no previous\n      // error\n      if (parserResult && parserResult.error) {\n        // And if there was error, let's revalidate code:\n        parseCode();\n      }\n      return;\n    } \n\n    trySetNewCode(vectorFieldCode).then((result) => {\n      if (result.cancelled) return;\n\n      if (result && result.error) {\n        updateErrorInfo(result.error);\n        return result;\n      }\n\n      currentVectorFieldCode = vectorFieldCode;\n      api.code = vectorFieldCode;\n      appState.saveCode(vectorFieldCode);\n    });\n  }\n\n  function updateErrorInfo(parserResult) {\n    if (parserResult && parserResult.error) {\n      api.error = parserResult.error;\n      api.errorDetail = parserResult.errorDetail;\n      api.isFloatError = parserResult.isFloatError;\n    } else {\n      api.error = '';\n      api.errorDetail = '';\n      api.isFloatError = false;\n    }\n  }\n\n  function loadCodeFromAppState() {\n    let persistedCode = appState.getCode();\n    if (persistedCode) {\n      trySetNewCode(persistedCode).then(result => {\n        if (!result.error) return; // This means we set correctly;\n        // If we get here - something went wrong. see the console\n        console.error('Failed to restore previous vector field: ', result.error);\n        // Let's use default vector field\n        trySetNewCode(appState.getDefaultCode());\n      });\n    } else {\n      // we want a default vector field\n      trySetNewCode(appState.getDefaultCode());\n    }\n  }\n\n  function parseCode(customCode) {\n    return getParsedVectorFieldFunction(customCode || currentVectorFieldCode)\n      .then(currentResult => {\n        parserResult = currentResult\n        updateErrorInfo(parserResult.error);\n        return parserResult;\n      });\n  }\n\n  function trySetNewCode(vectorFieldCode) {\n    currentVectorFieldVersion += 1;\n    var capturedVersion = currentVectorFieldVersion;\n    // step 1 - run through parser\n    return parseCode(vectorFieldCode).then(parserResult => {\n      if (capturedVersion !== currentVectorFieldVersion) {\n        parserResult.cancelled = true;\n        // a newer request was issued. Ignore these results.\n        return parserResult;\n      }\n\n      if (parserResult.error) {\n        return parserResult;\n      }\n      // step 2 - run through real webgl\n      try {\n        drawProgram.updateCode(parserResult.code);\n        return parserResult;\n      } catch (e) {\n        return {\n          error: {\n            error: e.message\n          }\n        }\n      }\n    });\n  }\n\n  function updateVariable(varName, value) {\n    drawProgram.updateVariable(varName, value);\n  }\n}","/**\n * Collection of input bindings. Individual program works with this collection\n * to command it update texture bindings.\n */\nexport default function createInputCollection() {\n  var boundInputs = new Map() \n  var currentProgram;\n  return {\n    updateBindings,\n    bindInput,\n  }\n\n  function bindInput(inputIndex, inputBinding) {\n    var prevBinding = boundInputs.get(inputIndex);\n    if (prevBinding) {\n      prevBinding.dispose();\n    }\n    boundInputs.set(inputIndex, inputBinding);\n  }\n\n  function updateBindings(program) {\n    currentProgram = program;\n    boundInputs.forEach(updateInputBinding);\n  }\n\n  function updateInputBinding(input, inputIndex) {\n    input.updateBinding(currentProgram, inputIndex);\n  }\n}","// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL\nexport default function loadTexture(gl, url) {\n  var resolveTexture, rejectTexture;\n\n  var image = new Image();\n  image.crossOrigin = '';\n\n  image.onload = bindTexture;\n  image.onerror = reportError;\n  image.src = url;\n\n  return new Promise((resolve, reject) => {\n    resolveTexture = resolve;\n    rejectTexture = reject;\n  });\n\n  function reportError(err) {\n    rejectTexture(err);\n  }\n\n  function bindTexture() {\n    var texture = gl.createTexture();\n    var level = 0;\n    var internalFormat = gl.RGBA;\n    var srcFormat = gl.RGBA;\n    var srcType = gl.UNSIGNED_BYTE;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n                  srcFormat, srcType, image);\n\n    if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n       gl.generateMipmap(gl.TEXTURE_2D);\n    } else {\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    }\n\n    resolveTexture(texture);\n  }\n}\n\nfunction isPowerOf2(value) {\n  return (value & (value - 1)) == 0;\n}","/**\n * Creates a single image binding element in the input collection.\n */\nimport loadTexture from \"./loadTexture\";\nimport glUtils from '../../gl-utils';\nimport config from '../../config';\nimport bus from '../../bus';\n\nconst FREE_TEXTURE_UNIT = config.FREE_TEXTURE_UNIT;\n\nexport default function createImageInputBinding(ctx, url, callbacks) {\n  var texture = null;\n  loadTexture(ctx.gl, url).then(setTexture).catch(handleError);\n\n  return {\n    updateBinding,\n    dispose() {\n      // TODO: Potential race condition, as loadTexture is async.\n      ctx.gl.deleteTexture(texture);\n    }\n  }\n\n  function handleError(err) {\n    if (callbacks && callbacks.error) {\n      callbacks.error(err);\n    }\n  }\n\n  function setTexture(loadedTexture) {\n    texture = loadedTexture;\n    bus.fire('refresh-speed')\n    if (callbacks && callbacks.done) {\n      callbacks.done(url);\n    }\n  }\n\n  function updateBinding(program, inputIndex) {\n    if (!texture) return;\n\n    var realIndex = inputIndex + FREE_TEXTURE_UNIT;\n    glUtils.bindTexture(ctx.gl, texture, realIndex);\n    ctx.gl.uniform1i(program[`input${inputIndex}`], realIndex);\n  }\n}","import createInputCollection from './programs/inputs/inputCollection';\nimport createVideoInput from './programs/inputs/videoInput';\nimport createImageInputBinding from './programs/inputs/imageInput';\nimport appState from './appState.js';\n\n// Allows to bind media elements to vector field\nexport default function createInputsModel(ctx) {\n  ctx.inputs = createInputCollection();\n  var inputs = [];\n  readInputsFromAppState();\n\n  var api = {\n    getInputs,\n    addInput,\n  };\n\n  return api;\n\n  function getInputs() {\n    return inputs;\n  }\n\n  function addInput(inputNumber) {\n    var vm = createInputElementViewModel(ctx, inputNumber);\n    inputs.push(vm);\n    return vm;\n  }\n\n  function readInputsFromAppState() {\n    var i0 = appState.getQS().get('i0');\n    if (i0) {\n      var vm = addInput(0);\n      vm.link = i0;\n      vm.updateBinding(/* immediate = */ true);\n    }\n  }\n}\n\nfunction createInputElementViewModel(ctx, inputNumber) {\n  var pendingUpdate = null;\n\n  var input = {\n    link: '',\n    error: null,\n    name: `input${inputNumber}`,\n    updateBinding\n  }\n\n  return input;\n\n  function updateBinding(immediate) {\n    if (pendingUpdate) {\n      clearTimeout(pendingUpdate);\n      pendingUpdate = null;\n    }\n\n    if (immediate) {\n      setBinding();\n    } else {\n      pendingUpdate = setTimeout(setBinding, 300);\n    }\n  }\n\n  function setBinding() {\n    input.error = null;\n    pendingUpdate = null;\n    var binding = createImageInputBinding(ctx, input.link, {\n      done() {\n        // TODO: Preview\n        appState.getQS().set(`i${inputNumber}`, input.link);\n      },\n      error(err) {\n        // TODO: Better Error checking\n        input.error = err;\n      }\n    });\n    ctx.inputs.bindInput(0, binding);\n  }\n}","/**\n * This file is based on https://github.com/mapbox/webgl-wind\n * by Vladimir Agafonkin\n *\n * Released under ISC License, Copyright (c) 2016, Mapbox\n * https://github.com/mapbox/webgl-wind/blob/master/LICENSE\n *\n * Adapted to field maps by Andrei Kashcha\n * Copyright (C) 2017\n */\nimport util from './gl-utils';\nimport bus from './bus';\nimport appState from './appState';\n\nimport createScreenProgram from './programs/screenProgram';\nimport createDrawParticlesProgram from './programs/drawParticlesProgram';\nimport createVectorFieldEditorState from './editor/vectorFieldState';\nimport createInputsModel from './createInputsModel';\n\nconst INITIAL_SPEED = 1;\n\nfunction integrationTimeStepFromSpeed(speed) {\n  return speed * 0.004;\n}\n\nfunction fadeOutFromSpeed(speed) {\n  return 1 - speed * 0.002;\n}\n\n/**\n * Kicks offs the app rendering. Initialized before even vue is loaded.\n *\n * @param {WebGLRenderingContext} gl\n */\nexport default function initScene(gl) {\n  // Canvas size management\n  var canvasRect = { width: 0, height: 0, top: 0, left: 0 };\n  setWidthHeight(window.innerWidth, window.innerHeight);\n  // window.addEventListener('resize', onResize, true);\n  onResize();\n\n  // TODO: It feels like bounding box management needs to be moved out from here.\n  // TODO: bbox needs to be a class with width/height properties.\n  var bbox = appState.getBBox() || {};\n  var currentPanZoomTransform = {\n    scale: 0.1,\n    x: window.innerWidth / 2,\n    y: window.innerHeight / 2\n  };\n\n  // How many particles do we want?\n  var particleCount = appState.getParticleCount();\n\n  gl.disable(gl.DEPTH_TEST);\n  gl.disable(gl.STENCIL_TEST);\n\n  // Context variable is a way to share rendering state between multiple programs. It has a lot of stuff on it.\n  // I found that it's the easiest way to work in state-full world of WebGL.\n  // Until I discover a better way to write WebGL code.\n  var ctx = {\n    gl,\n    bbox,\n    canvasRect,\n\n    inputs: null,\n\n    framebuffer: gl.createFramebuffer(),\n\n    // This is used only to render full-screen rectangle. Main magic happens inside textures.\n    quadBuffer: util.createBuffer(gl, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1])),\n\n    colorMode: appState.getColorMode(),\n    colorFunction: appState.getColorFunction(),\n\n    // This defines texture unit for screen rendering. First few indices are taken by textures\n    // that compute particles position/color\n    // TODO: I need to find a better way to manage this.\n    screenTextureUnit: 3,\n\n    speed: INITIAL_SPEED,\n    integrationTimeStep: integrationTimeStepFromSpeed(INITIAL_SPEED),\n\n    // On each frame the likelihood for a particle to reset its position is this:\n    dropProbability: appState.getDropProbability(),\n\n    // current frame number. Reset every time when new shader is compiled\n    frame: 0,\n\n    // TOREMOVE\n    // Information about mouse cursor. Could be useful to simplify\n    // exploration\n    cursor: {\n      // Where mouse was last time clicked (or tapped)\n      clickX: 0, clickY: 0,\n      // where mouse was last time moved. If this is a touch device\n      // this is the same as clickX, clickY\n      hoverX: 0, hoverY: 0\n    },\n\n    // Texture size to store particles' positions\n    particleStateResolution: 0,\n\n    // How quickly we should fade previous frame (from 0..1)\n    fadeOpacity: fadeOutFromSpeed(INITIAL_SPEED),\n\n    backgroundColor: { r: 0, g: 0, b: 0, a: 1 },\n\n    // Ignore this one for a moment. Yes, the app support web audio API,\n    // but it's rudimentary, so... shhh! it's a secret.\n    // Don't shhh on me!\n    audioTexture: null\n  };\n\n  // Frame management\n  var lastAnimationFrame;\n  var lastAnimationFrameTime;\n  var isPaused = false;\n\n  var inputsModel = createInputsModel(ctx);\n\n  // screen rendering;\n  var screenProgram = createScreenProgram(ctx);\n  var drawProgram = createDrawParticlesProgram(ctx);\n  // var cursorUpdater = createCursorUpdater(ctx);\n  var vectorFieldEditorState = createVectorFieldEditorState(drawProgram);\n\n  // particles\n  updateParticlesCount(particleCount);\n\n  var api = {\n    start: nextFrame,\n    stop,\n    dispose,\n\n    setPaused,\n\n    getParticlesCount,\n    setParticlesCount,\n\n    setFadeOutSpeed,\n    getFadeOutSpeed,\n\n    setDropProbability,\n    getDropProbability,\n\n    getSpeed,\n    setSpeed,\n\n    setColorMode,\n    getColorMode,\n\n    setColorFunction,\n    getColorFunction,\n\n    vectorFieldEditorState,\n    updateColorVariable,\n\n    inputsModel,\n\n    setBackgroundColor,\n\n    getCanvasRect() {\n      // We trust they don't do anything bad with this ...\n      return canvasRect;\n    },\n\n    getBoundingBox() {\n      // again, we trust. Maybe to much?\n      return ctx.bbox;\n    }\n  }\n\n  restoreBBox();\n\n  setTimeout(() => {\n    bus.fire('scene-ready', api);\n  })\n\n  return api;\n\n  function assignIfPossible(change, key, newBoundingBox) {\n    var value = Number.parseFloat(change[key]);\n    if (Number.isFinite(value)) {\n      newBoundingBox[key] = value;\n    }\n  }\n\n\n  function setColorMode(x) {\n    var mode = parseInt(x, 10);\n    ctx.colorMode = mode;\n    drawProgram.updateColorMode(mode);\n  }\n\n  function getColorMode() {\n    return ctx.colorMode;\n  }\n\n  function setColorFunction(code) {\n    ctx.colorFunction = code;\n    drawProgram.updateColorMode(ctx.colorMode);\n  }\n\n  function updateColorVariable(value) {\n    drawProgram.updateColorVariable(value);\n  }\n\n  function getColorFunction() {\n    return ctx.colorFunction;\n  }\n\n  function getSpeed() {\n    return ctx.speed;\n  }\n\n  function setSpeed(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      ctx.speed = f;\n      ctx.integrationTimeStep = integrationTimeStepFromSpeed(speed);\n      ctx.fadeOpacity = fadeOutFromSpeed(speed);\n      bus.fire('integration-timestep-changed', ctx.integrationTimeStep);\n    }\n  }\n\n  function setPaused(shouldPause) {\n    isPaused = shouldPause;\n    nextFrame();\n  }\n\n  // Main screen fade out configuration\n  function setFadeOutSpeed(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      ctx.fadeOpacity = f;\n      appState.setFadeout(f);\n    }\n  }\n\n  function getFadeOutSpeed() {\n    return appState.getFadeout();\n  }\n\n  // Number of particles configuration\n  function getParticlesCount() {\n    return appState.getParticleCount();\n  }\n\n  function setParticlesCount(newParticleCount) {\n    if (!Number.isFinite(newParticleCount)) return;\n    if (newParticleCount === particleCount) return;\n    if (newParticleCount < 1) return;\n\n    updateParticlesCount(newParticleCount);\n\n    particleCount = newParticleCount;\n    appState.setParticleCount(newParticleCount);\n  }\n\n  // drop probability\n  function setDropProbability(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      // TODO: Do I need to worry about duplication/clamping?\n      appState.setDropProbability(f);\n      ctx.dropProbability = f;\n    }\n  }\n\n  function getDropProbability() {\n    return appState.getDropProbability();\n  }\n\n  function onResize() {\n    setWidthHeight(window.innerWidth, window.innerHeight);\n\n    if (screenProgram) {\n      screenProgram.updateScreenTextures();\n      updateBoundingBox();\n    }\n  }\n\n  function setWidthHeight(w, h) {\n    var dx = Math.max(w * 0.02, 30);\n    var dy = Math.max(h * 0.02, 30);\n    let x = w + 2 * dx;\n    let y = h + 2 * dy;\n    canvasRect.width = window.devicePixelRatio * x;\n    canvasRect.height = window.devicePixelRatio * y;\n    canvasRect.top = - dy;\n    canvasRect.left = - dx;\n\n\n    let canvas = gl.canvas;\n    canvas.style.width = x + 'px';\n    canvas.style.height = y + 'px';\n    canvas.style.left = (-dx) + 'px';\n    canvas.style.top = (-dy) + 'px';\n    canvas.width = canvasRect.width;\n    canvas.height = canvasRect.height;\n  }\n\n  function dispose() {\n    stop();\n    window.removeEventListener('resize', onResize, true);\n    vectorFieldEditorState.dispose();\n  }\n\n  function nextFrame() {\n    if (lastAnimationFrame) return;\n\n    if (isPaused) return;\n\n    lastAnimationFrame = requestAnimationFrame(draw);\n    lastAnimationFrameTime = Date.now();\n  }\n\n  function stop() {\n    cancelAnimationFrame(lastAnimationFrame);\n    lastAnimationFrame = 0;\n    lastAnimationFrameTime = undefined;\n  }\n\n  function draw() {\n    lastAnimationFrame = 0;\n\n    // Adjust integration time step if we missed frames\n    if (lastAnimationFrameTime) {\n      let timeSinceLastFrame = Date.now() - lastAnimationFrameTime;\n      let performanceRatio = (1000 / 30) / timeSinceLastFrame;\n      let correctedSpeed = ctx.speed / Math.min(performanceRatio, 1);\n      ctx.integrationTimeStep = integrationTimeStepFromSpeed(correctedSpeed);\n      ctx.fadeOpacity = fadeOutFromSpeed(correctedSpeed);\n      // bus.fire('integration-timestep-changed', ctx.integrationTimeStep);\n    }\n    drawScreen();\n\n    nextFrame();\n  }\n\n  function drawScreen() {\n    screenProgram.fadeOutLastFrame()\n    drawProgram.drawParticles();\n    screenProgram.renderCurrentScreen();\n    drawProgram.updateParticlesPositions();\n  }\n\n  function updateParticlesCount(numParticles) {\n    // we create a square texture where each pixel will hold a particle position encoded as RGBA\n    ctx.particleStateResolution = Math.ceil(Math.sqrt(numParticles));\n    drawProgram.updateParticlesCount();\n  }\n\n  function restoreBBox() {\n    var {width, height} = canvasRect;\n\n    let sX = Math.PI * Math.E;\n    let sY = Math.PI * Math.E;\n    let tX = 0;\n    let tY = 0;\n\n    var w2 = sX * width / 2;\n    var h2 = sY * width / 2;\n    updateBoundingBox();\n  }\n\n  function updateBoundingBox() {\n    screenProgram.boundingBoxUpdated = true;\n\n    currentPanZoomTransform = {\n      scale: 0.1,\n      x: window.innerWidth / 2,\n      y: window.innerHeight / 2\n    };\n\n    var {width, height} = canvasRect;\n    width /= window.devicePixelRatio;\n    height /= window.devicePixelRatio;\n\n    var minX = clientX(0);\n    var minY = clientY(0);\n    var maxX = clientX(width);\n    var maxY = clientY(height);\n\n    // we divide by width to keep aspect ratio\n    // var ar = width/height;\n    var p = 10000;\n    bbox.minX = Math.round(p * minX/width)/p;\n    bbox.minY = Math.round(p * -minY/width)/p;\n    bbox.maxX = Math.round(p * maxX/width)/p;\n    bbox.maxY = Math.round(p * -maxY/ width)/p;\n\n    bus.fire('bbox-change', bbox);\n\n    function clientX(x) {\n      return (x - currentPanZoomTransform.x)/currentPanZoomTransform.scale;\n    }\n\n    function clientY(y) {\n      return (y - currentPanZoomTransform.y)/currentPanZoomTransform.scale;\n    }\n  }\n\n  // backgroundColor should be an object with r, g, b, a properties (range: 0-1)\n  function setBackgroundColor(backgroundColor) {\n    ctx.backgroundColor = backgroundColor; \n  }\n}\n","\nimport _ from 'lodash';\nimport { CreateElement, VNode } from 'vue';\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport initScene from '../lib/field-play/scene';\nimport ColorModes from '../lib/field-play/programs/colorModes';\n\nimport { easeExpInOut } from 'd3-ease';\n\nfunction scale(x: number): number {\n  // return easeExpInOut(x);\n  return x;\n}\n\n@Component\nexport default class FieldVizualisation extends Vue {\n  private scene: any;\n\n  @Prop({ required: true })\n  public alpha: number;\n\n  @Prop({ required: true })\n  public beta1: number;\n\n  @Prop({ required: true })\n  public beta2: number;\n\n  @Prop({ required: true })\n  public beta3: number;\n\n  @Prop({ required: true })\n  public gamma: number;\n\n  get k1(): number {\n    return scale(this.alpha);\n  };\n\n  get k2(): number {\n    return scale(this.gamma);\n  };\n\n  get k3(): number {\n    return scale(this.beta1);\n  };\n  get k4(): number {\n    return scale(this.beta2);\n  };\n  get k5(): number {\n    return scale(this.beta3);\n  };\n\n  @Prop({ required: true })\n  public n: number;\n\n  @Prop({ default: false })\n  public paused: boolean;\n\n  get actuallyPaused (): boolean {\n    return this.paused && this.n > 0;\n  }\n\n  private timeStep: number = 0.01;\n  private dropProbability: number = 0.009;\n  private fadeout: number = .998;\n\n  get particleCount (): number {\n    return Math.max(\n      this.n * (window.innerHeight * window.innerWidth) / 5000 * Math.pow(window.devicePixelRatio, 2)\n    , 1);\n  }\n\n  mounted () {\n    let canvas: HTMLCanvasElement = this.$el as HTMLCanvasElement;\n    let ctxOptions = { antialias: true, alpha: false, preserveDrawingBuffer: true };\n    let gl = canvas.getContext('webgl', ctxOptions) ||\n    canvas.getContext('experimental-webgl', ctxOptions);\n\n    this.scene = initScene(gl);\n    this.scene.setParticlesCount(this.particleCount);\n    this.scene.setBackgroundColor({\n      r: 0.05, g: 0, b: 0.1, a: 1\n    });\n    this.scene.setDropProbability(0.001)\n    this.updateVectorField();\n    this.updateColorFunction();\n    this.scene.setColorMode(ColorModes.VELOCITY);\n\n    if (!this.actuallyPaused)\n      this.scene.start();\n  }\n\n  beforeDestroy () {\n    this.scene.dispose();\n    this.$el.remove();\n  }\n\n  formatNumberforGLSL (n: number): string {\n    if (_.isNaN(n))\n      return '0.'\n    return n.toFixed(4);\n  }\n\n  get GLSLcode () {\n    let codeLines: string[] = [];\n\n    codeLines.push(`v.x = 0.;`);\n    codeLines.push(`v.y = 0.;`);\n    codeLines.push(`float tau = acos(0.);`);\n    codeLines.push(`float pi = tau / 2.;`);\n    codeLines.push(`float l = length(p);`)\n\n    codeLines.push(`if (u_k1 > .0) {`)\n      let circle = {\n        x: `p.y`,\n        y: `-p.x`\n      }\n      codeLines.push(`v.x += pow(u_k1, 2.) * (${circle.x}) / pow(max(1., abs(3. * l) - 2. * tau), 3.);`);\n      codeLines.push(`v.y += pow(u_k1, 2.) * (${circle.y}) / pow(max(1., abs(3. * l) - 2. * tau), 3.);`);\n    codeLines.push(`}`);\n\n    // SQUARES: Hi beta (3)\n    codeLines.push(`if (u_k5 > .0) {`)\n      let squares = {\n        x: `sign(sin(p.y * 4.)) / 2. + (1. - u_k5) * sin(p.y * 4.)`,\n        y: `sign(-1. * sin(p.x * 4.)) / 2. - (1. - u_k5) * sin(p.x * 4.)`\n      };\n      codeLines.push(`float sd = (abs(p.x) + abs(p.y)) * 2. / 3.;`);\n      codeLines.push(`if ( (sd < tau) && (sd > pi / 2.) ) {`);\n        codeLines.push(`v.x += pow(u_k5, 3.) * (${squares.x});`);\n        codeLines.push(`v.y += pow(u_k5, 3.) * (${squares.y});`);\n      codeLines.push(`}`);\n    codeLines.push(`}`);\n\n    // WHRIL: gamma\n    codeLines.push(`if (u_k2 > .0) {`)\n      let whirl = {\n        x: `(p.y + p.x) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)`,\n        y: `(- p.x + p.y) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)`\n      };\n      codeLines.push(`v.x -= pow(u_k2, 2.) * (${whirl.x});`);\n      codeLines.push(`v.y -= pow(u_k2, 2.) * (${whirl.y});`);\n    codeLines.push(`}`);\n\n    // explode idle: Low-beta (1)\n    codeLines.push(`if (u_k3 > .0) {`)\n      codeLines.push(`v.x += u_k3 * p.x / pow(l, 2.);`);\n      codeLines.push(`v.y += u_k3 * p.y / pow(l, 2.);`);\n    codeLines.push(`}`);\n\n    codeLines.push(`if (u_k4 > .0) {`)\n      codeLines.push(`float x = sin((p.x + p.y) * 3.);`)\n      codeLines.push(`float y = sin((p.x - p.y) * 3.);`)\n      codeLines.push(`float cd = max(max(abs(p.x), abs(p.y)) - 0.5, 0.);`)\n      // CLOVERFLIED processing units (cpu-like): Mid Beta (2)\n      let cloverfield = {\n        x: `4. * ((-1. / x / 50.) + (-1. / (y + x) / 100.) ) / max(1., pow(cd, 6.))`,\n        y: `4. * ((-1. / y / 50.) + (1.  / (x - y) / 100.) ) / max(1., pow(cd, 6.))`\n      };\n      codeLines.push(`v.x += pow(u_k4, 4.) * (${cloverfield.x});`);\n      codeLines.push(`v.y += pow(u_k4, 4.) * (${cloverfield.y});`);\n    codeLines.push(`}`);\n\n    codeLines.push(`v.x /= 2.;`);\n    codeLines.push(`v.y /= 2.;`);\n\n    return `\n    vec2 get_velocity(vec2 p) {\n      vec2 v = vec2(0., 0.);\n\n      ${codeLines.join('\\n')}\n\n      return v;\n    }`\n  }\n\n  updateVectorField () {\n    if (!this.scene)\n      return;\n\n    this.scene.vectorFieldEditorState.setCode(this.GLSLcode);\n  }\n\n  updateVariable (varName, value) {\n    if (!this.scene)\n      return;\n\n    this.scene.vectorFieldEditorState.updateVariable(varName, value);\n  }\n\n  updateColorVariable (value) {\n    if (!this.scene)\n      return;\n\n    this.scene.updateColorVariable(value);\n  }\n\n  get kColor () {\n    let ka = Math.pow((this.k2 - this.k1) / 2 + 0.5, 2);\n    let kb = Math.pow((this.k3 + this.k4 + this.k5) / 3, 2);\n    let k = ka + kb;\n\n    // clamp\n    k = Math.min(1, k);\n    k = Math.max(0, k);\n\n    return k;\n  }\n\n  get colorFunction() {\n    return `\n      vec4 get_color(vec2 p) {\n        vec2 velocity = get_velocity(p);\n        float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n        float hue = 0.05 + (1. - speed) * 0.5;\n        float hue1 = 1. - pow(hue, 3.) / 2. + 0.15;\n        float hue2 = .5 + pow(hue, 3.) / 2.;\n        hue = u_k * hue1 + (1. - u_k) * hue2;\n        return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n      }`;\n  }\n\n  updateColorFunction () {\n    if (!this.scene)\n      return;\n\n    this.scene.setColorFunction(this.colorFunction);\n  }\n\n  @Watch('k1')\n  k1Updated () {\n    this.updateVariable('k1', this.k1);\n  }\n  @Watch('k2')\n  k2Updated () {\n    this.updateVariable('k2', this.k2);\n  }\n  @Watch('k3')\n  k3Updated () {\n    this.updateVariable('k3', this.k3);\n  }\n  @Watch('k4')\n  k4Updated () {\n    this.updateVariable('k4', this.k4);\n  }\n  @Watch('k5')\n  k5Updated () {\n    this.updateVariable('k5', this.k5);\n  }\n\n  @Watch('kColor')\n  kColorUpdated () {\n    this.updateColorVariable(this.kColor);\n  }\n\n  @Watch('actuallyPaused')\n  togglePause () {\n    if (this.scene)\n      this.scene[this.actuallyPaused ? 'stop' : 'start']();\n  }\n\n  @Watch('particleCount')\n  updateParticleCount () {\n    if (this.scene)\n      this.scene.setParticlesCount(this.particleCount);\n  }\n\n  render (h: CreateElement): VNode {\n    return h('canvas', { class: 'brain-particles' });\n  }\n\n}\n","var render, staticRenderFns\nimport script from \"./FieldVisualization.vue?vue&type=script&lang=ts&\"\nexport * from \"./FieldVisualization.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FieldVisualization.vue?vue&type=style&index=0&id=9c0368c6&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9c0368c6\",\n  null\n  \n)\n\ncomponent.options.__file = \"FieldVisualization.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport _ from 'lodash';\nimport { Component, Inject, Vue } from 'vue-property-decorator';\nimport { MuseClient } from 'muse-js';\nimport { EEGRelativePowerBand, POWER_BANDS, FrequencyBand } from 'muse-js';\nimport { Observable } from 'rxjs/Observable';\nimport { Subscription } from 'rxjs/Subscription';\nimport { bufferCount, map } from 'rxjs/operators';\nimport Session from './Session.vue';\nimport Visualization from './Visualization.vue';\nimport ParticlesVisualization from './ParticlesVisualization.vue';\nimport FieldVisualization from './FieldVisualization.vue';\nimport FontAwesomeIcon from '@fortawesome/vue-fontawesome';\nimport { saveAs } from 'file-saver';\nimport io from 'socket.io-client';\n\nimport fontawesome from '@fortawesome/fontawesome';\nimport faBluetooth from '@fortawesome/fontawesome-free-brands/faBluetooth';\nimport faBluetoothB from '@fortawesome/fontawesome-free-brands/faBluetoothB';\nimport faPlayCircle from '@fortawesome/fontawesome-free-regular/faPlayCircle';\nimport faPauseCircle from '@fortawesome/fontawesome-free-regular/faPauseCircle';\nimport faCaretSquareDown from '@fortawesome/fontawesome-free-regular/faCaretSquareDown';\nimport faCaretSquareUp from '@fortawesome/fontawesome-free-regular/faCaretSquareUp';\nimport faPlay from '@fortawesome/fontawesome-free-solid/faPlay';\nimport faStop from '@fortawesome/fontawesome-free-solid/faStop';\nimport faChartLine from '@fortawesome/fontawesome-free-solid/faChartLine';\nimport faInfoCircle from '@fortawesome/fontawesome-free-solid/faInfoCircle';\nimport faSyncAlt from '@fortawesome/fontawesome-free-solid/faSyncAlt';\nimport faSlidersH from '@fortawesome/fontawesome-free-solid/faSlidersH';\nimport faTimes from '@fortawesome/fontawesome-free-solid/faTimes';\nimport faCamera from '@fortawesome/fontawesome-free-solid/faCamera';\n\nfontawesome.library.add(\n  faBluetooth, faBluetoothB,\n  faPlayCircle, faPauseCircle,\n  faCaretSquareDown, faCaretSquareUp,\n  faPlay, faStop,\n  faChartLine, faInfoCircle, faSyncAlt, faSlidersH, faTimes, faCamera\n);\n\n\n\nexport interface AveragedRelativeBandPowers {\n  [index: string]: number;\n}\n\n@Component({\n  components: {\n    Session,\n    Visualization,\n    ParticlesVisualization,\n    FieldVisualization,\n    FontAwesomeIcon,\n  }\n})\nexport default class MuseRecorder extends Vue {\n  private museClient: MuseClient;\n  private connectionStatus: boolean = false;\n  private sessionInProgress: boolean = false;\n  private currentSessionSubscription: Subscription;\n  private vizControlsDisplayed: boolean = false;\n  private infoPanelOpened: boolean = false;\n  private screenshotPanelOpened: boolean = false;\n  private screenshotEmail: string = \"\";\n  private screenshotSent: boolean = false;\n\n  private currentSession: AveragedRelativeBandPowers[] = [];\n\n  private alpha: number = 0;\n  private beta1: number = 0;\n  private beta2: number = 0;\n  private beta3: number = 0;\n  private gamma: number = 0;\n  private n: number = 0;\n  private paused: boolean = true;\n  private sessionsDetailsOpened: boolean = false;\n\n  private partyMode: boolean = true;\n  private partyScales = {\n    ALPHA: [.20, .33],\n    BETA_1: [.15, .25],\n    BETA_2: [.15, .25],\n    BETA_3: [.15, .25],\n    GAMMA: [.10, .20]\n  }\n\n  private socket;\n\n  private created() {\n    this.museClient = new MuseClient();\n  }\n\n  private goToRemoteController() {\n    window.location.href = 'remote-controller.html';\n  }\n\n  private async connectToRemoteController() {\n    this.socket = io('http://127.0.0.1:3000/', {\n      reconnectionAttempts: 2\n    });\n\n    this.socket.on('connect', () => {\n      this.n = 100;\n      this.alpha = 1;\n      this.paused = false;\n    });\n\n    this.socket.on('control', (controlValues) => {\n      this.n = controlValues.n;\n      this.alpha = controlValues.alpha;\n      this.beta1 = controlValues.beta1;\n      this.beta2 = controlValues.beta2;\n      this.beta3 = controlValues.beta3;\n      this.gamma = controlValues.gamma;\n    });\n\n    this.socket.on('disconnect', () => {\n      this.paused = true;\n      this.n = 0;\n    })\n  }\n\n  private async connectToMuse() {\n    if (!this.connectionStatus) {\n      await this.museClient.connect();\n      await this.museClient.start();\n      this.museClient.connectionStatus.subscribe(\n        cS => this.connectionStatus = cS\n      );\n    }\n\n    this.startSession();\n  }\n\n  private startSession() {\n    function clamp (v) {\n      return Math.max(Math.min(1, v), 0);\n    }\n\n    this.currentSession = [];\n    if (this.currentSessionSubscription) {\n      this.currentSessionSubscription.unsubscribe();\n    }\n\n    // @ts-ignore\n    this.currentSessionSubscription = (this.museClient.relativeBandPowers as Observable<EEGRelativePowerBand[]>)\n      .pipe(\n        bufferCount(100, 25)\n      ,\n        map( (sessions: EEGRelativePowerBand[][]): EEGRelativePowerBand[] =>\n          Object.keys(POWER_BANDS).map( (k): EEGRelativePowerBand => {\n            return {\n              band: POWER_BANDS[k],\n              power: sessions.map(\n                  (session: EEGRelativePowerBand[]): number => {\n                    let bandSession = session.find( r => r.band.id == POWER_BANDS[k].id );\n                    if (bandSession) {\n                      return bandSession.power;\n                    } else {\n                      return NaN;\n                    }\n                  }\n                ).reduce(\n                  ((sumOfSessions, bandSessionValue) =>\n                    sumOfSessions += bandSessionValue\n                  ), 0\n                ) / sessions.length\n            };\n          })\n        )\n      ,\n        map( (rbps: EEGRelativePowerBand[]): AveragedRelativeBandPowers => {\n          let arbps: AveragedRelativeBandPowers = {};\n          rbps.forEach( (rbp) => arbps[rbp.band.id] = rbp.power );\n          return arbps;\n        })\n      ).subscribe(\n        (arbps: AveragedRelativeBandPowers) => {\n          if ( _.some(arbps, v => _.isNaN(v) ) )\n            return;\n          this.currentSession.push(Object.freeze(arbps));\n          this.currentSession = _.takeRight(this.currentSession, 100);\n          this.n = Math.min(this.currentSession.length * 5, 100);\n\n          if (this.partyMode) {\n            this.alpha = clamp(\n              ( arbps.ALPHA - this.partyScales.ALPHA[0] ) / ( this.partyScales.ALPHA[1] - this.partyScales.ALPHA[0])\n            );\n            this.beta1 = clamp(\n              ( arbps.BETA_1 - this.partyScales.BETA_1[0] ) / ( this.partyScales.BETA_1[1] - this.partyScales.BETA_1[0])\n            );\n            this.beta2 = clamp(\n              ( arbps.BETA_2 - this.partyScales.BETA_2[0] ) / ( this.partyScales.BETA_2[1] - this.partyScales.BETA_2[0])\n            );\n            this.beta3 = clamp(\n              ( arbps.BETA_3 - this.partyScales.BETA_3[0] ) / ( this.partyScales.BETA_3[1] - this.partyScales.BETA_3[0])\n            );\n            this.gamma = clamp(\n              ( arbps.GAMMA - this.partyScales.GAMMA[0] ) / ( this.partyScales.GAMMA[1] - this.partyScales.GAMMA[0])\n            );\n          } else {\n            this.alpha = (\n              arbps.ALPHA - Math.min(...this.currentSession.map( d => d.ALPHA ))\n            ) / (\n              Math.max(...this.currentSession.map( d => d.ALPHA )) - Math.min(...this.currentSession.map( d => d.ALPHA ))\n            );\n            this.gamma = (\n              arbps.GAMMA - Math.min(...this.currentSession.map( d => d.GAMMA ))\n            ) / (\n              Math.max(...this.currentSession.map( d => d.GAMMA )) - Math.min(...this.currentSession.map( d => d.GAMMA ))\n            );\n            this.beta1 = (\n              arbps.BETA_1 - Math.min(...this.currentSession.map( d => d.BETA_1 ))\n            ) / (\n              Math.max(...this.currentSession.map( d => d.BETA_1 )) - Math.min(...this.currentSession.map( d => d.BETA_1 ))\n            );\n            this.beta2 = (\n              arbps.BETA_2 - Math.min(...this.currentSession.map( d => d.BETA_2 ))\n            ) / (\n              Math.max(...this.currentSession.map( d => d.BETA_2 )) - Math.min(...this.currentSession.map( d => d.BETA_2 ))\n            );\n            this.beta3 = (\n              arbps.BETA_3 - Math.min(...this.currentSession.map( d => d.BETA_3 ))\n            ) / (\n              Math.max(...this.currentSession.map( d => d.BETA_3 )) - Math.min(...this.currentSession.map( d => d.BETA_3 ))\n            );\n          }\n        }\n      );\n    this.sessionInProgress = true;\n    this.paused = false;\n  }\n\n  private toggleScreenshotPanel () {\n    this.screenshotEmail = '';\n    this.screenshotSent = false;\n    this.screenshotPanelOpened = !this.screenshotPanelOpened;\n  }\n\n  private stopSession() {\n    if (this.currentSessionSubscription) {\n      this.currentSessionSubscription.unsubscribe();\n    }\n    this.sessionInProgress = false;\n    this.paused = true;\n    this.n = 0;\n  }\n\n  private toggleVizControlsDisplayed() {\n    this.vizControlsDisplayed = !this.vizControlsDisplayed;\n  }\n\n  private reload() {\n    window.location.reload();\n  }\n\n  private saveScreenshot() {\n    let canvas = this.$el.querySelector('canvas');\n    if (!canvas) { return }\n\n    canvas.toBlob( (blob) => {\n      if (!blob) { return }\n      saveAs(blob, `${this.screenshotEmail || 'anonymous'}-${Date().toString()}.png`);\n      this.screenshotSent = true;\n      this.screenshotEmail = '';\n\n      setTimeout( () => {\n        this.screenshotPanelOpened = false\n      }, 6000)\n\n    });\n  }\n\n  private beforeDestroy() {\n    this.stopSession();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MuseRecorder.vue?vue&type=template&id=02c5b012&scoped=true&\"\nimport script from \"./MuseRecorder.vue?vue&type=script&lang=ts&\"\nexport * from \"./MuseRecorder.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./MuseRecorder.vue?vue&type=style&index=0&id=02c5b012&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02c5b012\",\n  null\n  \n)\n\ncomponent.options.__file = \"MuseRecorder.vue\"\nexport default component.exports","\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport MuseRecorder from './components/MuseRecorder.vue';\n\n@Component({\n  components: {\n    MuseRecorder,\n  },\n})\nexport default class App extends Vue {}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0a24d9f9&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","import Vue from 'vue';\nimport Vuex from 'vuex';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n\n  },\n  mutations: {\n\n  },\n  actions: {\n\n  },\n});\n","import Vue from 'vue';\nimport App from './App.vue';\nimport store from './store';\n// import './registerServiceWorker';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  store,\n  render: (h) => h(App),\n}).$mount('#app');\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=style&index=0&id=02c5b012&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=style&index=0&id=02c5b012&scoped=true&lang=scss&\""],"sourceRoot":""}