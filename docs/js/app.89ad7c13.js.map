{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/field-play/bus.js","webpack:///./src/components/ParticlesVisualization.vue?c92d","webpack:///./src/components/Visualization.vue?9fda","webpack:///./src/components/MuseRecorder.vue?72b0","webpack:///./src/components/Session.vue?3090","webpack:///./src/App.vue?0960","webpack:///./src/components/FieldVisualization.vue?5fc2","webpack:///./src/App.vue?790f","webpack:///./src/components/MuseRecorder.vue?288b","webpack:///./src/components/Session.vue?2eeb","webpack:///./src/components/Session.vue","webpack:///./src/components/Session.vue?2bbb","webpack:///./src/components/Session.vue?f8ae","webpack:///./src/components/Visualization.vue?53c0","webpack:///./src/components/Visualization.vue","webpack:///./src/components/Visualization.vue?05b7","webpack:///./src/components/Visualization.vue?957e","webpack:///./src/components/ParticlesVisualization.vue","webpack:///./src/components/ParticlesVisualization.vue?04f5","webpack:///./src/components/ParticlesVisualization.vue?c46e","webpack:///./src/lib/field-play/gl-utils.js","webpack:///./src/lib/field-play/programs/colorModes.js","webpack:///./src/lib/field-play/wrapVectorField.js","webpack:///./src/lib/field-play/isSmallScreen.js","webpack:///./src/lib/field-play/appState.js","webpack:///./src/lib/field-play/programs/screenProgram.js","webpack:///./src/lib/field-play/shaderGraph/parts/decodeFloatRGBA.js","webpack:///./src/lib/field-play/shaderGraph/BaseShaderNode.js","webpack:///./src/lib/field-play/shaderGraph/parts/simplex-noise.js","webpack:///./src/lib/field-play/shaderGraph/customInput.js","webpack:///./src/lib/field-play/shaderGraph/UserDefinedVelocityFunction.js","webpack:///./src/lib/field-play/shaderGraph/RungeKuttaIntegrator.js","webpack:///./src/lib/field-play/shaderGraph/shaderBasedColor.js","webpack:///./src/lib/field-play/shaderGraph/DrawParticleGraph.js","webpack:///./src/lib/field-play/shaderGraph/parts/encodeFloatRGBA.js","webpack:///./src/lib/field-play/shaderGraph/TexturePositionNode.js","webpack:///./src/lib/field-play/shaderGraph/renderNodes.js","webpack:///./src/lib/field-play/shaderGraph/PanzoomTransform.js","webpack:///./src/lib/field-play/shaderGraph/updatePositionGraph.js","webpack:///./src/lib/field-play/utils/floatPacking.js","webpack:///./src/lib/field-play/utils/makeStatCounter.js","webpack:///./src/lib/field-play/programs/colorProgram.js","webpack:///./src/lib/field-play/utils/textureCollection.js","webpack:///./src/lib/field-play/programs/updatePositionProgram.js","webpack:///./src/lib/field-play/config.js","webpack:///./src/lib/field-play/programs/audioProgram.js","webpack:///./src/lib/field-play/programs/drawParticlesProgram.js","webpack:///./src/lib/field-play/utils/request.js","webpack:///./src/lib/field-play/editor/fetchGLSL.js","webpack:///./src/lib/field-play/editor/pragmaParser.js","webpack:///./src/lib/field-play/editor/getParsedVectorFieldFunction.js","webpack:///./src/lib/field-play/editor/vectorFieldState.js","webpack:///./src/lib/field-play/programs/inputs/inputCollection.js","webpack:///./src/lib/field-play/programs/inputs/loadTexture.js","webpack:///./src/lib/field-play/programs/inputs/imageInput.js","webpack:///./src/lib/field-play/createInputsModel.js","webpack:///./src/lib/field-play/scene.js","webpack:///./src/components/FieldVisualization.vue","webpack:///./src/components/FieldVisualization.vue?1652","webpack:///./src/components/FieldVisualization.vue?979f","webpack:///./src/components/MuseRecorder.vue","webpack:///./src/components/MuseRecorder.vue?9df8","webpack:///./src/components/MuseRecorder.vue?32ec","webpack:///./src/App.vue","webpack:///./src/App.vue?5197","webpack:///./src/App.vue?a938","webpack:///./src/store.ts","webpack:///./src/registerServiceWorker.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","2","jsonpScriptSrc","p","0","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","head","document","getElementsByTagName","script","createElement","charset","timeout","nc","setAttribute","src","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","undefined","setTimeout","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","eventify","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ParticlesVisualization_vue_vue_type_style_index_0_id_2f884374_scoped_true_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Visualization_vue_vue_type_style_index_0_id_888b4562_scoped_true_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MuseRecorder_vue_vue_type_style_index_0_id_3840bb7b_scoped_true_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Session_vue_vue_type_style_index_0_id_684ff5ac_scoped_true_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_FieldVisualization_vue_vue_type_style_index_0_id_70aec022_scoped_true_lang_scss__WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_0a24d9f9_render","_vm","this","_h","$createElement","_c","_self","attrs","id","staticRenderFns","MuseRecordervue_type_template_id_3840bb7b_scoped_true_render","staticClass","alpha","beta1","beta2","beta3","gamma","paused","class","muse-recorder__greeting--connected","connectionStatus","_m","_v","on","click","$event","connectToMuse","staticStyle","font-size","icon","_e","currentSession","sessionData","sessionsDetailsOpened","stopSession","directives","rawName","expression","modifiers","number","min","max","step","domProps","__r","_n","blur","$forceUpdate","_s","reload","toggleVizControlsDisplayed","vizControlsDisplayed","infoPanelOpened","MuseRecordervue_type_template_id_3840bb7b_scoped_true_staticRenderFns","Sessionvue_type_template_id_684ff5ac_scoped_true_render","width","height","_l","serie","toLowerCase","lineForSerie","lastSessionPointForSerie","Sessionvue_type_template_id_684ff5ac_scoped_true_staticRenderFns","Sessionvue_type_script_lang_ts_Session","_Vue","Session","classCallCheck","possibleConstructorReturn","getPrototypeOf","arguments","createClass","_this","d3_shape","map","v","xScale","yScale","blob","Blob","JSON","stringify","exportDate","Date","filename","concat","toISOString","FileSaver","keys","d3_scale","domain","range","lastSessionPoint","lodash_default","a","last","inherits","vue_property_decorator_umd","__decorate","default","components_Sessionvue_type_script_lang_ts","component","componentNormalizer","components_Session","Visualizationvue_type_template_id_888b4562_scoped_true_render","in","stdDeviation","values","in2","operator","brainWires","tk1","tk2","wire","filter","transform","originTranslation","fill","colors","Visualizationvue_type_template_id_888b4562_scoped_true_staticRenderFns","Visualizationvue_type_script_lang_ts_Vizualisation","Vizualisation","k1","k2","targetVal","_this2","duration","start","now","interpolator","d3_interpolate","animate","requestAnimationFrame","_this3","_this4","y","brainWire","curve","tension","wirePoints","k","d3_ease","masterPoints","leftPoint","leftMiddlePoint","middlePoint","rightMiddlePoint","rightPoint","wireWidth","points","reverse","verticalTranslation","Math","radius","circleOrSquareRatio","SQRT2","verticalSymetry","point","dy","sqrt","pow","Visualizationvue_type_script_lang_ts_decorate","components_Visualizationvue_type_script_lang_ts","Visualization_component","Visualization","CAMERA_DISTANCE","BOUNDS","X","Y","CIRCLE_RADIUS","POINTS_COUNT","POINTS_RENEWAL_CHANCE","ParticlesVisualizationvue_type_script_lang_ts_ParticlesVizualisation","ParticlesVizualisation","scene","three_module","renderer","preserveDrawingBuffer","autoClearColor","camera","innerWidth","innerHeight","fadeMaterial","color","transparent","opacity","depthWrite","fadePlane","fadeMesh","cameraGroup","add","translateZ","position","z","renderOrder","material","size","vertexColors","createCanvasMaterial","geometry","times","addRandomPoint","random","vertices","randomPositionOnPlane","setSize","$el","domElement","vertice","set","x","verticesNeedUpdate","isNaN","particle","h","horizontalMovement","circularMovement","squareMovement","weightedMovementAlongAxis","circleWeigth","squareWeigth","horizontalWeigth","movement","moveParticle","particleColor","dX","dY","dZ","colorsNeedUpdate","render","continue","matCanvas","matContext","getContext","texture","center","beginPath","arc","PI","closePath","fillStyle","needsUpdate","sin","θ","atan2","dr","dθ","cos","dx","lastAnimationId","cancelAnimationFrame","pause","dispose","ParticlesVisualizationvue_type_script_lang_ts_decorate","required","ParticlesVisualization_render","ParticlesVisualization_staticRenderFns","components_ParticlesVisualizationvue_type_script_lang_ts","ParticlesVisualization_component","ParticlesVisualization","gl_utils","createTexture","gl_utils_createTexture","bindFramebuffer","createProgram","createBuffer","bindAttribute","bindTexture","gl","unit","activeTexture","TEXTURE0","TEXTURE_2D","buffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","Uint8Array","texImage2D","RGBA","UNSIGNED_BYTE","framebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","attribute","numComponents","enableVertexAttribArray","vertexAttribPointer","FLOAT","vertexSource","fragmentSource","program","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","wrapper","unload","numAttributes","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","numUniforms","ACTIVE_UNIFORMS","uniform","getActiveUniform","getUniformLocation","deleteProgram","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","colorModes","UNIFORM","VELOCITY","ANGLE","CUSTOM","wrapVectorField","field","isSmallScreen","pendingSave","qs","query_state_default","useSearch","rewriteHashToSearch","currentState","defaultVectorField","defaults","timeStep","dropProbability","particleCount","fadeout","colorMode","settingsPanel","collapsed","appState","saveBBox","getBBox","makeBBox","getQS","saveCode","getCode","appState_getCode","getDefaultCode","getDropProbability","appState_getDropProbability","setDropProbability","appState_setDropProbability","getIntegrationTimeStep","setIntegrationTimeStep","getParticleCount","setParticleCount","getFadeout","setFadeout","getColorMode","appState_getColorMode","setColorMode","appState_setColorMode","getColorFunction","appState_getColorFunction","setColorFunction","appState_setColorFunction","defined","cm","colorFunction","cf","fo","pc","dt","clamp","cx","cy","w","bboxDefined","w2","h2","minX","round","maxX","minY","maxY","bbox","vfCode","oldCode","code","Number","isFinite","onChange","bus_default","fire","NO_TRANSFORM","scale","makeScreenProgram","ctx","screenTexture","backgroundTexture","canvasRect","boundBoxTextureTransform","lastRenderedBoundingBox","updateScreenTextures","screenProgram","getScreenVertexShader","getScreenFragmentShader","api","fadeOutLastFrame","renderCurrentScreen","boundingBoxUpdated","viewport","drawTexture","fadeOpacity","saveLastBbox","enable","BLEND","blendFunc","SRC_ALPHA","DST_ALPHA","clearColor","backgroundColor","g","b","clear","COLOR_BUFFER_BIT","disable","temp","audioTexture","emptyPixels","deleteTexture","NEAREST","textureTransform","useProgram","quadBuffer","a_pos","screenTextureUnit","uniform1i","u_screen","uniform1f","u_opacity_border","u_opacity","uniform3f","u_transform","drawArrays","TRIANGLES","decodeFloatRGBA_code","decodeFloatRGBA","BaseShaderNode_BaseShaderNode","BaseShaderNode","simplex_noise_code","simplex_noise","getInputUniforms","UserDefinedVelocityFunction_UserDefinedVelocityFunction","UserDefinedVelocityFunction","updateCode","newUpdateCode","RungeKuttaIntegrator_RungeKuttaIntegrator","RungeKuttaIntegrator","shaderBasedColor","colorCode","udf","integrate","getVariables","getMain","getMethods","getDefines","getFunctions","getColorFunctionBody","DrawParticleGraph_DrawParticleGraph","DrawParticleGraph","decodePositions","textureBasedPosition","colorParts","methods","addMethods","main","addMain","join","producer","array","encodeFloatRGBA_code","encodeFloatRGBA","TexturePositionNode_TexturePosition","TexturePosition","isDecode","renderNodes","nodes","forEach","node","addToCode","getMainBody","line","PanzoomTransform_PanzoomTransform","PanzoomTransform","config","decode","srcPosName","posName","updatePositionGraph_UpdatePositionGraph","UpdatePositionGraph","options","readStoredPosition","udfVelocity","integratePositions","dropParticles","updatePositionGraph_RandomParticleDropper","writeComputedPosition","panZoomDecode","panZoomEncode","velocityCode","setNewUpdateCode","floatPacking_encodeFloatRGBA","val","out","writeOffset","mantissa","mag","abs","exponent","floor","log2","exp2","floatPacking_decodeFloatRGBA","A","B","C","D","sign","exp","LN2","makeStatCounter","getMin","getMax","reset","POSITIVE_INFINITY","NEGATIVE_INFINITY","OUT_V_X","OUT_V_Y","colorProgram","velocity_y_texture","velocity_x_texture","particleStateResolution","pendingSpeedUpdate","numParticles","velocity_x","velocity_y","speedNeedsUpdate","velocityCounter","listenToEvents","updateParticlesPositions","updateParticlesCount","setColorMinMax","requestSpeedUpdate","off","disposeTextures","uniform2f","u_velocity_range","u_out_coordinate","readPixels","updateMinMax","vx","readFloat","vy","offset","textureCollection","dimensions","textures","index","textureInfo","particleState","bindTextures","assignProgramUniforms","tInfo","particlePositionShaderCodeBuilder","updatePositionProgram_updatePositionProgram","readTextures","writeTextures","updateProgram","pendingVectorLines","readVelocity","putVectorLinesRequestIntoQueue","prepareToDraw","updateVariable","vectorField","setCustomVectorField","fragment","getFragmentShader","vertex","getVertexShader","newProgram","varName","uniformLocation","inputs","updateBindings","u_rand_seed","frameSeed","u_h","integrationTimeStep","frame","cursor","uniform4f","clickX","clickY","hoverX","hoverY","u_min","u_max","u_drop_rate","writeInfo","processVectorLinesRequest","resolutionOfParticlesInRequest","resolution","texturesForRead","texturesForWrite","xStats","yStats","decoded_velocity_x","Float32Array","decoded_velocity_y","idx","updatePositionProgram_readFloat","vectorLineInfo","defaultConfig","isAudioEnabled","vectorLinesEnabled","FREE_TEXTURE_UNIT","showBindings","field_play_config","programs_audioProgram","audioProgram_audioProgram","audioWidth","audioHeight","audioBuffer","audioDirty","updateAudioBuffer","updateTextures","newBuffer","drawParticlesProgram","particleIndexBuffer","audioProgram","drawProgram","currentVectorField","updatePositionProgram","initPrograms","drawParticles","updateColorMode","updateColorVariable","initDrawProgram","drawGraph","vertexShaderCode","updateVariableForDrawProgram","particleIndices","particleStateX","particleStateY","deleteBuffer","a_index","u_particles_res","POINTS","url","download","req","XMLHttpRequest","updateProgress","lengthComputable","progress","loaded","total","percent","transferComplete","status","response","responseType","parse","transferFailed","transferCanceled","addEventListener","open","send","loadedLinks","Map","fetchGLSL","link","trimmed","trim","cachedResponse","then","pragmaInclude","nullCode","makePragmaParser","parsedLines","processLineByLine","pending","catch","lines","split","outputLines","currentIndex","processPragma","indexOf","include","substr","insertIndex","glslParser","check","log","errorCount","vectorFieldGlobals","getParsedVectorFieldFunction","vectorFieldCode","pragmaParseResult","parserResult","globals","parserError","diag","diagnostics","firstError","lineColumn","_lineOffsets","contents","column","substring","end","prefix","diagText","text","whitespace","errorDetail","isFloatError","Array","createVectorFieldEditorState","parseCode","currentVectorFieldVersion","currentVectorFieldCode","loadCodeFromAppState","setCode","trySetNewCode","cancelled","updateErrorInfo","persistedCode","customCode","currentResult","capturedVersion","message","createInputCollection","currentProgram","boundInputs","bindInput","inputIndex","inputBinding","prevBinding","updateInputBinding","input","updateBinding","loadTexture","resolveTexture","rejectTexture","image","Image","crossOrigin","reportError","level","internalFormat","srcFormat","srcType","isPowerOf2","generateMipmap","LINEAR","createImageInputBinding","callbacks","setTexture","handleError","loadedTexture","done","realIndex","createInputsModel","readInputsFromAppState","getInputs","addInput","inputNumber","vm","createInputElementViewModel","i0","pendingUpdate","immediate","setBinding","binding","INITIAL_SPEED","integrationTimeStepFromSpeed","speed","fadeOutFromSpeed","initScene","top","left","setWidthHeight","onResize","currentPanZoomTransform","DEPTH_TEST","STENCIL_TEST","lastAnimationFrame","lastAnimationFrameTime","createFramebuffer","isPaused","inputsModel","vectorFieldEditorState","nextFrame","stop","setPaused","getParticlesCount","setParticlesCount","setFadeOutSpeed","getFadeOutSpeed","getSpeed","setSpeed","setBackgroundColor","getCanvasRect","getBoundingBox","restoreBBox","parseInt","f","parseFloat","shouldPause","newParticleCount","updateBoundingBox","devicePixelRatio","canvas","style","removeEventListener","draw","timeSinceLastFrame","performanceRatio","correctedSpeed","drawScreen","ceil","E","clientX","clientY","FieldVisualizationvue_type_script_lang_ts_FieldVizualisation","FieldVizualisation","ctxOptions","antialias","updateVectorField","updateColorFunction","actuallyPaused","remove","toFixed","GLSLcode","k3","k4","k5","kColor","codeLines","circle","squares","whirl","cloverfield","ka","kb","FieldVisualizationvue_type_script_lang_ts_decorate","FieldVisualization_render","FieldVisualization_staticRenderFns","components_FieldVisualizationvue_type_script_lang_ts","FieldVisualization_component","FieldVisualization","index_es","library","faBluetooth_default","faBluetoothB_default","faPlayCircle_default","faPauseCircle_default","faCaretSquareDown_default","faCaretSquareUp_default","faPlay_default","faStop_default","faChartLine_default","faInfoCircle_default","faSyncAlt_default","faSlidersH_default","faTimes_default","MuseRecordervue_type_script_lang_ts_MuseRecorder","MuseRecorder","sessionInProgress","museClient","muse","connect","subscribe","cS","startSession","currentSessionSubscription","relativeBandPowers","pipe","operators","sessions","band","power","session","bandSession","find","NaN","reduce","sumOfSessions","bandSessionValue","rbps","arbps","rbp","some","freeze","takeRight","ALPHA","toConsumableArray","GAMMA","BETA_1","BETA_2","BETA_3","unsubscribe","location","MuseRecordervue_type_script_lang_ts_decorate","components","FontAwesomeIcon","vue_fontawesome_default","components_MuseRecordervue_type_script_lang_ts","MuseRecorder_component","components_MuseRecorder","Appvue_type_script_lang_ts_App","App","Appvue_type_script_lang_ts_decorate","src_Appvue_type_script_lang_ts","App_component","src_App","vue_runtime_esm","use","vuex_esm","store","Store","state","mutations","actions","register_service_worker","ready","cached","updated","offline","_error","productionTip","$mount"],"mappings":"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","file":"js/app.89ad7c13.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t2: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"0\":\"cae90ce0\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar head = document.getElementsByTagName('head')[0];\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\thead.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/brain-control/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([6,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * A simple message bus. Facilitates uncoupled communication between\n * components of fieldplay.\n */\nvar eventify = require('ngraph.events');\n\nmodule.exports = eventify({});","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=style&index=0&id=3840bb7b&scoped=true&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=style&index=0&id=3840bb7b&scoped=true&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=style&index=0&id=70aec022&scoped=true&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=style&index=0&id=70aec022&scoped=true&lang=scss\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"muse-recorder-app\"}},[_c('MuseRecorder')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder\"},[_c('div',{staticClass:\"muse-recorder__viz-container\"},[_c('field-visualization',{attrs:{\"alpha\":_vm.alpha,\"beta1\":_vm.beta1,\"beta2\":_vm.beta2,\"beta3\":_vm.beta3,\"gamma\":_vm.gamma,\"n\":_vm.n,\"paused\":_vm.paused}})],1),(_vm.n == 0)?_c('div',{staticClass:\"muse-recorder__greeting\",class:{'muse-recorder__greeting--connected': _vm.connectionStatus && !_vm.paused}},[_vm._m(0),_c('div',{staticClass:\"muse-recorder__greeting-tuto\"},[_c('div',{staticClass:\"muse-recorder__greeting-tuto-intro\"},[_vm._v(\"\\n        Turn on the headband, adjust it on your forehead and observe...\\n      \")]),_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.connectToMuse()}}},[_vm._v(\"\\n        Start \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"play\"}})],1),_c('div',{staticClass:\"muse-recorder__greeting-tuto-outro\"},[_vm._v(\"\\n        When your finished or before passing the headband to someone else, hit STOP \"),_c('font-awesome-icon',{staticStyle:{\"font-size\":\"smaller\"},attrs:{\"icon\":\"stop\"}})],1)])]):_vm._e(),(_vm.sessionsDetailsOpened)?_c('div',{staticClass:\"muse-recorder__session-details\"},[(_vm.currentSession.length)?_c('Session',{attrs:{\"sessionData\":_vm.currentSession}}):_c('div',[_vm._v(\"\\n      No session data\\n    \")])],1):_vm._e(),(_vm.sessionInProgress)?_c('div',{staticClass:\"muse-recorder__chart-toggle\",on:{\"click\":function($event){_vm.sessionsDetailsOpened = !_vm.sessionsDetailsOpened}}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', _vm.sessionsDetailsOpened ? 'times' : 'chart-line']}})],1):_vm._e(),(_vm.sessionInProgress)?_c('div',{staticClass:\"muse-recorder__stop-button\",on:{\"click\":function($event){_vm.stopSession()}}},[_vm._v(\"\\n    Stop \"),_c('font-awesome-icon',{attrs:{\"icon\":\"stop\"}})],1):_vm._e(),(_vm.vizControlsDisplayed)?_c('div',{staticClass:\"muse-recorder__viz-controls\"},[_c('div'),_c('button',{on:{\"click\":function($event){_vm.paused = !_vm.paused}}},[_vm._v(\" Play/pause viz\\n    \")]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.alpha),expression:\"alpha\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.01\"},domProps:{\"value\":(_vm.alpha)},on:{\"__r\":function($event){_vm.alpha=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"alpha: \"+_vm._s(_vm.alpha))])]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.beta1),expression:\"beta1\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.01\"},domProps:{\"value\":(_vm.beta1)},on:{\"__r\":function($event){_vm.beta1=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"beta1: \"+_vm._s(_vm.beta1))])]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.beta2),expression:\"beta2\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.01\"},domProps:{\"value\":(_vm.beta2)},on:{\"__r\":function($event){_vm.beta2=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"beta2: \"+_vm._s(_vm.beta2))])]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.beta3),expression:\"beta3\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.01\"},domProps:{\"value\":(_vm.beta3)},on:{\"__r\":function($event){_vm.beta3=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"beta3: \"+_vm._s(_vm.beta3))])]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.gamma),expression:\"gamma\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.01\"},domProps:{\"value\":(_vm.gamma)},on:{\"__r\":function($event){_vm.gamma=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"gamma: \"+_vm._s(_vm.gamma))])]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.n),expression:\"n\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"100\",\"step\":\"1\"},domProps:{\"value\":(_vm.n)},on:{\"__r\":function($event){_vm.n=_vm._n($event.target.value)},\"blur\":function($event){_vm.$forceUpdate()}}}),_c('pre',[_vm._v(\"n: \"+_vm._s(_vm.n))])]),_c('button',{on:{\"click\":function($event){_vm.reload()}}},[_vm._v(\" Not working? Reload the page\\n    \")])]):_vm._e(),_c('div',{staticClass:\"muse-recorder__viz-controls-toggle\",on:{\"click\":_vm.toggleVizControlsDisplayed}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', _vm.vizControlsDisplayed ? 'times' : 'sliders-h']}})],1),(_vm.infoPanelOpened)?_c('div',{staticClass:\"muse-recorder__info-panel\"},[_c('div',[_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.infoPanelOpened = false}}},[_vm._v(\"\\n        Close\\n      \")]),_vm._m(1),_vm._m(2),_vm._m(3),_c('p',[_vm._v(\"\\n        It's easy for some people to control their brainwaves in a way, while it's quite difficult to impossible for others.\\n        Take some time to try to calm yoursel or concentrate on something, or just let your mind wander and see what happens.\\n        One simple exercice some manage very well is to close your eyes for a few seconds and empty your mind: for some people ths triggers a load of alpha waves, which make the light blue circling vortex appear.\\n      \")]),_c('p',[_vm._v(\"\\n        It's very important to reset the device with the Stop button each time the headband changes heads.\\n        The levels can be different among people, so the system auto-calibrates in some seconds on the beginning of each session.\\n        Hitting stop/start reset this calibration.\\n      \")]),_vm._m(4),_vm._m(5),_vm._m(6),_c('div',{staticClass:\"muse-recorder__greeting-tuto-button\",on:{\"click\":function($event){_vm.infoPanelOpened = false}}},[_vm._v(\"\\n        Close\\n      \")])])]):_vm._e(),_c('div',{staticClass:\"muse-recorder__info-toggle\",on:{\"click\":function($event){_vm.infoPanelOpened = !_vm.infoPanelOpened}}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', _vm.infoPanelOpened ? 'times' : 'info-circle']}})],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder__greeting-title\"},[_c('div',{staticStyle:{\"font-size\":\"6em\"}},[_vm._v(\"Do you feel in control\")]),_c('div',{staticStyle:{\"font-size\":\"4em\"}},[_vm._v(\"of what's happenning\")]),_c('div',{staticStyle:{\"font-size\":\"8em\"}},[_vm._v(\"in your brain?\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_c('strong',[_vm._v(\"What is this installation?\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n        This installation uses a headband to listen to your brain eletrical rythms.\"),_c('br'),_vm._v(\"\\n        It then computes the power of particular rythms and translates them into a particles vizualisation.\\n      \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n        These rythms, called \\\"Alpha\\\", \\\"Beta\\\" and \\\"Gamma\\\" waves are the object of many scientific research to date.\\n        What they represent in tems of \\\"state of mind\\\" is not that easy to determine, and a scientific consensus about them is not yet reached.\"),_c('br'),_vm._v(\"\\n        Still, there is many knowledge and information about them in books and on the web, which I used to create this art: \"),_c('br'),_c('ul',[_c('li',[_vm._v(\"alpha waves are up in calm state\")]),_c('li',[_vm._v(\"beta waves are present when you're awake, and are divised in three:\\n            \"),_c('ul',[_c('li',[_vm._v(\"low-beta indicates regular awakeness, a \\\"fast idle\\\" mind\")]),_c('li',[_vm._v(\"mid-beta could appear when engaging or actively figuring something out\")]),_c('li',[_vm._v(\"high-beta would be the sign of highly complex thought, integrating new experiences, high anxiety or excitement\")])])]),_c('li',[_vm._v(\"it's speculated that gamma rhythms modulate perception and consciousness, and that a greater presence of gamma relates to expanded consciousness and spiritual emergence\")])]),_vm._v(\"\\n        Treat these interpretations with caution: they are not scientifcally endorsed and perception could vary a lot from one individual to another.\\n      \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n        I've been able to create this based on these amazing libraries:\\n        \"),_c('ul',[_c('li',[_vm._v(\"muse-js by Uri Shaked\")]),_c('li',[_vm._v(\"field-play by Andrei Kashcha\")]),_c('li',[_vm._v(\"DSP.js by Corban Brook\")])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n        Intrigued? A question? Wanna talk about it or just need some help?\"),_c('br'),_vm._v(\"\\n        Find David at Barrio Wonderever or contact me on Twitter or GitHub @davinov\\n      \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n        If you have Muse headband and a web-bluetooth enabled browser (Chrome on Android or Mac), you can reproduce at home with https://david.nowinsky.net/brain-control\"),_c('br'),_vm._v(\"\\n        Source code is available on https://github.com/davinov/brain-control\\n      \")])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"muse-recorder__session\"},[_c('svg',{staticClass:\"session__chart\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},_vm._l((_vm.series),function(serie){return _c('path',{key:serie,class:['session__serie', 'session__serie--' + serie.toLowerCase()],attrs:{\"d\":_vm.lineForSerie(serie)}})})),_c('div',{staticClass:\"session__legend\"},_vm._l((_vm.series),function(serie){return _c('div',{key:serie,class:['session__legend__item', 'session__legend__item--' + serie.toLowerCase()]},[_c('div',{staticClass:\"session__legend__item__color\"}),_c('span',[_vm._v(_vm._s(serie))]),_vm._v(\" - \"),_c('span',[_vm._v(\" \"+_vm._s(_vm.lastSessionPointForSerie(serie))+\" \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport _ from 'lodash';\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { AveragedRelativeBandPowers } from './MuseRecorder.vue';\nimport { line } from 'd3-shape';\nimport { scaleLinear } from 'd3-scale';\nimport { saveAs } from 'file-saver';\n\n@Component\nexport default class Session extends Vue {\n  @Prop({ default: [] })\n  sessionData: AveragedRelativeBandPowers[];\n  \n  @Prop({ default: 800 })\n  width: number;\n\n  @Prop({ default: 500 })\n  height: number;\n\n  get series(): string[] {\n    return Object.keys(this.sessionData[0] || {});\n  }\n\n  get xScale() {\n    return scaleLinear()\n      .domain([0, this.sessionData.length - 1])\n      .range([0, this.width]);\n  }\n\n  get yScale() {\n    return scaleLinear()\n      .domain([0, 0.5])\n      .range([this.height, 0]);\n  }\n\n  get lastSessionPointForSerie () {\n    let lastSessionPoint = _.last(this.sessionData);\n    return (serie) => {\n      if ( lastSessionPoint && lastSessionPoint[serie] )\n        return lastSessionPoint[serie];\n      else\n        return '-';\n    }\n  }\n\n  private lineForSerie(serie: string): string | null {\n    return line()(this.sessionData.map(\n      (v, i) => [\n        this.xScale(i),\n        this.yScale(v[serie])\n      ] as [number, number]\n    ));\n  }\n\n  private saveAsJSON(): void {\n    let blob = new Blob(\n      [JSON.stringify(this.sessionData, null, 2)],\n      {type: \"application/json;charset=utf-8\"}\n    );\n    let exportDate = new Date();\n    let filename = `muse-session-${exportDate.toISOString()}.json` \n    saveAs(blob, filename);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Session.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Session.vue?vue&type=template&id=684ff5ac&scoped=true\"\nimport script from \"./Session.vue?vue&type=script&lang=ts\"\nexport * from \"./Session.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Session.vue?vue&type=style&index=0&id=684ff5ac&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"684ff5ac\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"brain-visualization\",attrs:{\"height\":_vm.height,\"width\":_vm.width}},[_c('defs',[_c('filter',{attrs:{\"id\":\"goo\"}},[_c('feGaussianBlur',{attrs:{\"in\":\"SourceGraphic\",\"stdDeviation\":\"10\",\"result\":\"blur\"}}),_c('feColorMatrix',{attrs:{\"in\":\"blur\",\"mode\":\"matrix\",\"values\":\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -18\",\"result\":\"goo\"}}),_c('feComposite',{attrs:{\"in\":\"SourceGraphic\",\"in2\":\"goo\",\"operator\":\"atop\"}})],1)]),_c('g',{staticClass:\"brain-wires\"},_vm._l((_vm.brainWires(_vm.tk1, _vm.tk2)),function(wire,i){return _c('path',{key:i,staticClass:\"brain-wire\",attrs:{\"filter\":\"url(#goo)\",\"transform\":_vm.originTranslation,\"d\":wire,\"fill\":_vm.colors[i]}})}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport { line, lineRadial, arc, curveCardinal, curveNatural, curveMonotoneX, curveBasis } from 'd3-shape';\nimport { interpolateString, interpolateNumber, interpolate } from 'd3-interpolate';\nimport { easeCubicOut, easeCubicIn, easeCubic, easeCircle } from 'd3-ease';\n\n@Component\nexport default class Vizualisation extends Vue {\n  @Prop({ default: 1 })\n  k1: number;\n\n  @Prop({ default: 1 })\n  k2: number;\n\n  tk1: number = this.k1;\n  tk2: number = this.k2;\n\n  colors = ['#00f', '#0f0', '#f00'];\n  // colors = ['cyan', 'magenta', 'yellow'];\n\n  @Watch('k1')\n  animateK1 (targetVal: number) {\n    let duration = 1000;\n    let start = Date.now();\n    let interpolator = interpolateNumber(this.tk1 as number, targetVal);\n    let animate = () => {\n      let t = (Date.now() - start) / duration;\n      if (t >= 1) {\n        this.tk1 = targetVal;\n      } else {\n        requestAnimationFrame(animate);\n        this.tk1 = interpolator(t);\n      }\n    }\n    animate();\n  }\n\n  @Watch('k2')\n  animateK2 (targetVal: number) {\n    let duration = 1000;\n    let start = Date.now();\n    let interpolator = interpolateNumber(this.tk2 as number, targetVal);\n    let animate = () => {\n      let t = (Date.now() - start) / duration;\n      if (t >= 1) {\n        this.tk2 = targetVal;\n      } else {\n        requestAnimationFrame(animate);\n        this.tk2 = interpolator(t);\n      }\n    }\n    animate();\n  }\n\n  @Prop({ default: 800 })\n  height: number;\n\n  @Prop({ default: 800 })\n  width: number;\n\n  get originTranslation () {\n    return `translate(${this.width / 2}, ${this.height})`;\n  }\n\n  brainWires (k1: number, k2: number) {\n    return [-1/2, 0, 1/2].map(y => this.brainWire(k1, k2, y))\n  }\n\n  brainWire (k1: number, k2: number, y: number) {\n    let curve = line().curve(\n      curveCardinal.tension(y)\n    );\n\n    return curve(this.wirePoints(k1, k2, y));\n  }\n\n  wirePoints (k1: number, k2: number, y: number) {\n    let k = k1 + easeCircle(y) * (k2 - k1);\n\n    let masterPoints = [\n      this.leftPoint(k, y),\n      this.leftMiddlePoint(k, y),\n      this.middlePoint(k, y),\n      this.rightMiddlePoint(k, y),\n      this.rightPoint(k, y),\n    ]\n\n    let wireWidth = 100;\n\n    let points = masterPoints.map(\n      (p): [number, number] => [p[0], p[1] + wireWidth / 2]\n    ).concat(\n      masterPoints.reverse().map(\n        (p): [number, number] => [p[0], - p[1] - wireWidth / 2]\n      )\n    );\n\n    points.push(points[0]);\n\n    return points.map(this.verticalTranslation(- this.width / 2 - (1 - Math.max(k1, k2)) * 2 * y * this.radius));\n  }\n\n  get radius () {\n    return Math.sqrt(\n      Math.pow((this.width / 2), 2) + Math.pow((this.height / 2), 2)\n    ) / 2;\n  }\n\n  leftPoint (k: number, y: number): [number, number] {\n    return [\n      interpolateNumber(- this.width / 2, - this.radius)(easeCubicIn(k))\n    ,\n      interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  leftMiddlePoint (k: number, y: number): [number, number] {\n    let circleOrSquareRatio = interpolateNumber(Math.SQRT2 / 2, 1);\n\n    return [\n      interpolateNumber(- this.width / 4, - this.radius * circleOrSquareRatio(y))(easeCubicIn(k))\n    ,\n      interpolateNumber(0, - this.radius * circleOrSquareRatio(y))(easeCubic(k)) + interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  middlePoint (k: number, y: number): [number, number] {\n    return [\n      0\n    ,\n      interpolateNumber(0, - this.radius)(easeCubicOut(k)) + interpolateNumber(0, this.radius)( y * k )\n    ]\n  }\n\n  rightMiddlePoint (k: number, y: number): [number, number] {\n    return this.verticalSymetry(this.leftMiddlePoint(k, y));\n  }\n\n  rightPoint (k: number, y: number): [number, number] {\n    return this.verticalSymetry(this.leftPoint(k, y));\n  }\n\n  verticalSymetry (point: [number, number]): [number, number] {\n    return [\n      -point[0], point[1]\n    ]\n  }\n\n  horizontalSymetry (point: [number, number]): [number, number] {\n    return [\n      point[0], -point[1]\n    ]\n  }\n\n  verticalTranslation (dy: number) {\n    return function(point: [number, number]): [number, number] {\n      return [\n        point[0], dy + point[1]\n      ]\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Visualization.vue?vue&type=template&id=888b4562&scoped=true\"\nimport script from \"./Visualization.vue?vue&type=script&lang=ts\"\nexport * from \"./Visualization.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Visualization.vue?vue&type=style&index=0&id=888b4562&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"888b4562\",\n  null\n  \n)\n\nexport default component.exports","\nimport _ from 'lodash';\nimport { CreateElement, VNode } from 'vue';\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport {\n  Scene, Camera,\n  WebGLRenderer, PerspectiveCamera\n} from 'three';\n\nimport * as THREE from 'three';\n\nconst CAMERA_DISTANCE = 200;\nconst BOUNDS = {\n  X: CAMERA_DISTANCE * 2,\n  Y: CAMERA_DISTANCE * 2\n};\n\nconst CIRCLE_RADIUS = CAMERA_DISTANCE * Math.SQRT2;\nconst SQUARE_SIZE = CAMERA_DISTANCE;\nconst SQUARE_RADIUS = SQUARE_SIZE / 2;\n\nconst POINTS_COUNT = 1000\nconst POINTS_RENEWAL_CHANCE = 0.001;\n\n@Component\nexport default class ParticlesVizualisation extends Vue {\n  private scene: Scene;\n  private renderer: WebGLRenderer;\n  private camera: Camera;\n  private geometry: THREE.Geometry;\n  private points: THREE.Points;\n  private lastAnimationId: number | undefined;\n\n  @Prop({ required: true })\n  public k1: number;\n\n  @Prop({ required: true })\n  public k2: number;\n\n  @Prop({ default: false })\n  public paused: boolean;\n\n  created () {\n    this.scene = new Scene();\n\n    this.renderer = new WebGLRenderer({\n      preserveDrawingBuffer: true\n    });\n    this.renderer.autoClearColor = false;\n\n    this.camera = new PerspectiveCamera( 120, window.innerWidth / window.innerHeight, 0.1, 1000 );\n\n    // TRAIL EFFECT\n    // Create a semi-transparent plane\n    let fadeMaterial = new THREE.MeshBasicMaterial({\n      color: 0x000000,\n      transparent: true,\n      opacity: 0.04,\n      depthWrite: false\n    });\n    let fadePlane = new THREE.PlaneBufferGeometry(1, 1);\n    let fadeMesh = new THREE.Mesh(fadePlane, fadeMaterial);\n\n    // Group the plane and the camera in cameraGroup\n    let cameraGroup = new THREE.Object3D();\n    cameraGroup.add(this.camera);\n    cameraGroup.add(fadeMesh);\n    cameraGroup.translateZ(CAMERA_DISTANCE);\n\n    // Place the plane in front of the camera\n    fadeMesh.position.z = -0.1;\n\n    //Render the Make plane before points\n    fadeMesh.renderOrder = -1;\n\n    this.scene.add(cameraGroup);\n\n    // POINTS\n    let material = new THREE.PointsMaterial({\n      size: 2,\n      vertexColors: THREE.VertexColors,\n      opacity: 0.6,\n      transparent: true,\n      map: this.createCanvasMaterial('white', 64),\n      depthWrite: false\n    });\n    this.geometry = new THREE.Geometry();\n\n    _.times(POINTS_COUNT, this.addRandomPoint);\n    this.points = new THREE.Points(this.geometry, material);\n\n    this.scene.add(this.points);\n  }\n\n  randomPositionOnPlane () {\n    return new THREE.Vector3(\n      2 * (Math.random() - 0.5) * BOUNDS.X,\n      2 * (Math.random() - 0.5) * BOUNDS.Y,\n      0\n    )\n  }\n\n  addRandomPoint () {\n    this.geometry.vertices.push(this.randomPositionOnPlane());\n\n    this.geometry.colors.push(new THREE.Color(\n      Math.random(), Math.random(), Math.random()\n    ));\n  }\n\n  mounted () {\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.animate();\n    this.$el.appendChild(this.renderer.domElement);\n  }\n\n  get horizontalWeigth () {\n    return 1 - Math.max(this.k1, this.k2);\n  }\n\n  get circleWeigth () {\n    if ((this.k1 + this.k2) === 0)\n      return 0\n    return this.k1;\n  }\n\n  get squareWeigth () {\n    if ((this.k1 + this.k2) === 0)\n      return 0\n    return this.k2;\n  }\n\n  animate () {\n    // Re-randomly position some of the points\n    this.geometry.vertices.map((vertice) => {\n      if (Math.random() <= POINTS_RENEWAL_CHANCE) {\n        let v = this.randomPositionOnPlane();\n        vertice.set(v.x, v.y, v.z);\n        this.geometry.verticesNeedUpdate = true;\n      }\n    });\n\n    // Move points\n    if ( !_.isNaN(this.k1) && !_.isNaN(this.k2) ) {\n      this.geometry.vertices.map( (particle) => {\n        let h = this.horizontalMovement(particle);\n        let c = this.circularMovement(particle);\n        let s = this.squareMovement(particle);\n\n        let weightedMovementAlongAxis = (h: number, c: number, s: number): number =>\n          this.circleWeigth * c + this.squareWeigth * s + this.horizontalWeigth * h\n\n        let movement: [number, number] = [\n          weightedMovementAlongAxis(h[0], c[0], s[0]),\n          weightedMovementAlongAxis(h[1], c[1], s[1])\n        ]\n        this.moveParticle(\n          particle, movement\n        );\n      });\n\n      this.geometry.verticesNeedUpdate = true;\n    }\n\n    this.geometry.colors.map( (particleColor) => {\n      let dX, dY, dZ;\n      dX = (Math.random() - .5 ) / 5;\n      dY = (Math.random() - .5 ) / 5;\n      dZ = (Math.random() - .5 ) / 5;\n\n      particleColor.add(new THREE.Color(dX, dY, dZ));\n    });\n    this.geometry.colorsNeedUpdate = true;\n\n    this.renderer.render(this.scene, this.camera);\n    this.continue()\n  }\n\n  createCanvasMaterial (color: string, size: number): THREE.Texture {\n    let matCanvas = document.createElement('canvas');\n    matCanvas.width = matCanvas.height = size;\n    let matContext = matCanvas.getContext('2d');\n    let texture = new THREE.Texture(matCanvas);\n    if (!matContext)\n      return new THREE.Texture();\n\n    // Circle\n    let center = size / 2;\n    matContext.beginPath();\n    matContext.arc(center, center, center, 0, 2 * Math.PI);\n    matContext.closePath();\n    matContext.fillStyle = color;\n    matContext.fill();\n\n    texture.needsUpdate = true;\n    return texture;\n  }\n\n  moveParticle (particle: THREE.Vertex, movement: [number, number]) {\n    particle.x += movement[0];\n    particle.y += movement[1];\n\n    if (particle.x > BOUNDS.X)\n      particle.x = -1 * BOUNDS.X;\n    if (particle.x < -1 * BOUNDS.X)\n      particle.x = BOUNDS.X;\n    if (particle.y > BOUNDS.Y)\n      particle.y = -1 * BOUNDS.Y;\n    if (particle.y < -1 * BOUNDS.Y)\n      particle.y = BOUNDS.Y;\n  }\n\n  horizontalMovement (particle: THREE.Vertex): [number, number] {\n    return [\n      1,\n      Math.sin(particle.x / 16 / Math.PI) / 2\n    ];\n  }\n\n  circularMovement (particle: THREE.Vertex): [number, number] {\n    let r = Math.pow( Math.pow(particle.x, 2) + Math.pow(particle.y, 2) , .5);\n    let θ = Math.atan2(particle.y, particle.x);\n\n    // Movement towards the circle\n    let dr = (CIRCLE_RADIUS - r) / 250; // 250 frames to match the circle\n    // Movement along the circle\n    let dθ = 2 * Math.PI / 2000; // 1000 frames to complete the circle\n\n    return [\n      dr * Math.cos(θ) - r * Math.sin(θ) * dθ,\n      dr * Math.cos(θ) + r * Math.cos(θ) * dθ\n    ];\n  }\n\n  squareMovement (particle: THREE.Vertex) {\n    let x = particle.x;\n    let y = particle.y;\n\n    let dx: number;\n    let dy: number;\n    let r: number;\n    let dr = (x: number, y: number, r: number): [number, number] => [0, 0]\n\n    if (x >= 0) {\n      dy = 1;\n      if (y >= 0) {\n        r = y / (1 - x); \n        dx = -1;\n      } else { // y < 0\n        r = y / (x - 1); \n        dx = 1;\n      }\n    } else { // x < 0\n      dy = -1;\n      if (y > 0) {\n        r = y / (x + 1); \n        dx = -1;\n      } else { // y < 0\n        r = y / (-1 - x); \n        dx = 1;\n      }\n    }\n\n    // let dr = (SQUARE_SIZE - r) / 1000;\n\n    return [dx, dy];\n  }\n\n  continue () {\n    if (!this.paused)\n      this.lastAnimationId = window.requestAnimationFrame(this.animate);\n  }\n\n  pause () {\n    if (this.lastAnimationId)\n      window.cancelAnimationFrame(this.lastAnimationId);\n    this.lastAnimationId = undefined;\n  }\n\n  @Watch('paused')\n  onPausedChanged () {\n    this.paused ? this.pause() : this.continue()\n  }\n\n  render (h: CreateElement): VNode {\n    return h('div', { class: 'brain-particles' });\n  }\n\n  destroyed () {\n    this.pause();\n    this.renderer.dispose();\n    this.geometry.dispose();\n  }\n}\n","var render, staticRenderFns\nimport script from \"./ParticlesVisualization.vue?vue&type=script&lang=ts\"\nexport * from \"./ParticlesVisualization.vue?vue&type=script&lang=ts\"\nimport style0 from \"./ParticlesVisualization.vue?vue&type=style&index=0&id=2f884374&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f884374\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticlesVisualization.vue?vue&type=script&lang=ts\"","/**\n * This file is based on https://github.com/mapbox/webgl-wind\n * by Vladimir Agafonkin\n * \n * Released under ISC License, Copyright (c) 2016, Mapbox\n * https://github.com/mapbox/webgl-wind/blob/master/LICENSE\n * \n * Adapted to field maps by Andrei Kashcha\n * Copyright (C) 2017\n */\nexport default {\n  createTexture: createTexture,\n  bindFramebuffer: bindFramebuffer,\n  createProgram: createProgram, \n  createBuffer: createBuffer,\n  bindAttribute: bindAttribute,\n  bindTexture: bindTexture\n}\n\nfunction bindTexture(gl, texture, unit) {\n  gl.activeTexture(gl.TEXTURE0 + unit);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n}\n\nfunction createBuffer(gl, data) {\n  var buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n  return buffer;\n}\n\nfunction createTexture(gl, filter, data, width, height) {\n  var texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n  if (data instanceof Uint8Array) {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n  } else {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n  }\n  gl.bindTexture(gl.TEXTURE_2D, null);\n  return texture;\n}\n\nfunction bindFramebuffer(gl, framebuffer, texture) {\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n  if (texture) {\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n  }\n}\n\nfunction bindAttribute(gl, buffer, attribute, numComponents) {\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.enableVertexAttribArray(attribute);\n  gl.vertexAttribPointer(attribute, numComponents, gl.FLOAT, false, 0, 0);\n}\n\nfunction createProgram(gl, vertexSource, fragmentSource) {\n  var program = gl.createProgram();\n\n  var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexSource);\n  var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentSource);\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      throw new Error(gl.getProgramInfoLog(program));\n  }\n\n  var wrapper = {\n    program: program,\n    unload: unload\n  };\n\n  var numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n  var i;\n  for (i = 0; i < numAttributes; i++) {\n      var attribute = gl.getActiveAttrib(program, i);\n      wrapper[attribute.name] = gl.getAttribLocation(program, attribute.name);\n  }\n  var numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  for (i = 0; i < numUniforms; i++) {\n      var uniform = gl.getActiveUniform(program, i);\n      wrapper[uniform.name] = gl.getUniformLocation(program, uniform.name);\n  }\n\n  return wrapper; \n\n  function unload() {\n    gl.deleteProgram(program);\n  }\n}\n\nfunction createShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new Error(gl.getShaderInfoLog(shader));\n  }\n\n  return shader;\n}","/**\n * Various color modes.\n */\nexport default {\n  /**\n   * Each particle gets its own color\n   */\n  UNIFORM: 1,\n\n  /**\n   * Color of a particle depends on its velocity\n   */\n  VELOCITY: 2,\n\n  /**\n   * Color of a particle depends on its velocity vector angle.\n   */\n  ANGLE: 3,\n\n  /**\n   * The color comes from a shader. WIP\n   */\n  CUSTOM: 4\n}","/**\n * Wraps a simple vector field string into our default shader code.\n * @param {String} field \n */\nexport default function wrapVectorField(field) {\n  return `// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  ${field}\n\n  return v;\n}`\n}","/**\n * Checks whether current window belongs to a \"Small\" screen\n * size. Small screens have slightly different initial behavior.\n * E.g. the settings window is always collapsed.\n * \n * This needs to be in sync with `small-screen` variable in\n *  ../commponents/shared.styl\n */\nexport default function isSmallScreen() {\n  return window.innerWidth < 600\n}\n","import queryState from 'query-state';\nimport bus from './bus';\nimport ColorModes from './programs/colorModes';\nimport wrapVectorField from './wrapVectorField';\nimport isSmallScreen from './isSmallScreen';\n\n/**\n * The state of the fieldplay is stored in the query string. This is the\n * only place where query string can be manipulated or fetched.\n */\n\nvar qs = queryState({}, {\n  useSearch: true,\n  // Older version of the app used hash to store application arguments.\n  // Turns out hash is not good for websites like reddit. They can block\n  // url, saying \"url was already submitted\" if the only part that is different\n  // is hash. So, we switch to search string, and maintain backward compatibility\n  // for fields created before.\n  rewriteHashToSearch: true\n});\n\nvar currentState = {}; //qs.get();\n\nvar defaultVectorField = wrapVectorField(`v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;`);\n\nvar pendingSave;\nvar defaults = {\n  timeStep: 0.01,\n  dropProbability: 0.009,\n  particleCount: 10000,\n  fadeout: .998,\n  colorMode: ColorModes.UNIFORM\n}\n\nlet settingsPanel = {\n  collapsed: isSmallScreen(),\n};\n\nexport default {\n  settingsPanel,\n  saveBBox,\n  getBBox,\n  makeBBox,\n  getQS() { return qs; },\n  saveCode,\n  getCode,\n  getDefaultCode,\n\n  getDropProbability,\n  setDropProbability,\n\n  getIntegrationTimeStep,\n  setIntegrationTimeStep,\n\n  getParticleCount,\n  setParticleCount,\n\n  getFadeout,\n  setFadeout,\n\n  getColorMode,\n  setColorMode,\n\n  getColorFunction,\n  setColorFunction\n}\n\nqs.onChange(function() {\n  bus.fire('scene-ready', window.scene);\n});\n\nfunction getColorMode() {\n  let colorMode = qs.get('cm');\n  return defined(colorMode) ? colorMode : defaults.colorMode;\n}\n\nfunction setColorMode(colorMode) {\n  if (!defined(colorMode)) return;\n  // qs.set({cm: colorMode});\n  currentState.cm = colorMode;\n}\n\nfunction getColorFunction() {\n  let colorFunction = qs.get('cf');\n  return colorFunction || '';\n}\n\nfunction setColorFunction(colorFunction) {\n  // qs.set({cf: colorFunction});\n  currentState.cf = colorFunction;\n}\n\nfunction getFadeout() {\n  let fadeout = qs.get('fo');\n  return defined(fadeout) ? fadeout : defaults.fadeout;\n}\n\nfunction setFadeout(fadeout) {\n  if (!defined(fadeout)) return;\n  // qs.set({fo: fadeout});\n  currentState.fo = fadeout;\n}\n\nfunction getParticleCount() {\n  let particleCount = qs.get('pc');\n  return defined(particleCount) ? particleCount : defaults.particleCount;\n}\n\nfunction setParticleCount(particleCount) {\n  if (!defined(particleCount)) return;\n  // qs.set({pc: particleCount});\n  currentState.pc = particleCount;\n}\n\nfunction getIntegrationTimeStep() {\n  let timeStep = qs.get('dt');\n  return defined(timeStep) ? timeStep : defaults.timeStep;\n}\n\nfunction setIntegrationTimeStep(dt) {\n  if (!defined(dt)) return;\n  // qs.set({dt: dt})\n  currentState.dt = dt;\n}\n\nfunction getDropProbability() {\n  let dropProbability = qs.get('dp');\n  return defined(dropProbability) ? dropProbability : defaults.dropProbability;\n}\n\nfunction setDropProbability(dropProbability) {\n  if (!defined(dropProbability)) return;\n  clamp(dropProbability, 0, 1);\n  // qs.set({dp: dropProbability})\n}\n\nfunction getBBox() {\n  let cx = qs.get('cx');\n  let cy = qs.get('cy');\n  let w = qs.get('w');\n  let h = qs.get('h');\n  return makeBBox(cx, cy, w, h);\n}\n\nfunction makeBBox(cx, cy, w, h) {\n  let bboxDefined = defined(cx) && defined(cy) && defined(w) && defined(h);\n  if (!bboxDefined) return;\n\n  let w2 = w/2;\n  let h2 = h/2;\n  var p = 10000;\n  return {\n    minX: Math.round(p * (cx - w2))/p,\n    maxX: Math.round(p * (cx + w2))/p,\n    minY: Math.round(p * (cy - h2))/p,\n    maxY: Math.round(p * (cy + h2))/p\n  };\n}\n\nfunction saveBBox(bbox, immediate = false) {\n  bbox = {\n    cx: (bbox.minX + bbox.maxX) * 0.5,\n    cy: (bbox.minY + bbox.maxY) * 0.5,\n    w: (bbox.maxX - bbox.minX),\n    h: (bbox.maxX - bbox.minX)\n  }\n\n  if (bbox.w <= 0 || bbox.h <= 0) return;\n\n  currentState.cx = bbox.cx;\n  currentState.cy = bbox.cy;\n  currentState.w = bbox.w;\n  currentState.h = bbox.h;\n\n  if(pendingSave) {\n    clearTimeout(pendingSave);\n    pendingSave = 0;\n  }\n\n  // if (immediate) qs.set(bbox);\n  else {\n    pendingSave = setTimeout(() => {\n      pendingSave = 0;\n      // qs.set(bbox);\n    }, 300);\n  }\n}\n\nfunction getCode() {\n  var vfCode = qs.get('vf');\n  if (vfCode) return vfCode;\n\n  // If we didn't get code yet, let's try read to read it from previous version\n  // of the API.\n  // TODO: Need to figure out how to develop this in backward/future compatible way.\n  var oldCode = qs.get('code');\n  if (oldCode) {\n    vfCode = wrapVectorField(oldCode);\n    // side effect - let's clean the old URL\n    delete(currentState.code);\n    // qs.set('vf', vfCode);\n    return vfCode;\n  }\n\n  return defaultVectorField;\n}\n\nfunction getDefaultCode() {\n  return defaultVectorField;\n}\n\nfunction saveCode(code) {\n  // qs.set({\n  //   vf: code\n  // });\n  currentState.code = code;\n}\n\nfunction defined(number) {\n  return Number.isFinite(number);\n}\n\nfunction clamp(x, min, max) {\n  return x < min ? min :\n        (x > max) ? max : x;\n}\n","/**\n * Renders computed state onto the screen.\n */\nimport glUtils from '../gl-utils';\n\nconst NO_TRANSFORM = {dx: 0, dy: 0, scale: 1};\n\nexport default function makeScreenProgram(ctx) {\n  var {gl, canvasRect} = ctx;\n\n  var screenTexture, backgroundTexture;\n  var boundBoxTextureTransform = {dx: 0, dy: 0, scale: 1};\n  var lastRenderedBoundingBox = null;\n\n  updateScreenTextures();\n  var screenProgram = glUtils.createProgram(gl, getScreenVertexShader(), getScreenFragmentShader());\n  \n  var api = {\n    fadeOutLastFrame,\n    renderCurrentScreen,\n    updateScreenTextures,\n\n    boundingBoxUpdated: false\n  };\n\n  return api;\n  \n  function fadeOutLastFrame() {\n    // render to the frame buffer\n    glUtils.bindFramebuffer(gl, ctx.framebuffer, screenTexture);\n    gl.viewport(0, 0, canvasRect.width, canvasRect.height);\n\n    if (api.boundingBoxUpdated && lastRenderedBoundingBox) {\n      // We move the back texture, relative to the bounding box change. This eliminates\n      // particle train artifacts, though, not all of them: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n      // If you know how to improve this - please let me know.\n      boundBoxTextureTransform.dx = -(ctx.bbox.minX - lastRenderedBoundingBox.minX)/(ctx.bbox.maxX - ctx.bbox.minX);\n      boundBoxTextureTransform.dy = -(ctx.bbox.minY - lastRenderedBoundingBox.minY)/(ctx.bbox.maxY - ctx.bbox.minY);\n      boundBoxTextureTransform.scale = (ctx.bbox.maxX - ctx.bbox.minX) / (lastRenderedBoundingBox.maxX - lastRenderedBoundingBox.minX);\n      drawTexture(backgroundTexture, ctx.fadeOpacity, boundBoxTextureTransform);\n    } else {\n      drawTexture(backgroundTexture, ctx.fadeOpacity, NO_TRANSFORM)\n    }\n  }\n\n  function renderCurrentScreen() {\n    glUtils.bindFramebuffer(gl, null);\n\n    saveLastBbox();\n\n    gl.enable(gl.BLEND); \n    gl.blendFunc(gl.SRC_ALPHA, gl.DST_ALPHA);\n    gl.clearColor(ctx.backgroundColor.r, ctx.backgroundColor.g, ctx.backgroundColor.b, ctx.backgroundColor.a);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    drawTexture(screenTexture, 1.0, NO_TRANSFORM);\n    gl.disable(gl.BLEND);\n\n    var temp = backgroundTexture;\n    backgroundTexture = screenTexture;\n    screenTexture = temp;\n\n    api.boundingBoxUpdated = false;\n    if (window.audioTexture) {\n      drawTexture(window.audioTexture, 1.0, NO_TRANSFORM);\n    }\n  }\n\n  function updateScreenTextures() {\n    var {width, height} = canvasRect;\n    var emptyPixels = new Uint8Array(width * height * 4);\n    if (screenTexture) {\n      gl.deleteTexture(screenTexture);\n    }\n    if (backgroundTexture) {\n      gl.deleteTexture(backgroundTexture);\n    }\n\n    screenTexture = glUtils.createTexture(gl, gl.NEAREST, emptyPixels, width, height);\n    backgroundTexture = glUtils.createTexture(gl, gl.NEAREST, emptyPixels, width, height);\n  }\n\n  function saveLastBbox() {\n    if (!lastRenderedBoundingBox) {\n      lastRenderedBoundingBox = {\n        minX: ctx.bbox.minX,\n        minY: ctx.bbox.minY,\n        maxX: ctx.bbox.maxX,\n        maxY: ctx.bbox.maxY\n      }\n\n      return;\n    } \n\n    lastRenderedBoundingBox.minX = ctx.bbox.minX;\n    lastRenderedBoundingBox.minY = ctx.bbox.minY;\n    lastRenderedBoundingBox.maxX = ctx.bbox.maxX;\n    lastRenderedBoundingBox.maxY = ctx.bbox.maxY;\n  }\n\n  function drawTexture(texture, opacity, textureTransform) {\n    var program = screenProgram;\n    gl.useProgram(program.program);\n    glUtils.bindAttribute(gl, ctx.quadBuffer, program.a_pos, 2);\n\n    // TODO: This index is very fragile. I need to find a way\n    glUtils.bindTexture(gl, texture, ctx.screenTextureUnit);\n    gl.uniform1i(program.u_screen, ctx.screenTextureUnit);\n\n    gl.uniform1f(program.u_opacity_border, 0.02);\n    gl.uniform1f(program.u_opacity, opacity);\n    gl.uniform3f(program.u_transform, textureTransform.dx, textureTransform.dy, textureTransform.scale);\n\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n}\n\nfunction getScreenVertexShader() {\n  return `// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}`\n}\n\nfunction getScreenFragmentShader() {\n  return `precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n}`\n}","/**\n * A shader function to decode rgba encoded color into float position.\n */\nconst code = `\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n`\n\nexport default code;","export default class BaseShaderNode {\n  constructor() { }\n  getDefines() { return ''; }\n  getFunctions() { return ''; }\n  getMainBody() { return ''; }\n}\n","//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvar code = `\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n`\n\nexport default code;","export function getInputUniforms() {\n  return `uniform sampler2D input0;\nuniform sampler2D input1;`;\n}","import BaseShaderNode from './BaseShaderNode';\nimport snoise from './parts/simplex-noise';\nimport {getInputUniforms} from './customInput';\n\nexport default class UserDefinedVelocityFunction extends BaseShaderNode {\n  constructor(updateCode) {\n    super();\n    this.updateCode = updateCode || '';\n  }\n\n  setNewUpdateCode(newUpdateCode) {\n    this.updateCode = newUpdateCode;\n  }\n\n  getDefines() {\n    return `\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\nuniform float u_k1;\nuniform float u_k2;\nuniform float u_k3;\nuniform float u_k4;\nuniform float u_k5;\n\n#define PI 3.1415926535897932384626433832795\n\n${getInputUniforms()}\n`\n  }\n\n  getFunctions() {\n  // TODO: Do I need to worry about \"glsl injection\" (i.e. is there potential for security attack?)\n  // TODO: Do I need to inject snoise only when it's used?\n    return `\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n${snoise}\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n${this.updateCode ? this.updateCode : 'vec2 get_velocity(vec2 p) { return vec2(0.); }'}\n  `\n  }\n}\n","import BaseShaderNode from './BaseShaderNode';\n\nexport default class RungeKuttaIntegrator extends BaseShaderNode {\n  constructor () {\n    super();\n  }\n\n  getDefines() {\n    return `\nuniform float u_h;\n`\n  }\n\n  getFunctions() {\n    return `\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}`\n  }\n\n  getMainBody() {\n    return `\n  vec2 velocity = rk4(pos);\n`\n  }\n}","import UserDefinedVelocityFunction from './UserDefinedVelocityFunction';\nimport RungeKuttaIntegrator from './RungeKuttaIntegrator';\nimport ColorModes from '../programs/colorModes';\n\nexport default function shaderBasedColor(colorMode, vfCode, colorCode) {\n  var udf = new UserDefinedVelocityFunction(vfCode);\n  var integrate = new RungeKuttaIntegrator();\n\n  return {\n    getVariables,\n    getMain,\n    getMethods\n  }\n\n  function getVariables() {\n    return `\nuniform vec2 u_velocity_range;\nuniform float u_k;\nvarying vec4 v_particle_color;\n\n${udf.getDefines()}\n${integrate.getDefines()}\n`\n  }\n\n  function getMethods() {\n    return `\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n${udf.getFunctions()}\n${integrate.getFunctions()}\n${getColorFunctionBody()}\n`\n  }\n\n  function getColorFunctionBody() {\n    if (colorMode === ColorModes.UNIFORM) {\n      return `\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n`\n    }\n    if (colorMode === ColorModes.VELOCITY) {\n      return colorCode || `\n        vec4 get_color(vec2 p) {\n          vec2 velocity = get_velocity(p);\n          float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n          float hue = 0.05 + (1. - speed) * 0.5;\n          return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n        }\n      `;\n    }\n\n    if (colorMode === ColorModes.CUSTOM) {\n      if (!colorCode) throw new Error('color mode is set to custom, but no color function is specified');\n      return colorCode;\n    }\n\n    return ` \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n`;\n  }\n\n  function getMain() {\n    return `  v_particle_color = get_color(v_particle_pos);`\n  }\n}\n","import decodeFloatRGBA from './parts/decodeFloatRGBA';\nimport shaderBasedColor from './shaderBasedColor';\n\n// TODO: this duplicates code from texture position.\nexport default class DrawParticleGraph {\n  constructor(ctx) {\n    this.colorMode = ctx.colorMode;\n    this.colorFunction = ctx.colorFunction || '';\n  }\n\n  getFragmentShader() {\n    return `precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}`\n  }\n\n  getVertexShader(vfCode) {\n    let decodePositions = textureBasedPosition();\n    let colorParts = shaderBasedColor(this.colorMode, vfCode, this.colorFunction);\n    let methods = []\n    addMethods(decodePositions, methods);\n    addMethods(colorParts, methods);\n    let main = [];\n    addMain(decodePositions, main);\n    addMain(colorParts, main);\n\n    return `precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n${decodePositions.getVariables() || ''}\n${colorParts.getVariables()}\n\n${decodeFloatRGBA}\n\n${methods.join('\\n')}\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n${main.join('\\n')}\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}`\n  }\n}\n\nfunction addMethods(producer, array) {\n  if (producer.getMethods) {\n    array.push(producer.getMethods());\n  }\n}\n\nfunction addMain(producer, array) {\n  if (producer.getMain) {\n    array.push(producer.getMain());\n  }\n}\n\nfunction textureBasedPosition() {\n  return {\n    getVariables,\n    getMain\n  }\n\n  function getVariables() {\n    return `\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    `\n  }\n\n  function getMain() {\n    return `\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n`\n  }\n}","const code = `\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n`\n\nexport default code;","import BaseShaderNode from './BaseShaderNode';\nimport encodeFloatRGBA from './parts/encodeFloatRGBA';\nimport decodeFloatRGBA from './parts/decodeFloatRGBA';\n\n/**\n * Reads/writes particle coordinates from/to a texture;\n */\nexport default class TexturePosition extends BaseShaderNode {\n  constructor(isDecode) {\n    super();\n\n    // When it's decoding, it must read from the texture.\n    // Otherwise it must write to the texture;\n    this.isDecode = isDecode;\n  }\n\n  getFunctions() {\n    if (this.isDecode) {\n      return `\n    ${encodeFloatRGBA}\n    ${decodeFloatRGBA}\n`\n    }\n  }\n\n  getDefines() {\n    if (this.isDecode) {\n      // TODO: How to avoid duplication and silly checks?\n    return `\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n`;\n    }\n  }\n\n  getMainBody() {\n  if (this.isDecode) {\n    return `\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n`\n    }\n    return `\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n`\n  }\n}","\nexport default function renderNodes(nodes) {\n  let code = [] \n\n  nodes.forEach(node => { if (node.getDefines) addToCode(node.getDefines()); });\n  nodes.forEach(node => { if (node.getFunctions) addToCode(node.getFunctions()); });\n\n  addToCode('void main() {')\n    nodes.forEach(node => { if (node.getMainBody) addToCode(node.getMainBody()); });\n  addToCode('}')\n  return code.join('\\n');\n\n  function addToCode(line) {\n    if (line) code.push(line)\n  }\n}\n","import BaseShaderNode from './BaseShaderNode';\n\nexport default class PanzoomTransform extends BaseShaderNode {\n  constructor(config) {\n    super();\n    // decode is used when we move particle read from the texture\n    // otherwise we write particle to texture and need to reverse transform\n    this.decode = config && config.decode;\n    this.srcPosName = (config && config.posName) || 'pos';\n  }\n\n  getDefines() {\n    if (this.decode) {\n      // TODO: Need to figure out how to not duplicate this.\n    return `\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n`;\n    }\n  }\n\n  getMainBody() {\n    if (this.decode) {\n      return `\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = ${this.srcPosName}.x * du.x + u_min.x;\n  pos.y = ${this.srcPosName}.y * du.y + u_min.y;\n`\n    }\n    return `\n  pos.x = (${this.srcPosName}.x - u_min.x)/du.x;\n  pos.y = (${this.srcPosName}.y - u_min.y)/du.y;\n`\n  }\n}","import BaseShaderNode from './BaseShaderNode';\nimport TexturePositionNode from './TexturePositionNode';\nimport renderNodes from './renderNodes';\nimport UserDefinedVelocityFunction from './UserDefinedVelocityFunction';\nimport PanzoomTransform from './PanzoomTransform';\nimport RungeKuttaIntegrator from './RungeKuttaIntegrator';\n\nexport default class UpdatePositionGraph {\n  constructor(options) {\n    this.readStoredPosition = new TexturePositionNode(/* isDecode = */ true);\n    this.udfVelocity = new UserDefinedVelocityFunction();\n    this.integratePositions = new RungeKuttaIntegrator();\n    this.dropParticles = new RandomParticleDropper();\n    this.writeComputedPosition = new TexturePositionNode(/* isDecode = */ false);\n    this.panZoomDecode = new PanzoomTransform({decode: true});\n    this.panZoomEncode = new PanzoomTransform({decode: false});\n\n    this.colorMode = options && options.colorMode;\n  }\n\n  setCustomVectorField(velocityCode) {\n    this.udfVelocity.setNewUpdateCode(velocityCode);\n  }\n\n  getVertexShader () {\n    return `precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}`\n  }\n\n  getFragmentShader() {\n    var nodes = [\n      this.readStoredPosition,\n      this.dropParticles,\n      this.udfVelocity,\n      this.integratePositions, {\n        getMainBody() {\n          return `\n  vec2 newPos = pos + velocity;\n  `\n        }\n      },\n      this.writeComputedPosition\n    ];\n    return renderNodes(nodes);\n  }\n}\n\nclass RandomParticleDropper extends BaseShaderNode {\n  getDefines() {\n    return `\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n`\n  }\n\n  getFunctions() {\n    // TODO: Ideally this node should probably depend on\n    // random number generator node, so that we don't duplicate code\n    return `\n`\n  }\n\n  getMainBody() {\n    return `\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n`;\n  }\n\n}","/**\n * This file encodes/decodes float values into 32bit rgba array\n * \n * It is based on https://computergraphics.stackexchange.com/questions/4151/webgl-packing-unpacking-functions-that-can-roundtrip-all-typical-32-bit-floats\n * and it is not perfect. If you know how to improve it - please let me know.\n */\n\n/**\n * Encodes float value into output array\n * @param {float} val - value to be encode\n * @param {Uint8Array} out  - array where encoded value needs to be written.\n * @param {Number} writeOffset - offset in the original array where values should be written.\n */\nexport function encodeFloatRGBA(val, out, writeOffset) {\n  if (val == 0.0) {\n    out[writeOffset + 0] = 0; out[writeOffset + 1] = 0; out[writeOffset + 2] = 0; out[writeOffset + 3] = 0;\n    return;\n  }\n\n  var mag = Math.abs(val);\n  var exponent = Math.floor(Math.log2(mag));\n  // Correct log2 approximation errors.\n  exponent += (exp2(exponent) <= mag / 2.0) ? 1 : 0;\n  exponent -= (exp2(exponent) > mag) ? 1 : 0;\n\n  var mantissa;\n  if (exponent > 100.0) {\n      mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n  } else {\n      mantissa = mag / (exp2(exponent)) - 1.0;\n  }\n\n  var a = exponent + 127.0;\n  mantissa *= 256.0;\n  var b = Math.floor(mantissa);\n  mantissa -= b;\n  mantissa *= 256.0;\n  var c = Math.floor(mantissa);\n  mantissa -= c;\n  mantissa *= 128.0;\n  var d = Math.floor(mantissa) * 2.0 + ((val < 0.0) ? 1: 0);\n\n  out[writeOffset + 0] = a; out[writeOffset + 1] = b; out[writeOffset + 2] = c; out[writeOffset + 3] = d;\n}\n\n/**\n * Given byte values in range [0..255] returns decoded float value.\n * \n * @param {Byte} r \n * @param {Byte} g \n * @param {Byte} b \n * @param {Byte} a \n */\nexport function decodeFloatRGBA(r, g, b, a) {\n  var A = Math.floor(r + 0.5);\n  var B = Math.floor(g + 0.5);\n  var C = Math.floor(b + 0.5);\n  var D = Math.floor(a + 0.5);\n\n  var exponent = A - 127.0;\n  var sign = 1.0 - (D % 2.0) * 2.0;\n  var mantissa = ((A > 0.0) ? 1 : 0)\n                  + B / 256.0\n                  + C / 65536.0\n                  + Math.floor(D / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n\nfunction exp2(exponent) { return Math.exp(exponent * Math.LN2); }","/**\n * A simple interface to compute eventual min/max \n */\nexport default function makeStatCounter() {\n  var min, max;\n\n  var api = {\n    getMin() { return min; },\n    getMax() { return max; },\n    add(x) {\n      if (x < min) min = x;\n      if (x > max) max = x;\n    },\n    reset: reset\n  };\n\n  return api;\n\n  function reset() {\n    min = Number.POSITIVE_INFINITY;\n    max = Number.NEGATIVE_INFINITY;\n  }\n}\n","import util from '../gl-utils';\nimport bus from '../bus';\nimport {decodeFloatRGBA} from '../utils/floatPacking';\nimport makeStatCounter from '../utils/makeStatCounter';\n\nconst OUT_V_X = 6;\nconst OUT_V_Y = 7;\n/**\n * This program allows to change color of each particle. It works by\n * reading current velocities into a texture from the framebuffer. Once\n * velocities are read, it checks velocity scale and passes it to a draw program.\n */\nexport default function colorProgram(ctx) {\n  var speedNeedsUpdate = true;\n  var {gl} = ctx;\n  var velocity_y_texture, velocity_x_texture;\n  var particleStateResolution;\n  var pendingSpeedUpdate;\n  var numParticles;\n  var velocityCounter = makeStatCounter();\n  var velocity_x;\n  var velocity_y;\n\n  listenToEvents();\n\n  return {\n    updateCode,\n    updateParticlesPositions,\n    updateParticlesCount,\n    setColorMinMax,\n    requestSpeedUpdate,\n    dispose\n  };\n\n  function listenToEvents() {\n    bus.on('integration-timestep-changed', requestSpeedUpdate);\n    bus.on('bbox-change', requestSpeedUpdate);\n    bus.on('refresh-speed', requestSpeedUpdate);\n  }\n\n  function dispose() {\n    bus.off('integration-timestep-changed', requestSpeedUpdate);\n    bus.off('bbox-change', requestSpeedUpdate);\n    bus.off('refresh-speed', requestSpeedUpdate);\n    disposeTextures();\n  }\n\n  function disposeTextures() {\n    if (velocity_x_texture) gl.deleteTexture(velocity_x_texture);\n    if (velocity_y_texture) gl.deleteTexture(velocity_y_texture);\n  }\n\n  function requestSpeedUpdate() {\n    if (pendingSpeedUpdate) clearTimeout(pendingSpeedUpdate);\n    pendingSpeedUpdate = setTimeout(() => {\n      speedNeedsUpdate = true;\n      pendingSpeedUpdate = 0;\n    }, 50);\n  }\n\n  function setColorMinMax(program) {\n    gl.uniform2f(program.u_velocity_range, velocityCounter.getMin(), velocityCounter.getMax());\n  }\n\n  function updateParticlesCount() {\n    disposeTextures();\n\n    particleStateResolution = ctx.particleStateResolution;\n    numParticles = particleStateResolution * particleStateResolution;\n\n    velocity_x = new Uint8Array(numParticles * 4);\n    velocity_y = new Uint8Array(numParticles * 4);\n    velocity_x_texture = util.createTexture(gl, gl.NEAREST, velocity_x, particleStateResolution, particleStateResolution);\n    velocity_y_texture = util.createTexture(gl, gl.NEAREST, velocity_y, particleStateResolution, particleStateResolution);\n\n    requestSpeedUpdate();\n  }\n\n  function updateCode() {\n    requestSpeedUpdate();\n  }\n\n  function updateParticlesPositions(program) {\n    if (!speedNeedsUpdate || !velocity_x || !velocity_y) return;\n    speedNeedsUpdate = false;\n\n    // We assume this is called from update position program\n    util.bindFramebuffer(gl, ctx.framebuffer, velocity_x_texture);\n    gl.uniform1i(program.u_out_coordinate, OUT_V_X);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.readPixels(0, 0, particleStateResolution, particleStateResolution, gl.RGBA, gl.UNSIGNED_BYTE, velocity_x);\n\n    util.bindFramebuffer(gl, ctx.framebuffer, velocity_y_texture);\n    gl.uniform1i(program.u_out_coordinate, OUT_V_Y);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.readPixels(0, 0, particleStateResolution, particleStateResolution, gl.RGBA, gl.UNSIGNED_BYTE, velocity_y);\n\n    updateMinMax();\n  }\n\n  function updateMinMax() {\n    velocityCounter.reset();\n    // TODO: Do I want this to be async?\n    for(var i = 0; i < velocity_y.length; i+=4) {\n      var vx = readFloat(velocity_x, i);\n      var vy = readFloat(velocity_y, i);\n      var v = Math.sqrt(vx * vx + vy * vy);\n      velocityCounter.add(v);\n    }\n  }\n}\n\nfunction readFloat(buffer, offset) {\n    return decodeFloatRGBA(\n      buffer[offset + 0],\n      buffer[offset + 1],\n      buffer[offset + 2],\n      buffer[offset + 3]\n    );\n}","/**\n * A wrapper over collection of textures. Can be used to represent\n * individual textures for every dimension.\n */\nimport glUtil from '../gl-utils';\n\nexport default function textureCollection(gl, dimensions, particleStateResolution) {\n  var textures = dimensions.map((d, index) => {\n    var textureInfo = {\n      texture: glUtil.createTexture(gl, gl.NEAREST, d.particleState, particleStateResolution, particleStateResolution),\n      index: index,\n      name: d.name\n    }\n\n    return textureInfo;\n  })\n\n  return {\n    dispose,\n    bindTextures,\n    assignProgramUniforms,\n    length: dimensions.length,\n    textures,\n    get(i) { return textures[i]; }\n  }\n\n  function assignProgramUniforms(program) {\n    textures.forEach(tInfo => {\n      gl.uniform1i(program['u_particles_' + tInfo.name], tInfo.index);\n    });\n  }\n\n  function dispose() {\n    textures.forEach(tInfo => gl.deleteTexture(tInfo.texture));\n  }\n\n  function bindTextures(gl, program) {\n    textures.forEach((tInfo) => {\n      glUtil.bindTexture(gl, tInfo.texture, tInfo.index);\n      gl.uniform1i(program['u_particles_' + tInfo.name], tInfo.index);\n    })\n  }\n}","import util from '../gl-utils';\nimport UpdatePositionGraph from '../shaderGraph/updatePositionGraph';\nimport ColorMode from './colorModes';\nimport makeReadProgram from './colorProgram';\nimport textureCollection from '../utils/textureCollection';\nimport makeStatCounter from '../utils/makeStatCounter';\nimport {decodeFloatRGBA} from '../utils/floatPacking';\nimport bus from '../bus';\n\nconst particlePositionShaderCodeBuilder = new UpdatePositionGraph();\n\nexport default function updatePositionProgram(ctx) {\n  var gl = ctx.gl;\n  var readTextures, writeTextures;\n  var particleStateResolution;\n  var updateProgram;\n  var readVelocity = makeReadProgram(ctx);\n\n  // If someone needs to get vectors out from the GPU, they send a `vector-lines-request`\n  // over the bus. This request is delayed until next compute frame. Once it is handled,\n  // we send them back response with calculated vectors.\n  var pendingVectorLines;\n\n  // TODO: need to make sure we are not leaking.\n  bus.on('vector-lines-request', putVectorLinesRequestIntoQueue);\n\n  return {\n    updateCode,\n    updateParticlesPositions,\n    updateParticlesCount,\n    prepareToDraw,\n    updateVariable\n  };\n\n  function updateCode(vectorField) {\n    particlePositionShaderCodeBuilder.setCustomVectorField(vectorField);\n    let fragment = particlePositionShaderCodeBuilder.getFragmentShader();\n    let vertex = particlePositionShaderCodeBuilder.getVertexShader();\n\n    let newProgram = util.createProgram(gl, vertex, fragment);\n\n    if (updateProgram) updateProgram.unload();\n    updateProgram = newProgram;\n\n    if (ctx.colorMode === ColorMode.VELOCITY) readVelocity.requestSpeedUpdate();\n  }\n\n  function updateVariable(varName, value) {\n    var uniformLocation = gl.getUniformLocation(updateProgram.program, `u_${varName}`);\n    gl.useProgram(updateProgram.program);\n    gl.uniform1f(uniformLocation, value);\n  }\n\n  function updateParticlesCount(x, y) {\n    particleStateResolution = ctx.particleStateResolution;\n\n    var dimensions = [{\n      name: 'x',\n      particleState: x\n    }, {\n      name: 'y',\n      particleState: y\n    }];\n\n    if (readTextures) readTextures.dispose();\n    readTextures = textureCollection(gl, dimensions, particleStateResolution);\n\n    if (writeTextures) writeTextures.dispose();\n    writeTextures = textureCollection(gl, dimensions, particleStateResolution);\n\n    readVelocity.updateParticlesCount();\n  }\n\n  function prepareToDraw(program) {\n    var colorMode = ctx.colorMode;\n    if (colorMode === ColorMode.VELOCITY) readVelocity.setColorMinMax(program);\n\n    readTextures.bindTextures(gl, program);\n  }\n\n  function updateParticlesPositions() {\n    var program = updateProgram;\n    gl.useProgram(program.program);\n  \n    util.bindAttribute(gl, ctx.quadBuffer, program.a_pos, 2);\n  \n    ctx.inputs.updateBindings(program);\n\n    // TODO: Remove this.\n    if (ctx.audioTexture) {\n      util.bindTexture(gl, ctx.audioTexture, 5);\n      gl.uniform1i(program['u_audio'], 5);\n    }\n\n    readTextures.bindTextures(gl, program);\n  \n    gl.uniform1f(program.u_rand_seed, ctx.frameSeed);\n    gl.uniform1f(program.u_h, ctx.integrationTimeStep);\n    gl.uniform1f(program.frame, ctx.frame);\n    var cursor = ctx.cursor;\n    gl.uniform4f(program.cursor, cursor.clickX, cursor.clickY, cursor.hoverX, cursor.hoverY);\n\n    var bbox = ctx.bbox;\n    gl.uniform2f(program.u_min, bbox.minX, bbox.minY);\n    gl.uniform2f(program.u_max, bbox.maxX, bbox.maxY);\n\n    gl.uniform1f(program.u_drop_rate, ctx.dropProbability);\n  \n    // Draw each coordinate individually\n    for(var i = 0; i < writeTextures.length; ++i) {\n      var writeInfo = writeTextures.get(i);\n      gl.uniform1i(program.u_out_coordinate, i);\n      util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n      gl.viewport(0, 0, particleStateResolution, particleStateResolution);\n      gl.drawArrays(gl.TRIANGLES, 0, 6);\n    }\n\n    // TODO: I think I need to keep this time-bound, i.e. allocate X ms to\n    // process particle positions, and move on. So that the rendering thread is not paused for too long\n    if (ctx.colorMode === ColorMode.VELOCITY) {\n      readVelocity.updateParticlesPositions(program);\n    }\n\n    if (pendingVectorLines) {\n      processVectorLinesRequest(program);\n      pendingVectorLines = null;\n    }\n\n    // swap the particle state textures so the new one becomes the current one\n    var temp = readTextures;\n    readTextures = writeTextures;\n    writeTextures = temp;\n  }\n\n  function putVectorLinesRequestIntoQueue(request) {\n    pendingVectorLines = request;\n  }\n\n  function processVectorLinesRequest(program) {\n    // TODO: Move this out\n    var dimensions = [{\n      name: 'x',\n      particleState: pendingVectorLines.x\n    }, {\n      name: 'y',\n      particleState: pendingVectorLines.y\n    }];\n\n    // We create temporary textures and load requested positions in there\n    var resolutionOfParticlesInRequest = pendingVectorLines.resolution;\n    var numParticles = resolutionOfParticlesInRequest * resolutionOfParticlesInRequest;\n\n    var texturesForRead = textureCollection(gl, dimensions, resolutionOfParticlesInRequest);\n    var texturesForWrite = textureCollection(gl, dimensions, resolutionOfParticlesInRequest);\n\n    texturesForRead.bindTextures(gl, program);\n\n    // Then we request coordinates out from GPU for each dimension\n    var writeInfo = texturesForWrite.get(0);\n    gl.uniform1i(program.u_out_coordinate, 6); // v_x\n\n    util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n    gl.viewport(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n    var velocity_x = new Uint8Array(numParticles * 4);\n    gl.readPixels(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest, gl.RGBA, gl.UNSIGNED_BYTE, velocity_x);\n\n    gl.uniform1i(program.u_out_coordinate, 7); // v_y\n    writeInfo = texturesForWrite.get(1);\n    util.bindFramebuffer(gl, ctx.framebuffer, writeInfo.texture);\n    gl.viewport(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n    var velocity_y = new Uint8Array(numParticles * 4);\n    gl.readPixels(0, 0, resolutionOfParticlesInRequest, resolutionOfParticlesInRequest, gl.RGBA, gl.UNSIGNED_BYTE, velocity_y);\n\n    texturesForWrite.dispose();\n    texturesForRead.dispose();\n\n    var xStats = makeStatCounter();\n    var yStats = makeStatCounter();\n\n    var decoded_velocity_x = new Float32Array(numParticles);\n    var decoded_velocity_y = new Float32Array(numParticles);\n    for(var i = 0; i < velocity_y.length; i+=4) {\n      var idx = i/4;\n      var vx = readFloat(velocity_x, i);\n      var vy = readFloat(velocity_y, i);\n      decoded_velocity_x[idx] = vx;\n      decoded_velocity_y[idx] = vy;\n      xStats.add(vx);\n      yStats.add(vy);\n    }\n\n    var vectorLineInfo = {\n      xStats,\n      yStats,\n      decoded_velocity_x,\n      decoded_velocity_y,\n      resolution: resolutionOfParticlesInRequest\n    };\n\n    bus.fire('vector-line-ready', vectorLineInfo);\n  }\n}\n\nfunction readFloat(buffer, offset) {\n    return decodeFloatRGBA(\n      buffer[offset + 0],\n      buffer[offset + 1],\n      buffer[offset + 2],\n      buffer[offset + 3]\n    );\n}\n","import appState from './appState';\n\nconst defaultConfig = {\n  // I need to flash our more details before making any promises.\n  isAudioEnabled: false,\n  // this allows to render an overlay grid with vectors. Enable it\n  // and drag the scene a little bit.\n  vectorLinesEnabled: false,\n\n  // Starting from which texture unit we can bind custom inputs?\n  FREE_TEXTURE_UNIT: 4,\n\n  // whether input bindings should be visible\n  showBindings: appState.getQS().get('showBindings') || false\n}\n\nexport default defaultConfig;","import bus from '../bus';\nimport glUtil from '../gl-utils';\n\nexport default audioProgram;\n\nfunction audioProgram(ctx) {\n  var gl = ctx.gl;\n\n  var audioWidth = 8, audioHeight = 8;\n  var audioBuffer = new Uint8Array(audioWidth * audioHeight * 4);\n  var audioTexture = glUtil.createTexture(gl, gl.NEAREST, audioBuffer, audioWidth, audioHeight);\n  var audioDirty = false;\n  ctx.audioTexture = audioTexture;\n\n  bus.on('audio', updateAudioBuffer);\n\n  return {\n    updateTextures,\n    dispose\n  };\n\n  function dispose() {\n    bus.off('audio', updateAudioBuffer);\n    gl.deleteTexture(audioTexture);\n  }\n\n  function updateTextures() {\n    if (!audioDirty) return;\n    audioDirty = false;\n\n    // TODO: This should come from fftSize?\n    var width = 5, height = 5;\n    gl.bindTexture(gl.TEXTURE_2D, audioTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, audioBuffer);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  function updateAudioBuffer(newBuffer) {\n    audioBuffer = newBuffer;\n    audioDirty = true;\n  }\n}\n","import util from '../gl-utils';\nimport DrawParticleGraph from '../shaderGraph/DrawParticleGraph';\nimport makeUpdatePositionProgram from './updatePositionProgram';\nimport { encodeFloatRGBA } from '../utils/floatPacking.js';\nimport config from '../config';\nimport createAudioProgram from './audioProgram';\n\n/**\n * This program manages particles life-cycle. It updates particles positions\n * and initiates drawing them on screen.\n * \n * @param {Object} ctx rendering context. Holds WebGL state\n */\nexport default function drawParticlesProgram(ctx) {\n  var gl = ctx.gl;\n\n  var particleStateResolution, particleIndexBuffer;\n  var numParticles;\n\n  var currentVectorField = '';\n  var updatePositionProgram = makeUpdatePositionProgram(ctx);\n  var audioProgram;\n\n  var drawProgram;\n  initPrograms();\n\n  return {\n    updateParticlesCount,\n    updateParticlesPositions,\n    drawParticles,\n    updateCode,\n    updateColorMode,\n    updateVariable,\n    updateColorVariable\n  }\n\n  function initPrograms() {\n    // need to update the draw graph because color mode shader has changed.\n    initDrawProgram();\n\n    if (config.isAudioEnabled) {\n      if (audioProgram) audioProgram.dispose();\n      audioProgram = createAudioProgram(ctx);\n    }\n  }\n\n  function initDrawProgram() {\n    if (drawProgram) drawProgram.unload();\n\n    const drawGraph = new DrawParticleGraph(ctx);\n    const vertexShaderCode = drawGraph.getVertexShader(currentVectorField);\n    drawProgram = util.createProgram(gl, vertexShaderCode, drawGraph.getFragmentShader());\n  }\n\n  function updateParticlesPositions() {\n    if (!currentVectorField) return;\n\n    ctx.frame += 1\n    ctx.frameSeed = Math.random();\n\n    // TODO: Remove this.\n    if (audioProgram) audioProgram.updateTextures();\n\n    updatePositionProgram.updateParticlesPositions();\n  }\n\n  function updateColorMode() {\n    initDrawProgram();\n  }\n\n  function updateCode(vfCode) {\n    ctx.frame = 0;\n    currentVectorField = vfCode;\n    updatePositionProgram.updateCode(vfCode);\n    \n    initDrawProgram();\n  }\n\n  function updateVariableForDrawProgram(varName, value) {\n    var uniformLocation = gl.getUniformLocation(drawProgram.program, `u_${varName}`);\n    gl.useProgram(drawProgram.program);\n    gl.uniform1f(uniformLocation, value);\n  }\n\n  function updateVariable(varName, value) {\n    updatePositionProgram.updateVariable(varName, value);\n    updateVariableForDrawProgram(varName, value);\n  }\n\n  function updateColorVariable(value) {\n    updateVariableForDrawProgram('k', value);\n  }\n\n  function updateParticlesCount() {\n    particleStateResolution = ctx.particleStateResolution;\n    numParticles = particleStateResolution * particleStateResolution;\n    var particleIndices = new Float32Array(numParticles);\n    var particleStateX = new Uint8Array(numParticles * 4);\n    var particleStateY = new Uint8Array(numParticles * 4);\n\n    var minX = ctx.bbox.minX; var minY = ctx.bbox.minY;\n    var width = ctx.bbox.maxX - minX;\n    var height = ctx.bbox.maxY - minY;\n    for (var i = 0; i < numParticles; i++) {\n      encodeFloatRGBA((Math.random()) * width + minX, particleStateX, i * 4); // randomize the initial particle positions\n      encodeFloatRGBA((Math.random()) * height + minY, particleStateY, i * 4); // randomize the initial particle positions\n\n      particleIndices[i] = i;\n    }\n\n    if (particleIndexBuffer) gl.deleteBuffer(particleIndexBuffer);\n    particleIndexBuffer = util.createBuffer(gl, particleIndices);\n\n    updatePositionProgram.updateParticlesCount(particleStateX, particleStateY);\n  }\n\n  function drawParticles() {\n    if (!currentVectorField) return;\n\n    var program = drawProgram;\n    gl.useProgram(program.program);\n  \n    util.bindAttribute(gl, particleIndexBuffer, program.a_index, 1);\n    \n    updatePositionProgram.prepareToDraw(program);\n    ctx.inputs.updateBindings(program);\n  \n    gl.uniform1f(program.u_h, ctx.integrationTimeStep);\n    gl.uniform1f(program.frame, ctx.frame);\n    gl.uniform1f(program.u_particles_res, particleStateResolution);\n    var bbox = ctx.bbox;\n    gl.uniform2f(program.u_min, bbox.minX, bbox.minY);\n    gl.uniform2f(program.u_max, bbox.maxX, bbox.maxY);\n  \n    var cursor = ctx.cursor;\n    gl.uniform4f(program.cursor, cursor.clickX, cursor.clickY, cursor.hoverX, cursor.hoverY);\n    gl.drawArrays(gl.POINTS, 0, numParticles); \n  }\n}","/**\n * XMLHttpRequest wrapped into a promise.\n * \n * @param {String} url \n */\nexport default function request(url, options) {\n  if (!options) options = {};\n\n  return new Promise(download);\n\n  function download(resolve, reject) {\n    var req = new XMLHttpRequest();\n\n    if (typeof options.progress === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open('GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n    req.send(null);\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        options.progress({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total\n        });\n      }\n    }\n\n    function transferComplete() {\n      if (req.status !== 200) {\n        reject(`Unexpected status code ${req.status} when calling ${url}`);\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      resolve(response);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject(`Cancelled download of ${url}`);\n    }\n  }\n}","var loadedLinks = new Map(); // from link to response\nimport request from '../utils/request';\n\nexport default function fetchGLSL(link) {\n  if (!link) return Promise.reject('Missing link')\n  var trimmed = link.trim();\n  if (!trimmed) return Promise.reject('Missing link');\n\n  let cachedResponse = loadedLinks.get(trimmed)\n  if (cachedResponse) return Promise.resolve(cachedResponse);\n\n  return request(link).then(code => {\n    loadedLinks.set(link, code);\n    return code;\n  });\n}","import fetchGLSL from './fetchGLSL.js';\n\nvar pragmaInclude = '#include ';\nvar nullCode = { code: '' }\n\n/**\n * Naively parses glsl code and tries to replace all `#pragma` statements\n * with empty string. Gives structured collection of pragma statements back\n * \n * @param {String} code \n */\nexport default function makePragmaParser(code) {\n  if (!code) return new Promise(resolve => resolve(nullCode));\n\n  var parsedLines = processLineByLine(code);\n  if (parsedLines.pending.length > 0) {\n    return Promise.all(parsedLines.pending).then(() => parsedLines)\n      .catch(error => { return {error: {error}}; });\n  }\n\n  return new Promise(resolve => resolve(parsedLines));\n}\n\nfunction processLineByLine(code) {\n  var pending = []\n  var lines = code.split('\\n');\n  var outputLines = [];\n  var currentIndex = 0;\n  lines.forEach((line, index) => {\n    currentIndex = index;\n    if (line && line[0] === '#') {\n      outputLines.push('');\n      processPragma(line);\n    } else {\n      outputLines.push(line);\n    }\n  });\n\n  return {\n    getCode,\n    pending\n  };\n\n  function getCode() {\n    return outputLines.join('\\n');\n  }\n\n  function processPragma(line) {\n    if (line.indexOf(pragmaInclude) === 0) {\n      var include = line.substr(pragmaInclude.length);\n      var insertIndex = currentIndex;\n      pending.push(fetchGLSL(include).then(code => {\n        outputLines[insertIndex] = code\n      }))\n    }\n  }\n}","/**\n * This module parses user defined vector field code.\n */\n\nimport bus from '../bus';\nimport pragmaParse from './pragmaParser';\n\n// This is naive parser that is being used until the real `glsl-parser`\n// is loaded asynchronously. This parser assumes there are no errors\n// TODO: maybe I should be more careful here?\nvar glslParser = {\n  check(code) {\n    return {\n      code,\n      log: {\n        errorCount: 0\n      }\n    };\n  }\n};\n\n// glsl-parser is ~179KB uncompressed, we don't want to wait until it is downloaded.\n// So we load it asynchronously...\nrequire.ensure('glsl-parser', () => {\n  // ... and replace the naive parser with the real one, when ready.\n  glslParser = require('glsl-parser');\n\n  // notify interested parties, so that they can recheck code if they wish.\n  bus.fire('glsl-parser-ready'); \n});\n\nvar vectorFieldGlobals = `\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}`;\n\n/**\n * Given a string, verifies that it is a valid glsl code for a vector field,\n * and then returns code + log.\n * \n * @param {String} vectorFieldCode \n */\nexport default function getParsedVectorFieldFunction(vectorFieldCode) {\n  // TODO: what if we want to support 3d?\n  return pragmaParse(vectorFieldCode).then(pragmaParseResult => {\n    if (pragmaParseResult.error) {\n      return pragmaParseResult;\n    }\n\n    vectorFieldCode = pragmaParseResult.getCode();\n\n    var parserResult = glslParser.check(vectorFieldCode, { globals: vectorFieldGlobals });\n    parserResult.code = vectorFieldCode;\n\n    if (parserResult.log.errorCount) parserResult.error = parserError(parserResult.log);\n\n    return parserResult;\n  });\n}\n\nfunction parserError(log) {\n  let diag = log.diagnostics[0];\n  // TODO probably need to check kind (errors are 0, warnings are 1)\n  let firstError = diag.range;\n  let lineColumn = firstError.lineColumn();\n  let source = firstError.source;\n  let offset = source._lineOffsets[lineColumn.line]\n  let line = source.contents.substr(offset,  lineColumn.column);\n  line += source.contents.substring(firstError.start, firstError.end);\n  let prefix = 'Line ' + lineColumn.line + ': ';\n  let diagText = diag.text;\n  return {\n    error: \n      prefix + line + '\\n' +\n      whitespace(prefix.length) + whitespace(lineColumn.column) + '^',\n    errorDetail: diagText,\n    isFloatError: isFloatError(diagText)\n  };\n}\n\nfunction isFloatError(diagText) {\n  return diagText.indexOf('\"int\"') > -1 &&\n    diagText.indexOf('\"float\"')  > -1;\n}\n\nfunction whitespace(length) {\n  return new Array(length + 1).join(' ');\n}\n","import bus from '../bus';\nimport appState from '../appState';\nimport getParsedVectorFieldFunction from './getParsedVectorFieldFunction';\n\n/**\n * A text editor state for the vector field equation. Manages vector field\n * program compilation and error reporting state.\n *\n * @param {Object} drawProgram \n */\nexport default function createVectorFieldEditorState(drawProgram) {\n  bus.on('glsl-parser-ready', parseCode);\n  var currentVectorFieldVersion = 0;\n\n  // What is the current code?\n  var currentVectorFieldCode = appState.getCode();\n\n  // For delayed parsing result verification (e.g. when vue is loaded it\n  // can request us to see if there were any errors)\n  var parserResult;\n\n  loadCodeFromAppState();\n\n  var api = {\n    getCode,\n    setCode,\n    dispose,\n    updateVariable,\n\n    // These properties are for UI only\n    code: currentVectorFieldCode,\n    error: '',\n    errorDetail: '',\n    isFloatError: false \n  };\n\n  return api;\n\n  function dispose() {\n    bus.off('glsl-parser-ready', parseCode);\n  }\n\n  function getCode() {\n    return appState.getCode();\n  }\n\n  function setCode(vectorFieldCode) {\n    if (vectorFieldCode === currentVectorFieldCode) {\n      // If field hasn't changed, let's make sure that there was no previous\n      // error\n      if (parserResult && parserResult.error) {\n        // And if there was error, let's revalidate code:\n        parseCode();\n      }\n      return;\n    } \n\n    trySetNewCode(vectorFieldCode).then((result) => {\n      if (result.cancelled) return;\n\n      if (result && result.error) {\n        updateErrorInfo(result.error);\n        return result;\n      }\n\n      currentVectorFieldCode = vectorFieldCode;\n      api.code = vectorFieldCode;\n      appState.saveCode(vectorFieldCode);\n    });\n  }\n\n  function updateErrorInfo(parserResult) {\n    if (parserResult && parserResult.error) {\n      api.error = parserResult.error;\n      api.errorDetail = parserResult.errorDetail;\n      api.isFloatError = parserResult.isFloatError;\n    } else {\n      api.error = '';\n      api.errorDetail = '';\n      api.isFloatError = false;\n    }\n  }\n\n  function loadCodeFromAppState() {\n    let persistedCode = appState.getCode();\n    if (persistedCode) {\n      trySetNewCode(persistedCode).then(result => {\n        if (!result.error) return; // This means we set correctly;\n        // If we get here - something went wrong. see the console\n        console.error('Failed to restore previous vector field: ', result.error);\n        // Let's use default vector field\n        trySetNewCode(appState.getDefaultCode());\n      });\n    } else {\n      // we want a default vector field\n      trySetNewCode(appState.getDefaultCode());\n    }\n  }\n\n  function parseCode(customCode) {\n    return getParsedVectorFieldFunction(customCode || currentVectorFieldCode)\n      .then(currentResult => {\n        parserResult = currentResult\n        updateErrorInfo(parserResult.error);\n        return parserResult;\n      });\n  }\n\n  function trySetNewCode(vectorFieldCode) {\n    currentVectorFieldVersion += 1;\n    var capturedVersion = currentVectorFieldVersion;\n    // step 1 - run through parser\n    return parseCode(vectorFieldCode).then(parserResult => {\n      if (capturedVersion !== currentVectorFieldVersion) {\n        parserResult.cancelled = true;\n        // a newer request was issued. Ignore these results.\n        return parserResult;\n      }\n\n      if (parserResult.error) {\n        return parserResult;\n      }\n      // step 2 - run through real webgl\n      try {\n        drawProgram.updateCode(parserResult.code);\n        return parserResult;\n      } catch (e) {\n        return {\n          error: {\n            error: e.message\n          }\n        }\n      }\n    });\n  }\n\n  function updateVariable(varName, value) {\n    drawProgram.updateVariable(varName, value);\n  }\n}","/**\n * Collection of input bindings. Individual program works with this collection\n * to command it update texture bindings.\n */\nexport default function createInputCollection() {\n  var boundInputs = new Map() \n  var currentProgram;\n  return {\n    updateBindings,\n    bindInput,\n  }\n\n  function bindInput(inputIndex, inputBinding) {\n    var prevBinding = boundInputs.get(inputIndex);\n    if (prevBinding) {\n      prevBinding.dispose();\n    }\n    boundInputs.set(inputIndex, inputBinding);\n  }\n\n  function updateBindings(program) {\n    currentProgram = program;\n    boundInputs.forEach(updateInputBinding);\n  }\n\n  function updateInputBinding(input, inputIndex) {\n    input.updateBinding(currentProgram, inputIndex);\n  }\n}","// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL\nexport default function loadTexture(gl, url) {\n  var resolveTexture, rejectTexture;\n\n  var image = new Image();\n  image.crossOrigin = '';\n\n  image.onload = bindTexture;\n  image.onerror = reportError;\n  image.src = url;\n\n  return new Promise((resolve, reject) => {\n    resolveTexture = resolve;\n    rejectTexture = reject;\n  });\n\n  function reportError(err) {\n    rejectTexture(err);\n  }\n\n  function bindTexture() {\n    var texture = gl.createTexture();\n    var level = 0;\n    var internalFormat = gl.RGBA;\n    var srcFormat = gl.RGBA;\n    var srcType = gl.UNSIGNED_BYTE;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n                  srcFormat, srcType, image);\n\n    if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n       gl.generateMipmap(gl.TEXTURE_2D);\n    } else {\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n       gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    }\n\n    resolveTexture(texture);\n  }\n}\n\nfunction isPowerOf2(value) {\n  return (value & (value - 1)) == 0;\n}","/**\n * Creates a single image binding element in the input collection.\n */\nimport loadTexture from \"./loadTexture\";\nimport glUtils from '../../gl-utils';\nimport config from '../../config';\nimport bus from '../../bus';\n\nconst FREE_TEXTURE_UNIT = config.FREE_TEXTURE_UNIT;\n\nexport default function createImageInputBinding(ctx, url, callbacks) {\n  var texture = null;\n  loadTexture(ctx.gl, url).then(setTexture).catch(handleError);\n\n  return {\n    updateBinding,\n    dispose() {\n      // TODO: Potential race condition, as loadTexture is async.\n      ctx.gl.deleteTexture(texture);\n    }\n  }\n\n  function handleError(err) {\n    if (callbacks && callbacks.error) {\n      callbacks.error(err);\n    }\n  }\n\n  function setTexture(loadedTexture) {\n    texture = loadedTexture;\n    bus.fire('refresh-speed')\n    if (callbacks && callbacks.done) {\n      callbacks.done(url);\n    }\n  }\n\n  function updateBinding(program, inputIndex) {\n    if (!texture) return;\n\n    var realIndex = inputIndex + FREE_TEXTURE_UNIT;\n    glUtils.bindTexture(ctx.gl, texture, realIndex);\n    ctx.gl.uniform1i(program[`input${inputIndex}`], realIndex);\n  }\n}","import createInputCollection from './programs/inputs/inputCollection';\nimport createVideoInput from './programs/inputs/videoInput';\nimport createImageInputBinding from './programs/inputs/imageInput';\nimport appState from './appState.js';\n\n// Allows to bind media elements to vector field\nexport default function createInputsModel(ctx) {\n  ctx.inputs = createInputCollection();\n  var inputs = [];\n  readInputsFromAppState();\n\n  var api = {\n    getInputs,\n    addInput,\n  };\n\n  return api;\n\n  function getInputs() {\n    return inputs;\n  }\n\n  function addInput(inputNumber) {\n    var vm = createInputElementViewModel(ctx, inputNumber);\n    inputs.push(vm);\n    return vm;\n  }\n\n  function readInputsFromAppState() {\n    var i0 = appState.getQS().get('i0');\n    if (i0) {\n      var vm = addInput(0);\n      vm.link = i0;\n      vm.updateBinding(/* immediate = */ true);\n    }\n  }\n}\n\nfunction createInputElementViewModel(ctx, inputNumber) {\n  var pendingUpdate = null;\n\n  var input = {\n    link: '',\n    error: null,\n    name: `input${inputNumber}`,\n    updateBinding\n  }\n\n  return input;\n\n  function updateBinding(immediate) {\n    if (pendingUpdate) {\n      clearTimeout(pendingUpdate);\n      pendingUpdate = null;\n    }\n\n    if (immediate) {\n      setBinding();\n    } else {\n      pendingUpdate = setTimeout(setBinding, 300);\n    }\n  }\n\n  function setBinding() {\n    input.error = null;\n    pendingUpdate = null;\n    var binding = createImageInputBinding(ctx, input.link, {\n      done() {\n        // TODO: Preview\n        appState.getQS().set(`i${inputNumber}`, input.link);\n      },\n      error(err) {\n        // TODO: Better Error checking\n        input.error = err;\n      }\n    });\n    ctx.inputs.bindInput(0, binding);\n  }\n}","/**\n * This file is based on https://github.com/mapbox/webgl-wind\n * by Vladimir Agafonkin\n *\n * Released under ISC License, Copyright (c) 2016, Mapbox\n * https://github.com/mapbox/webgl-wind/blob/master/LICENSE\n *\n * Adapted to field maps by Andrei Kashcha\n * Copyright (C) 2017\n */\nimport util from './gl-utils';\nimport bus from './bus';\nimport appState from './appState';\n\nimport createScreenProgram from './programs/screenProgram';\nimport createDrawParticlesProgram from './programs/drawParticlesProgram';\nimport createVectorFieldEditorState from './editor/vectorFieldState';\nimport createInputsModel from './createInputsModel';\n\nconst INITIAL_SPEED = 1;\n\nfunction integrationTimeStepFromSpeed(speed) {\n  return speed * 0.004;\n}\n\nfunction fadeOutFromSpeed(speed) {\n  return 1 - speed * 0.002;\n}\n\n/**\n * Kicks offs the app rendering. Initialized before even vue is loaded.\n *\n * @param {WebGLRenderingContext} gl\n */\nexport default function initScene(gl) {\n  // Canvas size management\n  var canvasRect = { width: 0, height: 0, top: 0, left: 0 };\n  setWidthHeight(window.innerWidth, window.innerHeight);\n  window.addEventListener('resize', onResize, true);\n\n  // TODO: It feels like bounding box management needs to be moved out from here.\n  // TODO: bbox needs to be a class with width/height properties.\n  var bbox = appState.getBBox() || {};\n  var currentPanZoomTransform = {\n    scale: 0.1,\n    x: window.innerWidth / 2,\n    y: window.innerHeight / 2\n  };\n\n  // How many particles do we want?\n  var particleCount = appState.getParticleCount();\n\n  gl.disable(gl.DEPTH_TEST);\n  gl.disable(gl.STENCIL_TEST);\n\n  // Context variable is a way to share rendering state between multiple programs. It has a lot of stuff on it.\n  // I found that it's the easiest way to work in state-full world of WebGL.\n  // Until I discover a better way to write WebGL code.\n  var ctx = {\n    gl,\n    bbox,\n    canvasRect,\n\n    inputs: null,\n\n    framebuffer: gl.createFramebuffer(),\n\n    // This is used only to render full-screen rectangle. Main magic happens inside textures.\n    quadBuffer: util.createBuffer(gl, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1])),\n\n    colorMode: appState.getColorMode(),\n    colorFunction: appState.getColorFunction(),\n\n    // This defines texture unit for screen rendering. First few indices are taken by textures\n    // that compute particles position/color\n    // TODO: I need to find a better way to manage this.\n    screenTextureUnit: 3,\n\n    speed: INITIAL_SPEED,\n    integrationTimeStep: integrationTimeStepFromSpeed(INITIAL_SPEED),\n\n    // On each frame the likelihood for a particle to reset its position is this:\n    dropProbability: appState.getDropProbability(),\n\n    // current frame number. Reset every time when new shader is compiled\n    frame: 0,\n\n    // TOREMOVE\n    // Information about mouse cursor. Could be useful to simplify\n    // exploration\n    cursor: {\n      // Where mouse was last time clicked (or tapped)\n      clickX: 0, clickY: 0,\n      // where mouse was last time moved. If this is a touch device\n      // this is the same as clickX, clickY\n      hoverX: 0, hoverY: 0\n    },\n\n    // Texture size to store particles' positions\n    particleStateResolution: 0,\n\n    // How quickly we should fade previous frame (from 0..1)\n    fadeOpacity: fadeOutFromSpeed(INITIAL_SPEED),\n\n    backgroundColor: { r: 0, g: 0, b: 0, a: 1 },\n\n    // Ignore this one for a moment. Yes, the app support web audio API,\n    // but it's rudimentary, so... shhh! it's a secret.\n    // Don't shhh on me!\n    audioTexture: null\n  };\n\n  // Frame management\n  var lastAnimationFrame;\n  var lastAnimationFrameTime;\n  var isPaused = false;\n\n  var inputsModel = createInputsModel(ctx);\n\n  // screen rendering;\n  var screenProgram = createScreenProgram(ctx);\n  var drawProgram = createDrawParticlesProgram(ctx);\n  // var cursorUpdater = createCursorUpdater(ctx);\n  var vectorFieldEditorState = createVectorFieldEditorState(drawProgram);\n\n  // particles\n  updateParticlesCount(particleCount);\n\n  var api = {\n    start: nextFrame,\n    stop,\n    dispose,\n\n    setPaused,\n\n    getParticlesCount,\n    setParticlesCount,\n\n    setFadeOutSpeed,\n    getFadeOutSpeed,\n\n    setDropProbability,\n    getDropProbability,\n\n    getSpeed,\n    setSpeed,\n\n    setColorMode,\n    getColorMode,\n\n    setColorFunction,\n    getColorFunction,\n\n    vectorFieldEditorState,\n    updateColorVariable,\n\n    inputsModel,\n\n    setBackgroundColor,\n\n    getCanvasRect() {\n      // We trust they don't do anything bad with this ...\n      return canvasRect;\n    },\n\n    getBoundingBox() {\n      // again, we trust. Maybe to much?\n      return ctx.bbox;\n    }\n  }\n\n  restoreBBox();\n\n  setTimeout(() => {\n    bus.fire('scene-ready', api);\n  })\n\n  return api;\n\n  function assignIfPossible(change, key, newBoundingBox) {\n    var value = Number.parseFloat(change[key]);\n    if (Number.isFinite(value)) {\n      newBoundingBox[key] = value;\n    }\n  }\n\n\n  function setColorMode(x) {\n    var mode = parseInt(x, 10);\n    ctx.colorMode = mode;\n    drawProgram.updateColorMode(mode);\n  }\n\n  function getColorMode() {\n    return ctx.colorMode;\n  }\n\n  function setColorFunction(code) {\n    ctx.colorFunction = code;\n    drawProgram.updateColorMode(ctx.colorMode);\n  }\n\n  function updateColorVariable(value) {\n    drawProgram.updateColorVariable(value);\n  }\n\n  function getColorFunction() {\n    return ctx.colorFunction;\n  }\n\n  function getSpeed() {\n    return ctx.speed;\n  }\n\n  function setSpeed(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      ctx.speed = f;\n      ctx.integrationTimeStep = integrationTimeStepFromSpeed(speed);\n      ctx.fadeOpacity = fadeOutFromSpeed(speed);\n      bus.fire('integration-timestep-changed', ctx.integrationTimeStep);\n    }\n  }\n\n  function setPaused(shouldPause) {\n    isPaused = shouldPause;\n    nextFrame();\n  }\n\n  // Main screen fade out configuration\n  function setFadeOutSpeed(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      ctx.fadeOpacity = f;\n      appState.setFadeout(f);\n    }\n  }\n\n  function getFadeOutSpeed() {\n    return appState.getFadeout();\n  }\n\n  // Number of particles configuration\n  function getParticlesCount() {\n    return appState.getParticleCount();\n  }\n\n  function setParticlesCount(newParticleCount) {\n    if (!Number.isFinite(newParticleCount)) return;\n    if (newParticleCount === particleCount) return;\n    if (newParticleCount < 1) return;\n\n    updateParticlesCount(newParticleCount);\n\n    particleCount = newParticleCount;\n    appState.setParticleCount(newParticleCount);\n  }\n\n  // drop probability\n  function setDropProbability(x) {\n    var f = parseFloat(x);\n    if (Number.isFinite(f)) {\n      // TODO: Do I need to worry about duplication/clamping?\n      appState.setDropProbability(f);\n      ctx.dropProbability = f;\n    }\n  }\n\n  function getDropProbability() {\n    return appState.getDropProbability();\n  }\n\n  function onResize() {\n    setWidthHeight(window.innerWidth, window.innerHeight);\n\n    screenProgram.updateScreenTextures();\n\n    updateBoundingBox();\n  }\n\n  function setWidthHeight(w, h) {\n    var dx = Math.max(w * 0.02, 30);\n    var dy = Math.max(h * 0.02, 30);\n    let x = w + 2 * dx;\n    let y = h + 2 * dy;\n    canvasRect.width = window.devicePixelRatio * x;\n    canvasRect.height = window.devicePixelRatio * y;\n    canvasRect.top = - dy;\n    canvasRect.left = - dx;\n\n\n    let canvas = gl.canvas;\n    canvas.style.width = x + 'px';\n    canvas.style.height = y + 'px';\n    canvas.style.left = (-dx) + 'px';\n    canvas.style.top = (-dy) + 'px';\n    canvas.width = canvasRect.width;\n    canvas.height = canvasRect.height;\n  }\n\n  function dispose() {\n    stop();\n    window.removeEventListener('resize', onResize, true);\n    vectorFieldEditorState.dispose();\n  }\n\n  function nextFrame() {\n    if (lastAnimationFrame) return;\n\n    if (isPaused) return;\n\n    lastAnimationFrame = requestAnimationFrame(draw);\n    lastAnimationFrameTime = Date.now();\n  }\n\n  function stop() {\n    cancelAnimationFrame(lastAnimationFrame);\n    lastAnimationFrame = 0;\n    lastAnimationFrameTime = undefined;\n  }\n\n  function draw() {\n    lastAnimationFrame = 0;\n\n    // Adjust integration time step if we missed frames\n    if (lastAnimationFrameTime) {\n      let timeSinceLastFrame = Date.now() - lastAnimationFrameTime;\n      let performanceRatio = (1000 / 30) / timeSinceLastFrame;\n      let correctedSpeed = ctx.speed / Math.min(performanceRatio, 1);\n      ctx.integrationTimeStep = integrationTimeStepFromSpeed(correctedSpeed);\n      ctx.fadeOpacity = fadeOutFromSpeed(correctedSpeed);\n      // bus.fire('integration-timestep-changed', ctx.integrationTimeStep);\n    }\n    drawScreen();\n\n    nextFrame();\n  }\n\n  function drawScreen() {\n    screenProgram.fadeOutLastFrame()\n    drawProgram.drawParticles();\n    screenProgram.renderCurrentScreen();\n    drawProgram.updateParticlesPositions();\n  }\n\n  function updateParticlesCount(numParticles) {\n    // we create a square texture where each pixel will hold a particle position encoded as RGBA\n    ctx.particleStateResolution = Math.ceil(Math.sqrt(numParticles));\n    drawProgram.updateParticlesCount();\n  }\n\n  function restoreBBox() {\n    var {width, height} = canvasRect;\n\n    let sX = Math.PI * Math.E;\n    let sY = Math.PI * Math.E;\n    let tX = 0;\n    let tY = 0;\n\n    var w2 = sX * width / 2;\n    var h2 = sY * width / 2;\n    updateBoundingBox();\n  }\n\n  function updateBoundingBox() {\n    screenProgram.boundingBoxUpdated = true;\n\n    currentPanZoomTransform = {\n      scale: 0.1,\n      x: window.innerWidth / 2,\n      y: window.innerHeight / 2\n    };\n\n    var {width, height} = canvasRect;\n    width /= window.devicePixelRatio;\n    height /= window.devicePixelRatio;\n\n    var minX = clientX(0);\n    var minY = clientY(0);\n    var maxX = clientX(width);\n    var maxY = clientY(height);\n\n    // we divide by width to keep aspect ratio\n    // var ar = width/height;\n    var p = 10000;\n    bbox.minX = Math.round(p * minX/width)/p;\n    bbox.minY = Math.round(p * -minY/width)/p;\n    bbox.maxX = Math.round(p * maxX/width)/p;\n    bbox.maxY = Math.round(p * -maxY/ width)/p;\n\n    bus.fire('bbox-change', bbox);\n\n    function clientX(x) {\n      return (x - currentPanZoomTransform.x)/currentPanZoomTransform.scale;\n    }\n\n    function clientY(y) {\n      return (y - currentPanZoomTransform.y)/currentPanZoomTransform.scale;\n    }\n  }\n\n  // backgroundColor should be an object with r, g, b, a properties (range: 0-1)\n  function setBackgroundColor(backgroundColor) {\n    ctx.backgroundColor = backgroundColor; \n  }\n}\n","\nimport _ from 'lodash';\nimport { CreateElement, VNode } from 'vue';\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport initScene from '../lib/field-play/scene';\nimport ColorModes from '../lib/field-play/programs/colorModes';\n\nimport { easeExpInOut } from 'd3-ease';\n\nfunction scale(x: number): number {\n  return easeExpInOut(x);\n}\n\n@Component\nexport default class FieldVizualisation extends Vue {\n  private scene: any;\n\n  @Prop({ required: true })\n  public alpha: number;\n\n  @Prop({ required: true })\n  public beta1: number;\n\n  @Prop({ required: true })\n  public beta2: number;\n\n  @Prop({ required: true })\n  public beta3: number;\n\n  @Prop({ required: true })\n  public gamma: number;\n\n  get k1(): number {\n    return scale(this.alpha);\n  };\n\n  get k2(): number {\n    return scale(this.gamma);\n  };\n\n  get k3(): number {\n    return scale(this.beta1);\n  };\n  get k4(): number {\n    return scale(this.beta2);\n  };\n  get k5(): number {\n    return scale(this.beta3);\n  };\n\n  @Prop({ required: true })\n  public n: number;\n\n  @Prop({ default: false })\n  public paused: boolean;\n\n  get actuallyPaused (): boolean {\n    return this.paused && this.n > 0;\n  }\n\n  private timeStep: number = 0.01;\n  private dropProbability: number = 0.009;\n  private fadeout: number = .998;\n\n  get particleCount (): number {\n    return Math.max(\n      this.n * (window.innerHeight * window.innerWidth) / 5000 * Math.pow(window.devicePixelRatio, 2)\n    , 1);\n  }\n\n  mounted () {\n    let canvas: HTMLCanvasElement = this.$el as HTMLCanvasElement;\n    let ctxOptions = { antialias: true, alpha: false };\n    let gl = canvas.getContext('webgl', ctxOptions) ||\n    canvas.getContext('experimental-webgl', ctxOptions);\n\n    this.scene = initScene(gl);\n    this.scene.setParticlesCount(this.particleCount);\n    this.scene.setBackgroundColor({\n      r: 0.05, g: 0, b: 0.1, a: 1\n    });\n    this.scene.setDropProbability(0.001)\n    this.updateVectorField();\n    this.updateColorFunction();\n    this.scene.setColorMode(ColorModes.VELOCITY);\n\n    if (!this.actuallyPaused)\n      this.scene.start();\n  }\n\n  beforeDestroy () {\n    this.scene.dispose();\n    this.$el.remove();\n  }\n\n  formatNumberforGLSL (n: number): string {\n    if (_.isNaN(n))\n      return '0.'\n    return n.toFixed(4);\n  }\n\n  get GLSLcode () {\n    let codeLines: string[] = [];\n\n    codeLines.push(`v.x = 0.;`);\n    codeLines.push(`v.y = 0.;`);\n    codeLines.push(`float tau = acos(0.);`);\n    codeLines.push(`float pi = tau / 2.;`);\n    codeLines.push(`float l = length(p);`)\n\n    codeLines.push(`if (u_k1 > .0) {`)\n      let circle = {\n        x: `p.y`,\n        y: `-p.x`\n      }\n      codeLines.push(`v.x += pow(u_k1, 2.) * (${circle.x}) / pow(max(1., abs(3. * l) - 2. * tau), 3.);`);\n      codeLines.push(`v.y += pow(u_k1, 2.) * (${circle.y}) / pow(max(1., abs(3. * l) - 2. * tau), 3.);`);\n    codeLines.push(`}`);\n\n    // SQUARES: Hi beta (3)\n    codeLines.push(`if (u_k5 > .0) {`)\n      let squares = {\n        x: `sign(sin(p.y * 4.)) / 2. + (1. - u_k5) * sin(p.y * 4.)`,\n        y: `sign(-1. * sin(p.x * 4.)) / 2. - (1. - u_k5) * sin(p.x * 4.)`\n      };\n      codeLines.push(`float sd = (abs(p.x) + abs(p.y)) * 2. / 3.;`);\n      codeLines.push(`if ( (sd < tau) && (sd > pi / 2.) ) {`);\n        codeLines.push(`v.x += pow(u_k5, 3.) * (${squares.x});`);\n        codeLines.push(`v.y += pow(u_k5, 3.) * (${squares.y});`);\n      codeLines.push(`}`);\n    codeLines.push(`}`);\n\n    // WHRIL: gamma\n    codeLines.push(`if (u_k2 > .0) {`)\n      let whirl = {\n        x: `(p.y + p.x) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)`,\n        y: `(- p.x + p.y) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)`\n      };\n      codeLines.push(`v.x -= pow(u_k2, 2.) * (${whirl.x});`);\n      codeLines.push(`v.y -= pow(u_k2, 2.) * (${whirl.y});`);\n    codeLines.push(`}`);\n\n    // explode idle: Low-beta (1)\n    codeLines.push(`if (u_k3 > .0) {`)\n      codeLines.push(`v.x += u_k3 * p.x / pow(l, 2.);`);\n      codeLines.push(`v.y += u_k3 * p.y / pow(l, 2.);`);\n    codeLines.push(`}`);\n\n    codeLines.push(`if (u_k4 > .0) {`)\n      codeLines.push(`float x = sin((p.x + p.y) * 3.);`)\n      codeLines.push(`float y = sin((p.x - p.y) * 3.);`)\n      codeLines.push(`float cd = max(max(abs(p.x), abs(p.y)) - 0.5, 0.);`)\n      // CLOVERFLIED processing units (cpu-like): Mid Beta (2)\n      let cloverfield = {\n        x: `4. * ((-1. / x / 50.) + (-1. / (y + x) / 100.) ) / max(1., pow(cd, 6.))`,\n        y: `4. * ((-1. / y / 50.) + (1.  / (x - y) / 100.) ) / max(1., pow(cd, 6.))`\n      };\n      codeLines.push(`v.x += pow(u_k4, 4.) * (${cloverfield.x});`);\n      codeLines.push(`v.y += pow(u_k4, 4.) * (${cloverfield.y});`);\n    codeLines.push(`}`);\n\n    codeLines.push(`v.x /= 2.;`);\n    codeLines.push(`v.y /= 2.;`);\n\n    return `\n    vec2 get_velocity(vec2 p) {\n      vec2 v = vec2(0., 0.);\n\n      ${codeLines.join('\\n')}\n\n      return v;\n    }`\n  }\n\n  updateVectorField () {\n    if (!this.scene)\n      return;\n\n    this.scene.vectorFieldEditorState.setCode(this.GLSLcode);\n  }\n\n  updateVariable (varName, value) {\n    if (!this.scene)\n      return;\n\n    this.scene.vectorFieldEditorState.updateVariable(varName, value);\n  }\n\n  updateColorVariable (value) {\n    if (!this.scene)\n      return;\n\n    this.scene.updateColorVariable(value);\n  }\n\n  get kColor () {\n    let ka = Math.pow((this.k2 - this.k1) / 2 + 0.5, 2);\n    let kb = Math.pow((this.k3 + this.k4 + this.k5) / 3, 2);\n    let k = ka + kb;\n\n    // clamp\n    k = Math.min(1, k);\n    k = Math.max(0, k);\n\n    return k;\n  }\n\n  get colorFunction() {\n    return `\n      vec4 get_color(vec2 p) {\n        vec2 velocity = get_velocity(p);\n        float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n        float hue = 0.05 + (1. - speed) * 0.5;\n        float hue1 = 1. - pow(hue, 3.) / 2. + 0.15;\n        float hue2 = .5 + pow(hue, 3.) / 2.;\n        hue = u_k * hue1 + (1. - u_k) * hue2;\n        return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n      }`;\n  }\n\n  updateColorFunction () {\n    if (!this.scene)\n      return;\n\n    this.scene.setColorFunction(this.colorFunction);\n  }\n\n  @Watch('k1')\n  k1Updated () {\n    this.updateVariable('k1', this.k1);\n  }\n  @Watch('k2')\n  k2Updated () {\n    this.updateVariable('k2', this.k2);\n  }\n  @Watch('k3')\n  k3Updated () {\n    this.updateVariable('k3', this.k3);\n  }\n  @Watch('k4')\n  k4Updated () {\n    this.updateVariable('k4', this.k4);\n  }\n  @Watch('k5')\n  k5Updated () {\n    this.updateVariable('k5', this.k5);\n  }\n\n  @Watch('kColor')\n  kColorUpdated () {\n    this.updateColorVariable(this.kColor);\n  }\n\n  @Watch('actuallyPaused')\n  togglePause () {\n    if (this.scene)\n      this.scene[this.actuallyPaused ? 'stop' : 'start']();\n  }\n\n  @Watch('particleCount')\n  updateParticleCount () {\n    if (this.scene)\n      this.scene.setParticlesCount(this.particleCount);\n  }\n\n  render (h: CreateElement): VNode {\n    return h('canvas', { class: 'brain-particles' });\n  }\n\n}\n","var render, staticRenderFns\nimport script from \"./FieldVisualization.vue?vue&type=script&lang=ts\"\nexport * from \"./FieldVisualization.vue?vue&type=script&lang=ts\"\nimport style0 from \"./FieldVisualization.vue?vue&type=style&index=0&id=70aec022&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70aec022\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldVisualization.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport _ from 'lodash';\nimport { Component, Inject, Vue } from 'vue-property-decorator';\nimport { MuseClient } from 'muse-js';\nimport { EEGRelativePowerBand, POWER_BANDS, FrequencyBand } from 'muse-js';\nimport { Observable } from 'rxjs/Observable';\nimport { Subscription } from 'rxjs/Subscription';\nimport { bufferCount, map } from 'rxjs/operators';\nimport Session from './Session.vue';\nimport Visualization from './Visualization.vue';\nimport ParticlesVisualization from './ParticlesVisualization.vue';\nimport FieldVisualization from './FieldVisualization.vue';\n\nimport FontAwesomeIcon from '@fortawesome/vue-fontawesome';\n\nimport fontawesome from '@fortawesome/fontawesome';\nimport faBluetooth from '@fortawesome/fontawesome-free-brands/faBluetooth';\nimport faBluetoothB from '@fortawesome/fontawesome-free-brands/faBluetoothB';\nimport faPlayCircle from '@fortawesome/fontawesome-free-regular/faPlayCircle';\nimport faPauseCircle from '@fortawesome/fontawesome-free-regular/faPauseCircle';\nimport faCaretSquareDown from '@fortawesome/fontawesome-free-regular/faCaretSquareDown';\nimport faCaretSquareUp from '@fortawesome/fontawesome-free-regular/faCaretSquareUp';\nimport faPlay from '@fortawesome/fontawesome-free-solid/faPlay';\nimport faStop from '@fortawesome/fontawesome-free-solid/faStop';\nimport faChartLine from '@fortawesome/fontawesome-free-solid/faChartLine';\nimport faInfoCircle from '@fortawesome/fontawesome-free-solid/faInfoCircle';\nimport faSyncAlt from '@fortawesome/fontawesome-free-solid/faSyncAlt';\nimport faSlidersH from '@fortawesome/fontawesome-free-solid/faSlidersH';\nimport faTimes from '@fortawesome/fontawesome-free-solid/faTimes';\n\nfontawesome.library.add(\n  faBluetooth, faBluetoothB,\n  faPlayCircle, faPauseCircle,\n  faCaretSquareDown, faCaretSquareUp,\n  faPlay, faStop,\n  faChartLine, faInfoCircle, faSyncAlt, faSlidersH, faTimes\n);\n\nexport interface AveragedRelativeBandPowers {\n  [index: string]: number;\n}\n\n@Component({\n  components: {\n    Session,\n    Visualization,\n    ParticlesVisualization,\n    FieldVisualization,\n    FontAwesomeIcon,\n  }\n})\nexport default class MuseRecorder extends Vue {\n  private museClient: MuseClient;\n  private connectionStatus: boolean = false;\n  private sessionInProgress: boolean = false;\n  private currentSessionSubscription: Subscription;\n  private vizControlsDisplayed: boolean = false;\n  private infoPanelOpened: boolean = false;\n\n  private currentSession: AveragedRelativeBandPowers[] = [];\n\n  private alpha: number = 0;\n  private beta1: number = 0;\n  private beta2: number = 0;\n  private beta3: number = 0;\n  private gamma: number = 0;\n  private n: number = 0;\n  private paused: boolean = true;\n  private sessionsDetailsOpened: boolean = false;\n\n  private created() {\n    this.museClient = new MuseClient();\n  }\n\n  private async connectToMuse() {\n    if (!this.connectionStatus) {\n      await this.museClient.connect();\n      await this.museClient.start();\n      this.museClient.connectionStatus.subscribe(\n        cS => this.connectionStatus = cS\n      );\n    }\n\n    this.startSession();\n  }\n\n  private startSession() {\n    this.currentSession = [];\n    // @ts-ignore\n    this.currentSessionSubscription = (this.museClient.relativeBandPowers as Observable<EEGRelativePowerBand[]>)\n      .pipe(\n        bufferCount(100, 25)\n      ,\n        map( (sessions: EEGRelativePowerBand[][]): EEGRelativePowerBand[] =>\n          Object.keys(POWER_BANDS).map( (k): EEGRelativePowerBand => {\n            return {\n              band: POWER_BANDS[k],\n              power: sessions.map(\n                  (session: EEGRelativePowerBand[]): number => {\n                    let bandSession = session.find( r => r.band.id == POWER_BANDS[k].id );\n                    if (bandSession) {\n                      return bandSession.power;\n                    } else {\n                      return NaN;\n                    }\n                  }\n                ).reduce(\n                  ((sumOfSessions, bandSessionValue) =>\n                    sumOfSessions += bandSessionValue\n                  ), 0\n                ) / sessions.length\n            };\n          })\n        )\n      ,\n        map( (rbps: EEGRelativePowerBand[]): AveragedRelativeBandPowers => {\n          let arbps: AveragedRelativeBandPowers = {};\n          rbps.forEach( (rbp) => arbps[rbp.band.id] = rbp.power );\n          return arbps;\n        })\n      ).subscribe(\n        (arbps: AveragedRelativeBandPowers) => {\n          if ( _.some(arbps, v => _.isNaN(v) ) )\n            return;\n          this.currentSession.push(Object.freeze(arbps));\n          this.currentSession = _.takeRight(this.currentSession, 100);\n          this.n = Math.min(this.currentSession.length * 5, 100);\n          this.alpha = (\n            arbps.ALPHA - Math.min(...this.currentSession.map( d => d.ALPHA ))\n          ) / (\n            Math.max(...this.currentSession.map( d => d.ALPHA )) - Math.min(...this.currentSession.map( d => d.ALPHA ))\n          );\n          this.gamma = (\n            arbps.GAMMA - Math.min(...this.currentSession.map( d => d.GAMMA ))\n          ) / (\n            Math.max(...this.currentSession.map( d => d.GAMMA )) - Math.min(...this.currentSession.map( d => d.GAMMA ))\n          );\n          this.beta1 = (\n            arbps.BETA_1 - Math.min(...this.currentSession.map( d => d.BETA_1 ))\n          ) / (\n            Math.max(...this.currentSession.map( d => d.BETA_1 )) - Math.min(...this.currentSession.map( d => d.BETA_1 ))\n          );\n          this.beta2 = (\n            arbps.BETA_2 - Math.min(...this.currentSession.map( d => d.BETA_2 ))\n          ) / (\n            Math.max(...this.currentSession.map( d => d.BETA_2 )) - Math.min(...this.currentSession.map( d => d.BETA_2 ))\n          );\n          this.beta3 = (\n            arbps.BETA_3 - Math.min(...this.currentSession.map( d => d.BETA_3 ))\n          ) / (\n            Math.max(...this.currentSession.map( d => d.BETA_3 )) - Math.min(...this.currentSession.map( d => d.BETA_3 ))\n          );\n        }\n      );\n    this.sessionInProgress = true;\n    this.paused = false;\n  }\n\n  private stopSession() {\n    if (this.currentSessionSubscription) {\n      this.currentSessionSubscription.unsubscribe();\n    }\n    this.sessionInProgress = false;\n    this.paused = true;\n    this.n = 0;\n  }\n\n  private toggleVizControlsDisplayed() {\n    this.vizControlsDisplayed = !this.vizControlsDisplayed;\n  }\n\n  private reload() {\n    window.location.reload();\n  }\n\n  private beforeDestroy() {\n    this.stopSession();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MuseRecorder.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./MuseRecorder.vue?vue&type=template&id=3840bb7b&scoped=true\"\nimport script from \"./MuseRecorder.vue?vue&type=script&lang=ts\"\nexport * from \"./MuseRecorder.vue?vue&type=script&lang=ts\"\nimport style0 from \"./MuseRecorder.vue?vue&type=style&index=0&id=3840bb7b&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3840bb7b\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport MuseRecorder from './components/MuseRecorder.vue';\n\n@Component({\n  components: {\n    MuseRecorder,\n  },\n})\nexport default class App extends Vue {}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0a24d9f9\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\nimport Vuex from 'vuex';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n\n  },\n  mutations: {\n\n  },\n  actions: {\n\n  },\n});\n","/* tslint:disable:no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`${process.env.BASE_URL}/service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n' +\n        'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","import Vue from 'vue';\nimport App from './App.vue';\nimport store from './store';\nimport './registerServiceWorker';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  store,\n  render: (h) => h(App),\n}).$mount('#app');\n"],"sourceRoot":""}