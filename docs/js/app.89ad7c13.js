(function(e){function t(t){for(var r,a,u=t[0],s=t[1],c=t[2],l=0,f=[];l<u.length;l++)a=u[l],o[a]&&f.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},o={2:0},i=[];function a(e){return u.p+"js/"+({}[e]||e)+"."+{0:"cae90ce0"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=o[e]=[t,r]});t.push(n[2]=r);var i,s=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.timeout=120,u.nc&&c.setAttribute("nonce",u.nc),c.src=a(e),i=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+r+": "+i+")");a.type=r,a.request=i,n[1](a)}o[e]=void 0}};var l=setTimeout(function(){i({type:"timeout",target:c})},12e4);c.onerror=c.onload=i,s.appendChild(c)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/brain-control/",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;i.push([6,1]),n()})({"/xrv":function(e,t,n){},6:function(e,t,n){e.exports=n("zUnb")},CMpb:function(e,t,n){var r=n("AMdQ");e.exports=r({})},GTMW:function(e,t,n){"use strict";var r=n("/xrv"),o=n.n(r);o.a},Qy1J:function(e,t,n){"use strict";var r=n("cnv3"),o=n.n(r);o.a},TYmm:function(e,t,n){},VMzV:function(e,t,n){"use strict";var r=n("Zoq1"),o=n.n(r);o.a},Zoq1:function(e,t,n){},cnv3:function(e,t,n){},d8lz:function(e,t,n){"use strict";var r=n("n52j"),o=n.n(r);o.a},n52j:function(e,t,n){},nNx0:function(e,t,n){"use strict";var r=n("uWEC"),o=n.n(r);o.a},uWEC:function(e,t,n){},wuxX:function(e,t,n){"use strict";var r=n("TYmm"),o=n.n(r);o.a},zUnb:function(e,t,n){"use strict";n.r(t);n("VRzm");var r=n("Kw5r"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"muse-recorder-app"}},[n("MuseRecorder")],1)},i=[],a=n("xmWZ"),u=n("3Aqn"),s=n("0yhX"),c=n("EdlT"),l=n("a94B"),d=n("gvf+"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"muse-recorder"},[n("div",{staticClass:"muse-recorder__viz-container"},[n("field-visualization",{attrs:{alpha:e.alpha,beta1:e.beta1,beta2:e.beta2,beta3:e.beta3,gamma:e.gamma,n:e.n,paused:e.paused}})],1),0==e.n?n("div",{staticClass:"muse-recorder__greeting",class:{"muse-recorder__greeting--connected":e.connectionStatus&&!e.paused}},[e._m(0),n("div",{staticClass:"muse-recorder__greeting-tuto"},[n("div",{staticClass:"muse-recorder__greeting-tuto-intro"},[e._v("\n        Turn on the headband, adjust it on your forehead and observe...\n      ")]),n("div",{staticClass:"muse-recorder__greeting-tuto-button",on:{click:function(t){e.connectToMuse()}}},[e._v("\n        Start "),n("font-awesome-icon",{staticStyle:{"font-size":"smaller"},attrs:{icon:"play"}})],1),n("div",{staticClass:"muse-recorder__greeting-tuto-outro"},[e._v("\n        When your finished or before passing the headband to someone else, hit STOP "),n("font-awesome-icon",{staticStyle:{"font-size":"smaller"},attrs:{icon:"stop"}})],1)])]):e._e(),e.sessionsDetailsOpened?n("div",{staticClass:"muse-recorder__session-details"},[e.currentSession.length?n("Session",{attrs:{sessionData:e.currentSession}}):n("div",[e._v("\n      No session data\n    ")])],1):e._e(),e.sessionInProgress?n("div",{staticClass:"muse-recorder__chart-toggle",on:{click:function(t){e.sessionsDetailsOpened=!e.sessionsDetailsOpened}}},[n("font-awesome-icon",{attrs:{icon:["fas",e.sessionsDetailsOpened?"times":"chart-line"]}})],1):e._e(),e.sessionInProgress?n("div",{staticClass:"muse-recorder__stop-button",on:{click:function(t){e.stopSession()}}},[e._v("\n    Stop "),n("font-awesome-icon",{attrs:{icon:"stop"}})],1):e._e(),e.vizControlsDisplayed?n("div",{staticClass:"muse-recorder__viz-controls"},[n("div"),n("button",{on:{click:function(t){e.paused=!e.paused}}},[e._v(" Play/pause viz\n    ")]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.alpha,expression:"alpha",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.alpha},on:{__r:function(t){e.alpha=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("alpha: "+e._s(e.alpha))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.beta1,expression:"beta1",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.beta1},on:{__r:function(t){e.beta1=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("beta1: "+e._s(e.beta1))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.beta2,expression:"beta2",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.beta2},on:{__r:function(t){e.beta2=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("beta2: "+e._s(e.beta2))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.beta3,expression:"beta3",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.beta3},on:{__r:function(t){e.beta3=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("beta3: "+e._s(e.beta3))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.gamma,expression:"gamma",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.gamma},on:{__r:function(t){e.gamma=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("gamma: "+e._s(e.gamma))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.n,expression:"n",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"100",step:"1"},domProps:{value:e.n},on:{__r:function(t){e.n=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}}),n("pre",[e._v("n: "+e._s(e.n))])]),n("button",{on:{click:function(t){e.reload()}}},[e._v(" Not working? Reload the page\n    ")])]):e._e(),n("div",{staticClass:"muse-recorder__viz-controls-toggle",on:{click:e.toggleVizControlsDisplayed}},[n("font-awesome-icon",{attrs:{icon:["fas",e.vizControlsDisplayed?"times":"sliders-h"]}})],1),e.infoPanelOpened?n("div",{staticClass:"muse-recorder__info-panel"},[n("div",[n("div",{staticClass:"muse-recorder__greeting-tuto-button",on:{click:function(t){e.infoPanelOpened=!1}}},[e._v("\n        Close\n      ")]),e._m(1),e._m(2),e._m(3),n("p",[e._v("\n        It's easy for some people to control their brainwaves in a way, while it's quite difficult to impossible for others.\n        Take some time to try to calm yoursel or concentrate on something, or just let your mind wander and see what happens.\n        One simple exercice some manage very well is to close your eyes for a few seconds and empty your mind: for some people ths triggers a load of alpha waves, which make the light blue circling vortex appear.\n      ")]),n("p",[e._v("\n        It's very important to reset the device with the Stop button each time the headband changes heads.\n        The levels can be different among people, so the system auto-calibrates in some seconds on the beginning of each session.\n        Hitting stop/start reset this calibration.\n      ")]),e._m(4),e._m(5),e._m(6),n("div",{staticClass:"muse-recorder__greeting-tuto-button",on:{click:function(t){e.infoPanelOpened=!1}}},[e._v("\n        Close\n      ")])])]):e._e(),n("div",{staticClass:"muse-recorder__info-toggle",on:{click:function(t){e.infoPanelOpened=!e.infoPanelOpened}}},[n("font-awesome-icon",{attrs:{icon:["fas",e.infoPanelOpened?"times":"info-circle"]}})],1)])},p=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"muse-recorder__greeting-title"},[n("div",{staticStyle:{"font-size":"6em"}},[e._v("Do you feel in control")]),n("div",{staticStyle:{"font-size":"4em"}},[e._v("of what's happenning")]),n("div",{staticStyle:{"font-size":"8em"}},[e._v("in your brain?")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("What is this installation?")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        This installation uses a headband to listen to your brain eletrical rythms."),n("br"),e._v("\n        It then computes the power of particular rythms and translates them into a particles vizualisation.\n      ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v('\n        These rythms, called "Alpha", "Beta" and "Gamma" waves are the object of many scientific research to date.\n        What they represent in tems of "state of mind" is not that easy to determine, and a scientific consensus about them is not yet reached.'),n("br"),e._v("\n        Still, there is many knowledge and information about them in books and on the web, which I used to create this art: "),n("br"),n("ul",[n("li",[e._v("alpha waves are up in calm state")]),n("li",[e._v("beta waves are present when you're awake, and are divised in three:\n            "),n("ul",[n("li",[e._v('low-beta indicates regular awakeness, a "fast idle" mind')]),n("li",[e._v("mid-beta could appear when engaging or actively figuring something out")]),n("li",[e._v("high-beta would be the sign of highly complex thought, integrating new experiences, high anxiety or excitement")])])]),n("li",[e._v("it's speculated that gamma rhythms modulate perception and consciousness, and that a greater presence of gamma relates to expanded consciousness and spiritual emergence")])]),e._v("\n        Treat these interpretations with caution: they are not scientifcally endorsed and perception could vary a lot from one individual to another.\n      ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        I've been able to create this based on these amazing libraries:\n        "),n("ul",[n("li",[e._v("muse-js by Uri Shaked")]),n("li",[e._v("field-play by Andrei Kashcha")]),n("li",[e._v("DSP.js by Corban Brook")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        Intrigued? A question? Wanna talk about it or just need some help?"),n("br"),e._v("\n        Find David at Barrio Wonderever or contact me on Twitter or GitHub @davinov\n      ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        If you have Muse headband and a web-bluetooth enabled browser (Chrome on Android or Mac), you can reproduce at home with https://david.nowinsky.net/brain-control"),n("br"),e._v("\n        Source code is available on https://github.com/davinov/brain-control\n      ")])}],h=n("iv4g"),m=(n("DW2E"),n("dRSK"),n("rGqo"),n("yt8O"),n("RW0V"),n("ls82"),n("qpph")),v=n("LvDl"),g=n.n(v),b=n("v7px"),y=n("/wT/"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"muse-recorder__session"},[n("svg",{staticClass:"session__chart",attrs:{width:e.width,height:e.height}},e._l(e.series,function(t){return n("path",{key:t,class:["session__serie","session__serie--"+t.toLowerCase()],attrs:{d:e.lineForSerie(t)}})})),n("div",{staticClass:"session__legend"},e._l(e.series,function(t){return n("div",{key:t,class:["session__legend__item","session__legend__item--"+t.toLowerCase()]},[n("div",{staticClass:"session__legend__item__color"}),n("span",[e._v(e._s(t))]),e._v(" - "),n("span",[e._v(" "+e._s(e.lastSessionPointForSerie(t))+" ")])])}))])},x=[],w=(n("xfY5"),n("DBpu")),k=n("4jaM"),O=n("JEAp"),P=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e){function t(){return Object(a["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(m["a"])(t,[{key:"lineForSerie",value:function(e){var t=this;return Object(w["b"])()(this.sessionData.map(function(n,r){return[t.xScale(r),t.yScale(n[e])]}))}},{key:"saveAsJSON",value:function(){var e=new Blob([JSON.stringify(this.sessionData,null,2)],{type:"application/json;charset=utf-8"}),t=new Date,n="muse-session-".concat(t.toISOString(),".json");Object(O["saveAs"])(e,n)}},{key:"series",get:function(){return Object.keys(this.sessionData[0]||{})}},{key:"xScale",get:function(){return Object(k["a"])().domain([0,this.sessionData.length-1]).range([0,this.width])}},{key:"yScale",get:function(){return Object(k["a"])().domain([0,.5]).range([this.height,0])}},{key:"lastSessionPointForSerie",get:function(){var e=g.a.last(this.sessionData);return function(t){return e&&e[t]?e[t]:"-"}}}]),Object(u["a"])(t,e),t}(d["Vue"]);P([Object(d["Prop"])({default:[]}),T("design:type",Array)],E.prototype,"sessionData",void 0),P([Object(d["Prop"])({default:800}),T("design:type",Number)],E.prototype,"width",void 0),P([Object(d["Prop"])({default:500}),T("design:type",Number)],E.prototype,"height",void 0),E=P([d["Component"]],E);var M=E,C=M,j=(n("d8lz"),n("KHd+")),S=Object(j["a"])(C,_,x,!1,null,"684ff5ac",null),R=S.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticClass:"brain-visualization",attrs:{height:e.height,width:e.width}},[n("defs",[n("filter",{attrs:{id:"goo"}},[n("feGaussianBlur",{attrs:{in:"SourceGraphic",stdDeviation:"10",result:"blur"}}),n("feColorMatrix",{attrs:{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -18",result:"goo"}}),n("feComposite",{attrs:{in:"SourceGraphic",in2:"goo",operator:"atop"}})],1)]),n("g",{staticClass:"brain-wires"},e._l(e.brainWires(e.tk1,e.tk2),function(t,r){return n("path",{key:r,staticClass:"brain-wire",attrs:{filter:"url(#goo)",transform:e.originTranslation,d:t,fill:e.colors[r]}})}))])},F=[],D=n("7p8r"),N=n("s+xS"),B=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},U=function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.tk1=e.k1,e.tk2=e.k2,e.colors=["#00f","#0f0","#f00"],e}return Object(m["a"])(t,[{key:"animateK1",value:function(e){var t=this,n=1e3,r=Date.now(),o=Object(D["b"])(this.tk1,e),i=function i(){var a=(Date.now()-r)/n;a>=1?t.tk1=e:(requestAnimationFrame(i),t.tk1=o(a))};i()}},{key:"animateK2",value:function(e){var t=this,n=1e3,r=Date.now(),o=Object(D["b"])(this.tk2,e),i=function i(){var a=(Date.now()-r)/n;a>=1?t.tk2=e:(requestAnimationFrame(i),t.tk2=o(a))};i()}},{key:"brainWires",value:function(e,t){var n=this;return[-.5,0,.5].map(function(r){return n.brainWire(e,t,r)})}},{key:"brainWire",value:function(e,t,n){var r=Object(w["b"])().curve(w["a"].tension(n));return r(this.wirePoints(e,t,n))}},{key:"wirePoints",value:function(e,t,n){var r=e+Object(N["a"])(n)*(t-e),o=[this.leftPoint(r,n),this.leftMiddlePoint(r,n),this.middlePoint(r,n),this.rightMiddlePoint(r,n),this.rightPoint(r,n)],i=100,a=o.map(function(e){return[e[0],e[1]+i/2]}).concat(o.reverse().map(function(e){return[e[0],-e[1]-i/2]}));return a.push(a[0]),a.map(this.verticalTranslation(-this.width/2-2*(1-Math.max(e,t))*n*this.radius))}},{key:"leftPoint",value:function(e,t){return[Object(D["b"])(-this.width/2,-this.radius)(Object(N["c"])(e)),Object(D["b"])(0,this.radius)(t*e)]}},{key:"leftMiddlePoint",value:function(e,t){var n=Object(D["b"])(Math.SQRT2/2,1);return[Object(D["b"])(-this.width/4,-this.radius*n(t))(Object(N["c"])(e)),Object(D["b"])(0,-this.radius*n(t))(Object(N["b"])(e))+Object(D["b"])(0,this.radius)(t*e)]}},{key:"middlePoint",value:function(e,t){return[0,Object(D["b"])(0,-this.radius)(Object(N["d"])(e))+Object(D["b"])(0,this.radius)(t*e)]}},{key:"rightMiddlePoint",value:function(e,t){return this.verticalSymetry(this.leftMiddlePoint(e,t))}},{key:"rightPoint",value:function(e,t){return this.verticalSymetry(this.leftPoint(e,t))}},{key:"verticalSymetry",value:function(e){return[-e[0],e[1]]}},{key:"horizontalSymetry",value:function(e){return[e[0],-e[1]]}},{key:"verticalTranslation",value:function(e){return function(t){return[t[0],e+t[1]]}}},{key:"originTranslation",get:function(){return"translate(".concat(this.width/2,", ").concat(this.height,")")}},{key:"radius",get:function(){return Math.sqrt(Math.pow(this.width/2,2)+Math.pow(this.height/2,2))/2}}]),Object(u["a"])(t,e),t}(d["Vue"]);B([Object(d["Prop"])({default:1}),U("design:type",Number)],I.prototype,"k1",void 0),B([Object(d["Prop"])({default:1}),U("design:type",Number)],I.prototype,"k2",void 0),B([Object(d["Watch"])("k1"),U("design:type",Function),U("design:paramtypes",[Number]),U("design:returntype",void 0)],I.prototype,"animateK1",null),B([Object(d["Watch"])("k2"),U("design:type",Function),U("design:paramtypes",[Number]),U("design:returntype",void 0)],I.prototype,"animateK2",null),B([Object(d["Prop"])({default:800}),U("design:type",Number)],I.prototype,"height",void 0),B([Object(d["Prop"])({default:800}),U("design:type",Number)],I.prototype,"width",void 0),I=B([d["Component"]],I);var X=I,G=X,L=(n("Qy1J"),Object(j["a"])(G,A,F,!1,null,"888b4562",null)),V=L.exports,Y=(n("bHtr"),n("Womt")),z=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},W=function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},q=200,H={X:2*q,Y:2*q},$=q*Math.SQRT2,K=1e3,J=.001,Q=function(e){function t(){return Object(a["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(m["a"])(t,[{key:"created",value:function(){this.scene=new Y["j"],this.renderer=new Y["n"]({preserveDrawingBuffer:!0}),this.renderer.autoClearColor=!1,this.camera=new Y["f"](120,window.innerWidth/window.innerHeight,.1,1e3);var e=new Y["d"]({color:0,transparent:!0,opacity:.04,depthWrite:!1}),t=new Y["g"](1,1),n=new Y["c"](t,e),r=new Y["e"];r.add(this.camera),r.add(n),r.translateZ(q),n.position.z=-.1,n.renderOrder=-1,this.scene.add(r);var o=new Y["i"]({size:2,vertexColors:Y["m"],opacity:.6,transparent:!0,map:this.createCanvasMaterial("white",64),depthWrite:!1});this.geometry=new Y["b"],g.a.times(K,this.addRandomPoint),this.points=new Y["h"](this.geometry,o),this.scene.add(this.points)}},{key:"randomPositionOnPlane",value:function(){return new Y["l"](2*(Math.random()-.5)*H.X,2*(Math.random()-.5)*H.Y,0)}},{key:"addRandomPoint",value:function(){this.geometry.vertices.push(this.randomPositionOnPlane()),this.geometry.colors.push(new Y["a"](Math.random(),Math.random(),Math.random()))}},{key:"mounted",value:function(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.animate(),this.$el.appendChild(this.renderer.domElement)}},{key:"animate",value:function(){var e=this;this.geometry.vertices.map(function(t){if(Math.random()<=J){var n=e.randomPositionOnPlane();t.set(n.x,n.y,n.z),e.geometry.verticesNeedUpdate=!0}}),g.a.isNaN(this.k1)||g.a.isNaN(this.k2)||(this.geometry.vertices.map(function(t){var n=e.horizontalMovement(t),r=e.circularMovement(t),o=e.squareMovement(t),i=function(t,n,r){return e.circleWeigth*n+e.squareWeigth*r+e.horizontalWeigth*t},a=[i(n[0],r[0],o[0]),i(n[1],r[1],o[1])];e.moveParticle(t,a)}),this.geometry.verticesNeedUpdate=!0),this.geometry.colors.map(function(e){var t,n,r;t=(Math.random()-.5)/5,n=(Math.random()-.5)/5,r=(Math.random()-.5)/5,e.add(new Y["a"](t,n,r))}),this.geometry.colorsNeedUpdate=!0,this.renderer.render(this.scene,this.camera),this.continue()}},{key:"createCanvasMaterial",value:function(e,t){var n=document.createElement("canvas");n.width=n.height=t;var r=n.getContext("2d"),o=new Y["k"](n);if(!r)return new Y["k"];var i=t/2;return r.beginPath(),r.arc(i,i,i,0,2*Math.PI),r.closePath(),r.fillStyle=e,r.fill(),o.needsUpdate=!0,o}},{key:"moveParticle",value:function(e,t){e.x+=t[0],e.y+=t[1],e.x>H.X&&(e.x=-1*H.X),e.x<-1*H.X&&(e.x=H.X),e.y>H.Y&&(e.y=-1*H.Y),e.y<-1*H.Y&&(e.y=H.Y)}},{key:"horizontalMovement",value:function(e){return[1,Math.sin(e.x/16/Math.PI)/2]}},{key:"circularMovement",value:function(e){var t=Math.pow(Math.pow(e.x,2)+Math.pow(e.y,2),.5),n=Math.atan2(e.y,e.x),r=($-t)/250,o=2*Math.PI/2e3;return[r*Math.cos(n)-t*Math.sin(n)*o,r*Math.cos(n)+t*Math.cos(n)*o]}},{key:"squareMovement",value:function(e){var t,n,r=e.x,o=e.y;return r>=0?(n=1,o>=0?(o/(1-r),t=-1):(o/(r-1),t=1)):(n=-1,o>0?(o/(r+1),t=-1):(o/(-1-r),t=1)),[t,n]}},{key:"continue",value:function(){this.paused||(this.lastAnimationId=window.requestAnimationFrame(this.animate))}},{key:"pause",value:function(){this.lastAnimationId&&window.cancelAnimationFrame(this.lastAnimationId),this.lastAnimationId=void 0}},{key:"onPausedChanged",value:function(){this.paused?this.pause():this.continue()}},{key:"render",value:function(e){return e("div",{class:"brain-particles"})}},{key:"destroyed",value:function(){this.pause(),this.renderer.dispose(),this.geometry.dispose()}},{key:"horizontalWeigth",get:function(){return 1-Math.max(this.k1,this.k2)}},{key:"circleWeigth",get:function(){return this.k1+this.k2===0?0:this.k1}},{key:"squareWeigth",get:function(){return this.k1+this.k2===0?0:this.k2}}]),Object(u["a"])(t,e),t}(d["Vue"]);z([Object(d["Prop"])({required:!0}),W("design:type",Number)],Q.prototype,"k1",void 0),z([Object(d["Prop"])({required:!0}),W("design:type",Number)],Q.prototype,"k2",void 0),z([Object(d["Prop"])({default:!1}),W("design:type",Boolean)],Q.prototype,"paused",void 0),z([Object(d["Watch"])("paused"),W("design:type",Function),W("design:paramtypes",[]),W("design:returntype",void 0)],Q.prototype,"onPausedChanged",null),Q=z([d["Component"]],Q);var Z,ee,te=Q,ne=te,re=(n("GTMW"),Object(j["a"])(ne,Z,ee,!1,null,"2f884374",null)),oe=re.exports,ie=(n("/KAi"),n("XfKG"),n("Y9lz"),n("f3/d"),n("NO8f"),{createTexture:se,bindFramebuffer:ce,createProgram:de,createBuffer:ue,bindAttribute:le,bindTexture:ae});function ae(e,t,n){e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t)}function ue(e,t){var n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),n}function se(e,t,n,r,o){var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),n instanceof Uint8Array?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,o,0,e.RGBA,e.UNSIGNED_BYTE,n):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null),i}function ce(e,t,n){e.bindFramebuffer(e.FRAMEBUFFER,t),n&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}function le(e,t,n,r){e.bindBuffer(e.ARRAY_BUFFER,t),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,r,e.FLOAT,!1,0,0)}function de(e,t,n){var r=e.createProgram(),o=fe(e,e.VERTEX_SHADER,t),i=fe(e,e.FRAGMENT_SHADER,n);if(e.attachShader(r,o),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(r));var a,u={program:r,unload:f},s=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(a=0;a<s;a++){var c=e.getActiveAttrib(r,a);u[c.name]=e.getAttribLocation(r,c.name)}var l=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(a=0;a<l;a++){var d=e.getActiveUniform(r,a);u[d.name]=e.getUniformLocation(r,d.name)}return u;function f(){e.deleteProgram(r)}}function fe(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r}var pe=n("CMpb"),he=n.n(pe),me=n("nPQq"),ve=n.n(me),ge={UNIFORM:1,VELOCITY:2,ANGLE:3,CUSTOM:4};function be(e){return"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  ".concat(e,"\n\n  return v;\n}")}function ye(){return window.innerWidth<600}var _e,xe=ve()({},{useSearch:!0,rewriteHashToSearch:!0}),we={},ke=be("v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;"),Oe={timeStep:.01,dropProbability:.009,particleCount:1e4,fadeout:.998,colorMode:ge.UNIFORM},Pe={collapsed:ye()},Te={settingsPanel:Pe,saveBBox:Ge,getBBox:Ie,makeBBox:Xe,getQS:function(){return xe},saveCode:Ye,getCode:Le,getDefaultCode:Ve,getDropProbability:Be,setDropProbability:Ue,getIntegrationTimeStep:De,setIntegrationTimeStep:Ne,getParticleCount:Ae,setParticleCount:Fe,getFadeout:Se,setFadeout:Re,getColorMode:Ee,setColorMode:Me,getColorFunction:Ce,setColorFunction:je};function Ee(){var e=xe.get("cm");return ze(e)?e:Oe.colorMode}function Me(e){ze(e)&&(we.cm=e)}function Ce(){var e=xe.get("cf");return e||""}function je(e){we.cf=e}function Se(){var e=xe.get("fo");return ze(e)?e:Oe.fadeout}function Re(e){ze(e)&&(we.fo=e)}function Ae(){var e=xe.get("pc");return ze(e)?e:Oe.particleCount}function Fe(e){ze(e)&&(we.pc=e)}function De(){var e=xe.get("dt");return ze(e)?e:Oe.timeStep}function Ne(e){ze(e)&&(we.dt=e)}function Be(){var e=xe.get("dp");return ze(e)?e:Oe.dropProbability}function Ue(e){ze(e)&&We(e,0,1)}function Ie(){var e=xe.get("cx"),t=xe.get("cy"),n=xe.get("w"),r=xe.get("h");return Xe(e,t,n,r)}function Xe(e,t,n,r){var o=ze(e)&&ze(t)&&ze(n)&&ze(r);if(o){var i=n/2,a=r/2,u=1e4;return{minX:Math.round(u*(e-i))/u,maxX:Math.round(u*(e+i))/u,minY:Math.round(u*(t-a))/u,maxY:Math.round(u*(t+a))/u}}}function Ge(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e={cx:.5*(e.minX+e.maxX),cy:.5*(e.minY+e.maxY),w:e.maxX-e.minX,h:e.maxX-e.minX},e.w<=0||e.h<=0||(we.cx=e.cx,we.cy=e.cy,we.w=e.w,we.h=e.h,_e?(clearTimeout(_e),_e=0):_e=setTimeout(function(){_e=0},300))}function Le(){var e=xe.get("vf");if(e)return e;var t=xe.get("code");return t?(e=be(t),delete we.code,e):ke}function Ve(){return ke}function Ye(e){we.code=e}function ze(e){return Number.isFinite(e)}function We(e,t,n){return e<t?t:e>n?n:e}xe.onChange(function(){he.a.fire("scene-ready",window.scene)});var qe={dx:0,dy:0,scale:1};function He(e){var t,n,r=e.gl,o=e.canvasRect,i={dx:0,dy:0,scale:1},a=null;d();var u=ie.createProgram(r,$e(),Ke()),s={fadeOutLastFrame:c,renderCurrentScreen:l,updateScreenTextures:d,boundingBoxUpdated:!1};return s;function c(){ie.bindFramebuffer(r,e.framebuffer,t),r.viewport(0,0,o.width,o.height),s.boundingBoxUpdated&&a?(i.dx=-(e.bbox.minX-a.minX)/(e.bbox.maxX-e.bbox.minX),i.dy=-(e.bbox.minY-a.minY)/(e.bbox.maxY-e.bbox.minY),i.scale=(e.bbox.maxX-e.bbox.minX)/(a.maxX-a.minX),p(n,e.fadeOpacity,i)):p(n,e.fadeOpacity,qe)}function l(){ie.bindFramebuffer(r,null),f(),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.DST_ALPHA),r.clearColor(e.backgroundColor.r,e.backgroundColor.g,e.backgroundColor.b,e.backgroundColor.a),r.clear(r.COLOR_BUFFER_BIT),p(t,1,qe),r.disable(r.BLEND);var o=n;n=t,t=o,s.boundingBoxUpdated=!1,window.audioTexture&&p(window.audioTexture,1,qe)}function d(){var e=o.width,i=o.height,a=new Uint8Array(e*i*4);t&&r.deleteTexture(t),n&&r.deleteTexture(n),t=ie.createTexture(r,r.NEAREST,a,e,i),n=ie.createTexture(r,r.NEAREST,a,e,i)}function f(){a?(a.minX=e.bbox.minX,a.minY=e.bbox.minY,a.maxX=e.bbox.maxX,a.maxY=e.bbox.maxY):a={minX:e.bbox.minX,minY:e.bbox.minY,maxX:e.bbox.maxX,maxY:e.bbox.maxY}}function p(t,n,o){var i=u;r.useProgram(i.program),ie.bindAttribute(r,e.quadBuffer,i.a_pos,2),ie.bindTexture(r,t,e.screenTextureUnit),r.uniform1i(i.u_screen,e.screenTextureUnit),r.uniform1f(i.u_opacity_border,.02),r.uniform1f(i.u_opacity,n),r.uniform3f(i.u_transform,o.dx,o.dy,o.scale),r.drawArrays(r.TRIANGLES,0,6)}}function $e(){return"// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}"}function Ke(){return"precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n}"}var Je="\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n",Qe=Je,Ze=function(){function e(){Object(a["a"])(this,e)}return Object(m["a"])(e,[{key:"getDefines",value:function(){return""}},{key:"getFunctions",value:function(){return""}},{key:"getMainBody",value:function(){return""}}]),e}(),et="\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n",tt=et;function nt(){return"uniform sampler2D input0;\nuniform sampler2D input1;"}var rt=function(e){function t(e){var n;return Object(a["a"])(this,t),n=Object(s["a"])(this,Object(c["a"])(t).call(this)),n.updateCode=e||"",n}return Object(m["a"])(t,[{key:"setNewUpdateCode",value:function(e){this.updateCode=e}},{key:"getDefines",value:function(){return"\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\nuniform float u_k1;\nuniform float u_k2;\nuniform float u_k3;\nuniform float u_k4;\nuniform float u_k5;\n\n#define PI 3.1415926535897932384626433832795\n\n".concat(nt(),"\n")}},{key:"getFunctions",value:function(){return"\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n".concat(tt,"\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n").concat(this.updateCode?this.updateCode:"vec2 get_velocity(vec2 p) { return vec2(0.); }","\n  ")}}]),Object(u["a"])(t,e),t}(Ze),ot=function(e){function t(){return Object(a["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).call(this))}return Object(m["a"])(t,[{key:"getDefines",value:function(){return"\nuniform float u_h;\n"}},{key:"getFunctions",value:function(){return"\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}"}},{key:"getMainBody",value:function(){return"\n  vec2 velocity = rk4(pos);\n"}}]),Object(u["a"])(t,e),t}(Ze);function it(e,t,n){var r=new rt(t),o=new ot;return{getVariables:i,getMain:s,getMethods:a};function i(){return"\nuniform vec2 u_velocity_range;\nuniform float u_k;\nvarying vec4 v_particle_color;\n\n".concat(r.getDefines(),"\n").concat(o.getDefines(),"\n")}function a(){return"\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n".concat(r.getFunctions(),"\n").concat(o.getFunctions(),"\n").concat(u(),"\n")}function u(){if(e===ge.UNIFORM)return"\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n";if(e===ge.VELOCITY)return n||"\n        vec4 get_color(vec2 p) {\n          vec2 velocity = get_velocity(p);\n          float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n          float hue = 0.05 + (1. - speed) * 0.5;\n          return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n        }\n      ";if(e===ge.CUSTOM){if(!n)throw new Error("color mode is set to custom, but no color function is specified");return n}return" \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n"}function s(){return"  v_particle_color = get_color(v_particle_pos);"}}var at=function(){function e(t){Object(a["a"])(this,e),this.colorMode=t.colorMode,this.colorFunction=t.colorFunction||""}return Object(m["a"])(e,[{key:"getFragmentShader",value:function(){return"precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}"}},{key:"getVertexShader",value:function(e){var t=ct(),n=it(this.colorMode,e,this.colorFunction),r=[];ut(t,r),ut(n,r);var o=[];return st(t,o),st(n,o),"precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n".concat(t.getVariables()||"","\n").concat(n.getVariables(),"\n\n").concat(Qe,"\n\n").concat(r.join("\n"),"\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n").concat(o.join("\n"),"\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}")}}]),e}();function ut(e,t){e.getMethods&&t.push(e.getMethods())}function st(e,t){e.getMain&&t.push(e.getMain())}function ct(){return{getVariables:e,getMain:t};function e(){return"\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    "}function t(){return"\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n"}}var lt="\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n",dt=lt,ft=function(e){function t(e){var n;return Object(a["a"])(this,t),n=Object(s["a"])(this,Object(c["a"])(t).call(this)),n.isDecode=e,n}return Object(m["a"])(t,[{key:"getFunctions",value:function(){if(this.isDecode)return"\n    ".concat(dt,"\n    ").concat(Qe,"\n")}},{key:"getDefines",value:function(){if(this.isDecode)return"\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n"}},{key:"getMainBody",value:function(){return this.isDecode?"\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n":"\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n"}}]),Object(u["a"])(t,e),t}(Ze);function pt(e){var t=[];return e.forEach(function(e){e.getDefines&&n(e.getDefines())}),e.forEach(function(e){e.getFunctions&&n(e.getFunctions())}),n("void main() {"),e.forEach(function(e){e.getMainBody&&n(e.getMainBody())}),n("}"),t.join("\n");function n(e){e&&t.push(e)}}var ht=function(e){function t(e){var n;return Object(a["a"])(this,t),n=Object(s["a"])(this,Object(c["a"])(t).call(this)),n.decode=e&&e.decode,n.srcPosName=e&&e.posName||"pos",n}return Object(m["a"])(t,[{key:"getDefines",value:function(){if(this.decode)return"\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n"}},{key:"getMainBody",value:function(){return this.decode?"\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = ".concat(this.srcPosName,".x * du.x + u_min.x;\n  pos.y = ").concat(this.srcPosName,".y * du.y + u_min.y;\n"):"\n  pos.x = (".concat(this.srcPosName,".x - u_min.x)/du.x;\n  pos.y = (").concat(this.srcPosName,".y - u_min.y)/du.y;\n")}}]),Object(u["a"])(t,e),t}(Ze),mt=function(){function e(t){Object(a["a"])(this,e),this.readStoredPosition=new ft(!0),this.udfVelocity=new rt,this.integratePositions=new ot,this.dropParticles=new vt,this.writeComputedPosition=new ft(!1),this.panZoomDecode=new ht({decode:!0}),this.panZoomEncode=new ht({decode:!1}),this.colorMode=t&&t.colorMode}return Object(m["a"])(e,[{key:"setCustomVectorField",value:function(e){this.udfVelocity.setNewUpdateCode(e)}},{key:"getVertexShader",value:function(){return"precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}"}},{key:"getFragmentShader",value:function(){var e=[this.readStoredPosition,this.dropParticles,this.udfVelocity,this.integratePositions,{getMainBody:function(){return"\n  vec2 newPos = pos + velocity;\n  "}},this.writeComputedPosition];return pt(e)}}]),e}(),vt=function(e){function t(){return Object(a["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(m["a"])(t,[{key:"getDefines",value:function(){return"\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n"}},{key:"getFunctions",value:function(){return"\n"}},{key:"getMainBody",value:function(){return"\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n"}}]),Object(u["a"])(t,e),t}(Ze);n("pp/T");function gt(e,t,n){if(0==e)return t[n+0]=0,t[n+1]=0,t[n+2]=0,void(t[n+3]=0);var r,o=Math.abs(e),i=Math.floor(Math.log2(o));i+=yt(i)<=o/2?1:0,i-=yt(i)>o?1:0,r=i>100?o/1024/yt(i-10)-1:o/yt(i)-1;var a=i+127;r*=256;var u=Math.floor(r);r-=u,r*=256;var s=Math.floor(r);r-=s,r*=128;var c=2*Math.floor(r)+(e<0?1:0);t[n+0]=a,t[n+1]=u,t[n+2]=s,t[n+3]=c}function bt(e,t,n,r){var o=Math.floor(e+.5),i=Math.floor(t+.5),a=Math.floor(n+.5),u=Math.floor(r+.5),s=o-127,c=1-u%2*2,l=(o>0?1:0)+i/256+a/65536+Math.floor(u/2)/8388608;return c*l*yt(s)}function yt(e){return Math.exp(e*Math.LN2)}function _t(){var e,t,n={getMin:function(){return e},getMax:function(){return t},add:function(n){n<e&&(e=n),n>t&&(t=n)},reset:r};return n;function r(){e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY}}var xt=6,wt=7;function kt(e){var t,n,r,o,i,a,u,s=!0,c=e.gl,l=_t();return d(),{updateCode:g,updateParticlesPositions:b,updateParticlesCount:v,setColorMinMax:m,requestSpeedUpdate:h,dispose:f};function d(){he.a.on("integration-timestep-changed",h),he.a.on("bbox-change",h),he.a.on("refresh-speed",h)}function f(){he.a.off("integration-timestep-changed",h),he.a.off("bbox-change",h),he.a.off("refresh-speed",h),p()}function p(){n&&c.deleteTexture(n),t&&c.deleteTexture(t)}function h(){o&&clearTimeout(o),o=setTimeout(function(){s=!0,o=0},50)}function m(e){c.uniform2f(e.u_velocity_range,l.getMin(),l.getMax())}function v(){p(),r=e.particleStateResolution,i=r*r,a=new Uint8Array(4*i),u=new Uint8Array(4*i),n=ie.createTexture(c,c.NEAREST,a,r,r),t=ie.createTexture(c,c.NEAREST,u,r,r),h()}function g(){h()}function b(o){s&&a&&u&&(s=!1,ie.bindFramebuffer(c,e.framebuffer,n),c.uniform1i(o.u_out_coordinate,xt),c.drawArrays(c.TRIANGLES,0,6),c.readPixels(0,0,r,r,c.RGBA,c.UNSIGNED_BYTE,a),ie.bindFramebuffer(c,e.framebuffer,t),c.uniform1i(o.u_out_coordinate,wt),c.drawArrays(c.TRIANGLES,0,6),c.readPixels(0,0,r,r,c.RGBA,c.UNSIGNED_BYTE,u),y())}function y(){l.reset();for(var e=0;e<u.length;e+=4){var t=Ot(a,e),n=Ot(u,e),r=Math.sqrt(t*t+n*n);l.add(r)}}}function Ot(e,t){return bt(e[t+0],e[t+1],e[t+2],e[t+3])}function Pt(e,t,n){var r=t.map(function(t,r){var o={texture:ie.createTexture(e,e.NEAREST,t.particleState,n,n),index:r,name:t.name};return o});return{dispose:i,bindTextures:a,assignProgramUniforms:o,length:t.length,textures:r,get:function(e){return r[e]}};function o(t){r.forEach(function(n){e.uniform1i(t["u_particles_"+n.name],n.index)})}function i(){r.forEach(function(t){return e.deleteTexture(t.texture)})}function a(e,t){r.forEach(function(n){ie.bindTexture(e,n.texture,n.index),e.uniform1i(t["u_particles_"+n.name],n.index)})}}var Tt=new mt;function Et(e){var t,n,r,o,i,a=e.gl,u=kt(e);return he.a.on("vector-lines-request",p),{updateCode:s,updateParticlesPositions:f,updateParticlesCount:l,prepareToDraw:d,updateVariable:c};function s(t){Tt.setCustomVectorField(t);var n=Tt.getFragmentShader(),r=Tt.getVertexShader(),i=ie.createProgram(a,r,n);o&&o.unload(),o=i,e.colorMode===ge.VELOCITY&&u.requestSpeedUpdate()}function c(e,t){var n=a.getUniformLocation(o.program,"u_".concat(e));a.useProgram(o.program),a.uniform1f(n,t)}function l(o,i){r=e.particleStateResolution;var s=[{name:"x",particleState:o},{name:"y",particleState:i}];t&&t.dispose(),t=Pt(a,s,r),n&&n.dispose(),n=Pt(a,s,r),u.updateParticlesCount()}function d(n){var r=e.colorMode;r===ge.VELOCITY&&u.setColorMinMax(n),t.bindTextures(a,n)}function f(){var s=o;a.useProgram(s.program),ie.bindAttribute(a,e.quadBuffer,s.a_pos,2),e.inputs.updateBindings(s),e.audioTexture&&(ie.bindTexture(a,e.audioTexture,5),a.uniform1i(s["u_audio"],5)),t.bindTextures(a,s),a.uniform1f(s.u_rand_seed,e.frameSeed),a.uniform1f(s.u_h,e.integrationTimeStep),a.uniform1f(s.frame,e.frame);var c=e.cursor;a.uniform4f(s.cursor,c.clickX,c.clickY,c.hoverX,c.hoverY);var l=e.bbox;a.uniform2f(s.u_min,l.minX,l.minY),a.uniform2f(s.u_max,l.maxX,l.maxY),a.uniform1f(s.u_drop_rate,e.dropProbability);for(var d=0;d<n.length;++d){var f=n.get(d);a.uniform1i(s.u_out_coordinate,d),ie.bindFramebuffer(a,e.framebuffer,f.texture),a.viewport(0,0,r,r),a.drawArrays(a.TRIANGLES,0,6)}e.colorMode===ge.VELOCITY&&u.updateParticlesPositions(s),i&&(h(s),i=null);var p=t;t=n,n=p}function p(e){i=e}function h(t){var n=[{name:"x",particleState:i.x},{name:"y",particleState:i.y}],r=i.resolution,o=r*r,u=Pt(a,n,r),s=Pt(a,n,r);u.bindTextures(a,t);var c=s.get(0);a.uniform1i(t.u_out_coordinate,6),ie.bindFramebuffer(a,e.framebuffer,c.texture),a.viewport(0,0,r,r),a.drawArrays(a.TRIANGLES,0,6);var l=new Uint8Array(4*o);a.readPixels(0,0,r,r,a.RGBA,a.UNSIGNED_BYTE,l),a.uniform1i(t.u_out_coordinate,7),c=s.get(1),ie.bindFramebuffer(a,e.framebuffer,c.texture),a.viewport(0,0,r,r),a.drawArrays(a.TRIANGLES,0,6);var d=new Uint8Array(4*o);a.readPixels(0,0,r,r,a.RGBA,a.UNSIGNED_BYTE,d),s.dispose(),u.dispose();for(var f=_t(),p=_t(),h=new Float32Array(o),m=new Float32Array(o),v=0;v<d.length;v+=4){var g=v/4,b=Mt(l,v),y=Mt(d,v);h[g]=b,m[g]=y,f.add(b),p.add(y)}var _={xStats:f,yStats:p,decoded_velocity_x:h,decoded_velocity_y:m,resolution:r};he.a.fire("vector-line-ready",_)}}function Mt(e,t){return bt(e[t+0],e[t+1],e[t+2],e[t+3])}var Ct={isAudioEnabled:!1,vectorLinesEnabled:!1,FREE_TEXTURE_UNIT:4,showBindings:Te.getQS().get("showBindings")||!1},jt=Ct,St=Rt;function Rt(e){var t=e.gl,n=8,r=8,o=new Uint8Array(n*r*4),i=ie.createTexture(t,t.NEAREST,o,n,r),a=!1;return e.audioTexture=i,he.a.on("audio",c),{updateTextures:s,dispose:u};function u(){he.a.off("audio",c),t.deleteTexture(i)}function s(){if(a){a=!1;var e=5,n=5;t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,o),t.bindTexture(t.TEXTURE_2D,null)}}function c(e){o=e,a=!0}}function At(e){var t,n,r,o,i,a=e.gl,u="",s=Et(e);return c(),{updateParticlesCount:g,updateParticlesPositions:d,drawParticles:b,updateCode:p,updateColorMode:f,updateVariable:m,updateColorVariable:v};function c(){l(),jt.isAudioEnabled&&(o&&o.dispose(),o=St(e))}function l(){i&&i.unload();var t=new at(e),n=t.getVertexShader(u);i=ie.createProgram(a,n,t.getFragmentShader())}function d(){u&&(e.frame+=1,e.frameSeed=Math.random(),o&&o.updateTextures(),s.updateParticlesPositions())}function f(){l()}function p(t){e.frame=0,u=t,s.updateCode(t),l()}function h(e,t){var n=a.getUniformLocation(i.program,"u_".concat(e));a.useProgram(i.program),a.uniform1f(n,t)}function m(e,t){s.updateVariable(e,t),h(e,t)}function v(e){h("k",e)}function g(){t=e.particleStateResolution,r=t*t;for(var o=new Float32Array(r),i=new Uint8Array(4*r),u=new Uint8Array(4*r),c=e.bbox.minX,l=e.bbox.minY,d=e.bbox.maxX-c,f=e.bbox.maxY-l,p=0;p<r;p++)gt(Math.random()*d+c,i,4*p),gt(Math.random()*f+l,u,4*p),o[p]=p;n&&a.deleteBuffer(n),n=ie.createBuffer(a,o),s.updateParticlesCount(i,u)}function b(){if(u){var o=i;a.useProgram(o.program),ie.bindAttribute(a,n,o.a_index,1),s.prepareToDraw(o),e.inputs.updateBindings(o),a.uniform1f(o.u_h,e.integrationTimeStep),a.uniform1f(o.frame,e.frame),a.uniform1f(o.u_particles_res,t);var c=e.bbox;a.uniform2f(o.u_min,c.minX,c.minY),a.uniform2f(o.u_max,c.maxX,c.maxY);var l=e.cursor;a.uniform4f(o.cursor,l.clickX,l.clickY,l.hoverX,l.hoverY),a.drawArrays(a.POINTS,0,r)}}}n("KKXr"),n("9AAn");function Ft(e,t){return t||(t={}),new Promise(n);function n(n,r){var o=new XMLHttpRequest;function i(e){e.lengthComputable&&t.progress({loaded:e.loaded,total:e.total,percent:e.loaded/e.total})}function a(){if(200===o.status){var i=o.response;"json"===t.responseType&&"string"===typeof i&&(i=JSON.parse(i)),n(i)}else r("Unexpected status code ".concat(o.status," when calling ").concat(e))}function u(){r("Failed to download ".concat(e))}function s(){r("Cancelled download of ".concat(e))}"function"===typeof t.progress&&o.addEventListener("progress",i,!1),o.addEventListener("load",a,!1),o.addEventListener("error",u,!1),o.addEventListener("abort",s,!1),o.open("GET",e),t.responseType&&(o.responseType=t.responseType),o.send(null)}}var Dt=new Map;function Nt(e){if(!e)return Promise.reject("Missing link");var t=e.trim();if(!t)return Promise.reject("Missing link");var n=Dt.get(t);return n?Promise.resolve(n):Ft(e).then(function(t){return Dt.set(e,t),t})}var Bt="#include ",Ut={code:""};function It(e){if(!e)return new Promise(function(e){return e(Ut)});var t=Xt(e);return t.pending.length>0?Promise.all(t.pending).then(function(){return t}).catch(function(e){return{error:{error:e}}}):new Promise(function(e){return e(t)})}function Xt(e){var t=[],n=e.split("\n"),r=[],o=0;return n.forEach(function(e,t){o=t,e&&"#"===e[0]?(r.push(""),a(e)):r.push(e)}),{getCode:i,pending:t};function i(){return r.join("\n")}function a(e){if(0===e.indexOf(Bt)){var n=e.substr(Bt.length),i=o;t.push(Nt(n).then(function(e){r[i]=e}))}}}var Gt={check:function(e){return{code:e,log:{errorCount:0}}}};n.e(0).then(function(){Gt=n("iyBS"),he.a.fire("glsl-parser-ready")}.bind(null,n)).catch(n.oe);var Lt="\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}";function Vt(e){return It(e).then(function(t){if(t.error)return t;e=t.getCode();var n=Gt.check(e,{globals:Lt});return n.code=e,n.log.errorCount&&(n.error=Yt(n.log)),n})}function Yt(e){var t=e.diagnostics[0],n=t.range,r=n.lineColumn(),o=n.source,i=o._lineOffsets[r.line],a=o.contents.substr(i,r.column);a+=o.contents.substring(n.start,n.end);var u="Line "+r.line+": ",s=t.text;return{error:u+a+"\n"+Wt(u.length)+Wt(r.column)+"^",errorDetail:s,isFloatError:zt(s)}}function zt(e){return e.indexOf('"int"')>-1&&e.indexOf('"float"')>-1}function Wt(e){return new Array(e+1).join(" ")}function qt(e){he.a.on("glsl-parser-ready",l);var t,n=0,r=Te.getCode();c();var o={getCode:a,setCode:u,dispose:i,updateVariable:f,code:r,error:"",errorDetail:"",isFloatError:!1};return o;function i(){he.a.off("glsl-parser-ready",l)}function a(){return Te.getCode()}function u(e){e!==r?d(e).then(function(t){if(!t.cancelled){if(t&&t.error)return s(t.error),t;r=e,o.code=e,Te.saveCode(e)}}):t&&t.error&&l()}function s(e){e&&e.error?(o.error=e.error,o.errorDetail=e.errorDetail,o.isFloatError=e.isFloatError):(o.error="",o.errorDetail="",o.isFloatError=!1)}function c(){var e=Te.getCode();e?d(e).then(function(e){e.error&&(console.error("Failed to restore previous vector field: ",e.error),d(Te.getDefaultCode()))}):d(Te.getDefaultCode())}function l(e){return Vt(e||r).then(function(e){return t=e,s(t.error),t})}function d(t){n+=1;var r=n;return l(t).then(function(t){if(r!==n)return t.cancelled=!0,t;if(t.error)return t;try{return e.updateCode(t.code),t}catch(e){return{error:{error:e.message}}}})}function f(t,n){e.updateVariable(t,n)}}n("tUrg");function Ht(){var e,t=new Map;return{updateBindings:r,bindInput:n};function n(e,n){var r=t.get(e);r&&r.dispose(),t.set(e,n)}function r(n){e=n,t.forEach(o)}function o(t,n){t.updateBinding(e,n)}}function $t(e,t){var n,r,o=new Image;return o.crossOrigin="",o.onload=a,o.onerror=i,o.src=t,new Promise(function(e,t){n=e,r=t});function i(e){r(e)}function a(){var t=e.createTexture(),r=0,i=e.RGBA,a=e.RGBA,u=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,r,i,a,u,o),Kt(o.width)&&Kt(o.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),n(t)}}function Kt(e){return 0==(e&e-1)}var Jt=jt.FREE_TEXTURE_UNIT;function Qt(e,t,n){var r=null;return $t(e.gl,t).then(i).catch(o),{updateBinding:a,dispose:function(){e.gl.deleteTexture(r)}};function o(e){n&&n.error&&n.error(e)}function i(e){r=e,he.a.fire("refresh-speed"),n&&n.done&&n.done(t)}function a(t,n){if(r){var o=n+Jt;ie.bindTexture(e.gl,r,o),e.gl.uniform1i(t["input".concat(n)],o)}}}function Zt(e){e.inputs=Ht();var t=[];i();var n={getInputs:r,addInput:o};return n;function r(){return t}function o(n){var r=en(e,n);return t.push(r),r}function i(){var e=Te.getQS().get("i0");if(e){var t=o(0);t.link=e,t.updateBinding(!0)}}}function en(e,t){var n=null,r={link:"",error:null,name:"input".concat(t),updateBinding:o};return r;function o(e){n&&(clearTimeout(n),n=null),e?i():n=setTimeout(i,300)}function i(){r.error=null,n=null;var o=Qt(e,r.link,{done:function(){Te.getQS().set("i".concat(t),r.link)},error:function(e){r.error=e}});e.inputs.bindInput(0,o)}}var tn=1;function nn(e){return.004*e}function rn(e){return 1-.002*e}function on(e){var t={width:0,height:0,top:0,left:0};C(window.innerWidth,window.innerHeight),window.addEventListener("resize",M,!0);var n=Te.getBBox()||{},r={scale:.1,x:window.innerWidth/2,y:window.innerHeight/2},o=Te.getParticleCount();e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST);var i,a,u={gl:e,bbox:n,canvasRect:t,inputs:null,framebuffer:e.createFramebuffer(),quadBuffer:ie.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),colorMode:Te.getColorMode(),colorFunction:Te.getColorFunction(),screenTextureUnit:3,speed:tn,integrationTimeStep:nn(tn),dropProbability:Te.getDropProbability(),frame:0,cursor:{clickX:0,clickY:0,hoverX:0,hoverY:0},particleStateResolution:0,fadeOpacity:rn(tn),backgroundColor:{r:0,g:0,b:0,a:1},audioTexture:null},s=!1,c=Zt(u),l=He(u),d=At(u),f=qt(d);D(o);var p={start:S,stop:R,dispose:j,setPaused:x,getParticlesCount:O,setParticlesCount:P,setFadeOutSpeed:w,getFadeOutSpeed:k,setDropProbability:T,getDropProbability:E,getSpeed:y,setSpeed:_,setColorMode:h,getColorMode:m,setColorFunction:v,getColorFunction:b,vectorFieldEditorState:f,updateColorVariable:g,inputsModel:c,setBackgroundColor:U,getCanvasRect:function(){return t},getBoundingBox:function(){return u.bbox}};return N(),setTimeout(function(){he.a.fire("scene-ready",p)}),p;function h(e){var t=parseInt(e,10);u.colorMode=t,d.updateColorMode(t)}function m(){return u.colorMode}function v(e){u.colorFunction=e,d.updateColorMode(u.colorMode)}function g(e){d.updateColorVariable(e)}function b(){return u.colorFunction}function y(){return u.speed}function _(e){var t=parseFloat(e);Number.isFinite(t)&&(u.speed=t,u.integrationTimeStep=nn(speed),u.fadeOpacity=rn(speed),he.a.fire("integration-timestep-changed",u.integrationTimeStep))}function x(e){s=e,S()}function w(e){var t=parseFloat(e);Number.isFinite(t)&&(u.fadeOpacity=t,Te.setFadeout(t))}function k(){return Te.getFadeout()}function O(){return Te.getParticleCount()}function P(e){Number.isFinite(e)&&e!==o&&(e<1||(D(e),o=e,Te.setParticleCount(e)))}function T(e){var t=parseFloat(e);Number.isFinite(t)&&(Te.setDropProbability(t),u.dropProbability=t)}function E(){return Te.getDropProbability()}function M(){C(window.innerWidth,window.innerHeight),l.updateScreenTextures(),B()}function C(n,r){var o=Math.max(.02*n,30),i=Math.max(.02*r,30),a=n+2*o,u=r+2*i;t.width=window.devicePixelRatio*a,t.height=window.devicePixelRatio*u,t.top=-i,t.left=-o;var s=e.canvas;s.style.width=a+"px",s.style.height=u+"px",s.style.left=-o+"px",s.style.top=-i+"px",s.width=t.width,s.height=t.height}function j(){R(),window.removeEventListener("resize",M,!0),f.dispose()}function S(){i||s||(i=requestAnimationFrame(A),a=Date.now())}function R(){cancelAnimationFrame(i),i=0,a=void 0}function A(){if(i=0,a){var e=Date.now()-a,t=1e3/30/e,n=u.speed/Math.min(t,1);u.integrationTimeStep=nn(n),u.fadeOpacity=rn(n)}F(),S()}function F(){l.fadeOutLastFrame(),d.drawParticles(),l.renderCurrentScreen(),d.updateParticlesPositions()}function D(e){u.particleStateResolution=Math.ceil(Math.sqrt(e)),d.updateParticlesCount()}function N(){t.width,t.height,Math.PI,Math.E,Math.PI,Math.E;B()}function B(){l.boundingBoxUpdated=!0,r={scale:.1,x:window.innerWidth/2,y:window.innerHeight/2};var e=t.width,o=t.height;e/=window.devicePixelRatio,o/=window.devicePixelRatio;var i=d(0),a=f(0),u=d(e),s=f(o),c=1e4;function d(e){return(e-r.x)/r.scale}function f(e){return(e-r.y)/r.scale}n.minX=Math.round(c*i/e)/c,n.minY=Math.round(c*-a/e)/c,n.maxX=Math.round(c*u/e)/c,n.maxY=Math.round(c*-s/e)/c,he.a.fire("bbox-change",n)}function U(e){u.backgroundColor=e}}var an=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},un=function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};function sn(e){return Object(N["e"])(e)}var cn=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.timeStep=.01,e.dropProbability=.009,e.fadeout=.998,e}return Object(m["a"])(t,[{key:"mounted",value:function(){var e=this.$el,t={antialias:!0,alpha:!1},n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);this.scene=on(n),this.scene.setParticlesCount(this.particleCount),this.scene.setBackgroundColor({r:.05,g:0,b:.1,a:1}),this.scene.setDropProbability(.001),this.updateVectorField(),this.updateColorFunction(),this.scene.setColorMode(ge.VELOCITY),this.actuallyPaused||this.scene.start()}},{key:"beforeDestroy",value:function(){this.scene.dispose(),this.$el.remove()}},{key:"formatNumberforGLSL",value:function(e){return g.a.isNaN(e)?"0.":e.toFixed(4)}},{key:"updateVectorField",value:function(){this.scene&&this.scene.vectorFieldEditorState.setCode(this.GLSLcode)}},{key:"updateVariable",value:function(e,t){this.scene&&this.scene.vectorFieldEditorState.updateVariable(e,t)}},{key:"updateColorVariable",value:function(e){this.scene&&this.scene.updateColorVariable(e)}},{key:"updateColorFunction",value:function(){this.scene&&this.scene.setColorFunction(this.colorFunction)}},{key:"k1Updated",value:function(){this.updateVariable("k1",this.k1)}},{key:"k2Updated",value:function(){this.updateVariable("k2",this.k2)}},{key:"k3Updated",value:function(){this.updateVariable("k3",this.k3)}},{key:"k4Updated",value:function(){this.updateVariable("k4",this.k4)}},{key:"k5Updated",value:function(){this.updateVariable("k5",this.k5)}},{key:"kColorUpdated",value:function(){this.updateColorVariable(this.kColor)}},{key:"togglePause",value:function(){this.scene&&this.scene[this.actuallyPaused?"stop":"start"]()}},{key:"updateParticleCount",value:function(){this.scene&&this.scene.setParticlesCount(this.particleCount)}},{key:"render",value:function(e){return e("canvas",{class:"brain-particles"})}},{key:"k1",get:function(){return sn(this.alpha)}},{key:"k2",get:function(){return sn(this.gamma)}},{key:"k3",get:function(){return sn(this.beta1)}},{key:"k4",get:function(){return sn(this.beta2)}},{key:"k5",get:function(){return sn(this.beta3)}},{key:"actuallyPaused",get:function(){return this.paused&&this.n>0}},{key:"particleCount",get:function(){return Math.max(this.n*(window.innerHeight*window.innerWidth)/5e3*Math.pow(window.devicePixelRatio,2),1)}},{key:"GLSLcode",get:function(){var e=[];e.push("v.x = 0.;"),e.push("v.y = 0.;"),e.push("float tau = acos(0.);"),e.push("float pi = tau / 2.;"),e.push("float l = length(p);"),e.push("if (u_k1 > .0) {");var t={x:"p.y",y:"-p.x"};e.push("v.x += pow(u_k1, 2.) * (".concat(t.x,") / pow(max(1., abs(3. * l) - 2. * tau), 3.);")),e.push("v.y += pow(u_k1, 2.) * (".concat(t.y,") / pow(max(1., abs(3. * l) - 2. * tau), 3.);")),e.push("}"),e.push("if (u_k5 > .0) {");var n={x:"sign(sin(p.y * 4.)) / 2. + (1. - u_k5) * sin(p.y * 4.)",y:"sign(-1. * sin(p.x * 4.)) / 2. - (1. - u_k5) * sin(p.x * 4.)"};e.push("float sd = (abs(p.x) + abs(p.y)) * 2. / 3.;"),e.push("if ( (sd < tau) && (sd > pi / 2.) ) {"),e.push("v.x += pow(u_k5, 3.) * (".concat(n.x,");")),e.push("v.y += pow(u_k5, 3.) * (".concat(n.y,");")),e.push("}"),e.push("}"),e.push("if (u_k2 > .0) {");var r={x:"(p.y + p.x) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)",y:"(- p.x + p.y) / pow(l, 2.) * atan(l) / tau / max(pow(l, 2.), 1.)"};e.push("v.x -= pow(u_k2, 2.) * (".concat(r.x,");")),e.push("v.y -= pow(u_k2, 2.) * (".concat(r.y,");")),e.push("}"),e.push("if (u_k3 > .0) {"),e.push("v.x += u_k3 * p.x / pow(l, 2.);"),e.push("v.y += u_k3 * p.y / pow(l, 2.);"),e.push("}"),e.push("if (u_k4 > .0) {"),e.push("float x = sin((p.x + p.y) * 3.);"),e.push("float y = sin((p.x - p.y) * 3.);"),e.push("float cd = max(max(abs(p.x), abs(p.y)) - 0.5, 0.);");var o={x:"4. * ((-1. / x / 50.) + (-1. / (y + x) / 100.) ) / max(1., pow(cd, 6.))",y:"4. * ((-1. / y / 50.) + (1.  / (x - y) / 100.) ) / max(1., pow(cd, 6.))"};return e.push("v.x += pow(u_k4, 4.) * (".concat(o.x,");")),e.push("v.y += pow(u_k4, 4.) * (".concat(o.y,");")),e.push("}"),e.push("v.x /= 2.;"),e.push("v.y /= 2.;"),"\n    vec2 get_velocity(vec2 p) {\n      vec2 v = vec2(0., 0.);\n\n      ".concat(e.join("\n"),"\n\n      return v;\n    }")}},{key:"kColor",get:function(){var e=Math.pow((this.k2-this.k1)/2+.5,2),t=Math.pow((this.k3+this.k4+this.k5)/3,2),n=e+t;return n=Math.min(1,n),n=Math.max(0,n),n}},{key:"colorFunction",get:function(){return"\n      vec4 get_color(vec2 p) {\n        vec2 velocity = get_velocity(p);\n        float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n        float hue = 0.05 + (1. - speed) * 0.5;\n        float hue1 = 1. - pow(hue, 3.) / 2. + 0.15;\n        float hue2 = .5 + pow(hue, 3.) / 2.;\n        hue = u_k * hue1 + (1. - u_k) * hue2;\n        return vec4(hsv2rgb(vec3(hue, 0.9, 1.)), 1.0);\n      }"}}]),Object(u["a"])(t,e),t}(d["Vue"]);an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"alpha",void 0),an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"beta1",void 0),an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"beta2",void 0),an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"beta3",void 0),an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"gamma",void 0),an([Object(d["Prop"])({required:!0}),un("design:type",Number)],cn.prototype,"n",void 0),an([Object(d["Prop"])({default:!1}),un("design:type",Boolean)],cn.prototype,"paused",void 0),an([Object(d["Watch"])("k1"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"k1Updated",null),an([Object(d["Watch"])("k2"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"k2Updated",null),an([Object(d["Watch"])("k3"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"k3Updated",null),an([Object(d["Watch"])("k4"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"k4Updated",null),an([Object(d["Watch"])("k5"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"k5Updated",null),an([Object(d["Watch"])("kColor"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"kColorUpdated",null),an([Object(d["Watch"])("actuallyPaused"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"togglePause",null),an([Object(d["Watch"])("particleCount"),un("design:type",Function),un("design:paramtypes",[]),un("design:returntype",void 0)],cn.prototype,"updateParticleCount",null),cn=an([d["Component"]],cn);var ln,dn,fn=cn,pn=fn,hn=(n("wuxX"),Object(j["a"])(pn,ln,dn,!1,null,"70aec022",null)),mn=hn.exports,vn=n("elWB"),gn=n.n(vn),bn=n("y1tp"),yn=n("g2wW"),_n=n.n(yn),xn=n("Nvy8"),wn=n.n(xn),kn=n("jJsu"),On=n.n(kn),Pn=n("EhYb"),Tn=n.n(Pn),En=n("A77j"),Mn=n.n(En),Cn=n("pFEV"),jn=n.n(Cn),Sn=n("mQgp"),Rn=n.n(Sn),An=n("Y+jG"),Fn=n.n(An),Dn=n("cU/o"),Nn=n.n(Dn),Bn=n("1U5M"),Un=n.n(Bn),In=n("0GJJ"),Xn=n.n(In),Gn=n("Vu9u"),Ln=n.n(Gn),Vn=n("RQ7I"),Yn=n.n(Vn),zn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Wn=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r["throw"](e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})};bn["default"].library.add(_n.a,wn.a,On.a,Tn.a,Mn.a,jn.a,Rn.a,Fn.a,Nn.a,Un.a,Xn.a,Ln.a,Yn.a);var qn=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.connectionStatus=!1,e.sessionInProgress=!1,e.vizControlsDisplayed=!1,e.infoPanelOpened=!1,e.currentSession=[],e.alpha=0,e.beta1=0,e.beta2=0,e.beta3=0,e.gamma=0,e.n=0,e.paused=!0,e.sessionsDetailsOpened=!1,e}return Object(m["a"])(t,[{key:"created",value:function(){this.museClient=new b["MuseClient"]}},{key:"connectToMuse",value:function(){return Wn(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.connectionStatus){e.next=6;break}return e.next=3,this.museClient.connect();case 3:return e.next=5,this.museClient.start();case 5:this.museClient.connectionStatus.subscribe(function(e){return t.connectionStatus=e});case 6:this.startSession();case 7:case"end":return e.stop()}},e,this)}))}},{key:"startSession",value:function(){var e=this;this.currentSession=[],this.currentSessionSubscription=this.museClient.relativeBandPowers.pipe(Object(y["bufferCount"])(100,25),Object(y["map"])(function(e){return Object.keys(b["POWER_BANDS"]).map(function(t){return{band:b["POWER_BANDS"][t],power:e.map(function(e){var n=e.find(function(e){return e.band.id==b["POWER_BANDS"][t].id});return n?n.power:NaN}).reduce(function(e,t){return e+t},0)/e.length}})}),Object(y["map"])(function(e){var t={};return e.forEach(function(e){return t[e.band.id]=e.power}),t})).subscribe(function(t){g.a.some(t,function(e){return g.a.isNaN(e)})||(e.currentSession.push(Object.freeze(t)),e.currentSession=g.a.takeRight(e.currentSession,100),e.n=Math.min(5*e.currentSession.length,100),e.alpha=(t.ALPHA-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.ALPHA}))))/(Math.max.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.ALPHA})))-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.ALPHA})))),e.gamma=(t.GAMMA-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.GAMMA}))))/(Math.max.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.GAMMA})))-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.GAMMA})))),e.beta1=(t.BETA_1-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_1}))))/(Math.max.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_1})))-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_1})))),e.beta2=(t.BETA_2-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_2}))))/(Math.max.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_2})))-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_2})))),e.beta3=(t.BETA_3-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_3}))))/(Math.max.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_3})))-Math.min.apply(Math,Object(h["a"])(e.currentSession.map(function(e){return e.BETA_3})))))}),this.sessionInProgress=!0,this.paused=!1}},{key:"stopSession",value:function(){this.currentSessionSubscription&&this.currentSessionSubscription.unsubscribe(),this.sessionInProgress=!1,this.paused=!0,this.n=0}},{key:"toggleVizControlsDisplayed",value:function(){this.vizControlsDisplayed=!this.vizControlsDisplayed}},{key:"reload",value:function(){window.location.reload()}},{key:"beforeDestroy",value:function(){this.stopSession()}}]),Object(u["a"])(t,e),t}(d["Vue"]);qn=zn([Object(d["Component"])({components:{Session:R,Visualization:V,ParticlesVisualization:oe,FieldVisualization:mn,FontAwesomeIcon:gn.a}})],qn);var Hn=qn,$n=Hn,Kn=(n("VMzV"),Object(j["a"])($n,f,p,!1,null,"3840bb7b",null)),Jn=Kn.exports,Qn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Zn=function(e){function t(){return Object(a["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),t}(d["Vue"]);Zn=Qn([Object(d["Component"])({components:{MuseRecorder:Jn}})],Zn);var er=Zn,tr=er,nr=(n("nNx0"),Object(j["a"])(tr,o,i,!1,null,null,null)),rr=nr.exports,or=n("L2JU");r["default"].use(or["a"]);var ir=new or["a"].Store({state:{},mutations:{},actions:{}}),ar=n("lIOY");Object(ar["a"])("".concat("/brain-control/","/service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),r["default"].config.productionTip=!1,new r["default"]({store:ir,render:function(e){return e(rr)}}).$mount("#app")}});
//# sourceMappingURL=app.89ad7c13.js.map